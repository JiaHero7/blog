<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/JiaHero7.github.io/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/JiaHero7.github.io/uploads/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/JiaHero7.github.io/uploads/favicon.ico">
  <link rel="mask-icon" href="/JiaHero7.github.io/images/logo.svg" color="#222">

<link rel="stylesheet" href="/JiaHero7.github.io/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"jiahero7.github.io","root":"/JiaHero7.github.io/","images":"/JiaHero7.github.io/images","scheme":"Pisces","darkmode":true,"version":"8.12.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":true,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/JiaHero7.github.io/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/JiaHero7.github.io/js/config.js"></script>

    <meta name="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
<meta property="og:type" content="website">
<meta property="og:title" content="Dunwu Blog">
<meta property="og:url" content="https://jiahero7.github.io/page/13/index.html">
<meta property="og:site_name" content="Dunwu Blog">
<meta property="og:description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="é’æ‚Ÿ â—¾ Dunwu">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://jiahero7.github.io/page/13/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/13/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Dunwu Blog</title>
  





  <noscript>
    <link rel="stylesheet" href="/JiaHero7.github.io/css/noscript.css">
  </noscript>
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/JiaHero7.github.io/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Dunwu Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">å¤§é“è‡³ç®€ï¼ŒçŸ¥æ˜“è¡Œéš¾</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/JiaHero7.github.io/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a></li><li class="menu-item menu-item-about"><a href="/JiaHero7.github.io/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/JiaHero7.github.io/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾<span class="badge">122</span></a></li><li class="menu-item menu-item-categories"><a href="/JiaHero7.github.io/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»<span class="badge">40</span></a></li><li class="menu-item menu-item-archives"><a href="/JiaHero7.github.io/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£<span class="badge">144</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="æœç´¢..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="é’æ‚Ÿ â—¾ Dunwu"
      src="/JiaHero7.github.io/uploads/avatar.gif">
  <p class="site-author-name" itemprop="name">é’æ‚Ÿ â—¾ Dunwu</p>
  <div class="site-description" itemprop="description">é’æ‚Ÿçš„ä¸ªäººåšå®¢</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/JiaHero7.github.io/archives/">
          <span class="site-state-item-count">144</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/JiaHero7.github.io/categories/">
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/JiaHero7.github.io/tags/">
        <span class="site-state-item-count">122</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/dunwu" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;dunwu" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:forbreak@163.com" title="E-Mail â†’ mailto:forbreak@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license site-overview-item animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdn.jsdelivr.net/npm/@creativecommons/vocabulary@2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="è¿”å›é¡¶éƒ¨">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/dunwu/blog" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/ecc011/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/ecc011/" class="post-title-link" itemprop="url">æ·±å…¥ç†è§£ Java æ³¨è§£</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-05-06 15:02:02" itemprop="dateCreated datePublished" datetime="2019-05-06T15:02:02+08:00">2019-05-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/JavaSE/" itemprop="url" rel="index"><span itemprop="name">JavaSE</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/JavaSE/%E5%9F%BA%E7%A1%80%E7%89%B9%E6%80%A7/" itemprop="url" rel="index"><span itemprop="name">åŸºç¡€ç‰¹æ€§</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>17k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>16 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="æ·±å…¥ç†è§£-Java-æ³¨è§£"><a href="#æ·±å…¥ç†è§£-Java-æ³¨è§£" class="headerlink" title="æ·±å…¥ç†è§£ Java æ³¨è§£"></a>æ·±å…¥ç†è§£ Java æ³¨è§£</h1><blockquote>
<p>æœ¬æ–‡å†…å®¹åŸºäº JDK8ã€‚æ³¨è§£æ˜¯ JDK5 å¼•å…¥çš„ï¼Œåç»­ JDK ç‰ˆæœ¬æ‰©å±•äº†ä¸€äº›å†…å®¹ï¼Œæœ¬æ–‡ä¸­æ²¡æœ‰æ˜ç¡®æŒ‡æ˜ç‰ˆæœ¬çš„æ³¨è§£éƒ½æ˜¯ JDK5 å°±å·²ç»æ”¯æŒçš„æ³¨è§£ã€‚</p>
</blockquote>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><h3 id="æ³¨è§£çš„å½¢å¼"><a href="#æ³¨è§£çš„å½¢å¼" class="headerlink" title="æ³¨è§£çš„å½¢å¼"></a>æ³¨è§£çš„å½¢å¼</h3><p>Java ä¸­ï¼Œæ³¨è§£æ˜¯ä»¥ <code>@</code> å­—ç¬¦å¼€å§‹çš„ä¿®é¥°ç¬¦ã€‚å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">mySuperMethod</span><span class="params">()</span> &#123; ... &#125;</span><br></pre></td></tr></table></figure>

<p>æ³¨è§£å¯ä»¥åŒ…å«å‘½åæˆ–æœªå‘½åçš„å±æ€§ï¼Œå¹¶ä¸”è¿™äº›å±æ€§æœ‰å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Author(</span></span><br><span class="line"><span class="meta">   name = &quot;Benjamin Franklin&quot;,</span></span><br><span class="line"><span class="meta">   date = &quot;3/27/2003&quot;</span></span><br><span class="line"><span class="meta">)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>() &#123; ... &#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœåªæœ‰ä¸€ä¸ªåä¸º value çš„å±æ€§ï¼Œé‚£ä¹ˆåç§°å¯ä»¥çœç•¥ï¼Œå¦‚ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">myMethod</span><span class="params">()</span> &#123; ... &#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ³¨è§£æ²¡æœ‰å±æ€§ï¼Œåˆ™ç§°ä¸º<code>æ ‡è®°æ³¨è§£</code>ã€‚å¦‚ï¼š<code>@Override</code>ã€‚</p>
<h3 id="ä»€ä¹ˆæ˜¯æ³¨è§£"><a href="#ä»€ä¹ˆæ˜¯æ³¨è§£" class="headerlink" title="ä»€ä¹ˆæ˜¯æ³¨è§£"></a>ä»€ä¹ˆæ˜¯æ³¨è§£</h3><p>ä»æœ¬è´¨ä¸Šæ¥è¯´ï¼Œ<strong>æ³¨è§£æ˜¯ä¸€ç§æ ‡ç­¾ï¼Œå…¶å®è´¨ä¸Šå¯ä»¥è§†ä¸ºä¸€ç§ç‰¹æ®Šçš„æ³¨é‡Šï¼Œå¦‚æœæ²¡æœ‰è§£æå®ƒçš„ä»£ç ï¼Œå®ƒå¹¶ä¸æ¯”æ™®é€šæ³¨é‡Šå¼ºã€‚</strong></p>
<p>è§£æä¸€ä¸ªæ³¨è§£å¾€å¾€æœ‰ä¸¤ç§å½¢å¼ï¼š</p>
<ul>
<li><strong>ç¼–è¯‘æœŸç›´æ¥çš„æ‰«æ</strong> - ç¼–è¯‘å™¨çš„æ‰«ææŒ‡çš„æ˜¯ç¼–è¯‘å™¨åœ¨å¯¹ java ä»£ç ç¼–è¯‘å­—èŠ‚ç çš„è¿‡ç¨‹ä¸­ä¼šæ£€æµ‹åˆ°æŸä¸ªç±»æˆ–è€…æ–¹æ³•è¢«ä¸€äº›æ³¨è§£ä¿®é¥°ï¼Œè¿™æ—¶å®ƒå°±ä¼šå¯¹äºè¿™äº›æ³¨è§£è¿›è¡ŒæŸäº›å¤„ç†ã€‚è¿™ç§æƒ…å†µåªé€‚ç”¨äº JDK å†…ç½®çš„æ³¨è§£ç±»ã€‚</li>
<li><strong>è¿è¡ŒæœŸçš„åå°„</strong> - å¦‚æœè¦è‡ªå®šä¹‰æ³¨è§£ï¼ŒJava ç¼–è¯‘å™¨æ— æ³•è¯†åˆ«å¹¶å¤„ç†è¿™ä¸ªæ³¨è§£ï¼Œå®ƒåªèƒ½æ ¹æ®è¯¥æ³¨è§£çš„ä½œç”¨èŒƒå›´æ¥é€‰æ‹©æ˜¯å¦ç¼–è¯‘è¿›å­—èŠ‚ç æ–‡ä»¶ã€‚å¦‚æœè¦å¤„ç†æ³¨è§£ï¼Œå¿…é¡»åˆ©ç”¨åå°„æŠ€æœ¯ï¼Œè¯†åˆ«è¯¥æ³¨è§£ä»¥åŠå®ƒæ‰€æºå¸¦çš„ä¿¡æ¯ï¼Œç„¶ååšç›¸åº”çš„å¤„ç†ã€‚</li>
</ul>
<h3 id="æ³¨è§£çš„ä½œç”¨"><a href="#æ³¨è§£çš„ä½œç”¨" class="headerlink" title="æ³¨è§£çš„ä½œç”¨"></a>æ³¨è§£çš„ä½œç”¨</h3><p>æ³¨è§£æœ‰è®¸å¤šç”¨é€”ï¼š</p>
<ul>
<li>ç¼–è¯‘å™¨ä¿¡æ¯ - ç¼–è¯‘å™¨å¯ä»¥ä½¿ç”¨æ³¨è§£æ¥æ£€æµ‹é”™è¯¯æˆ–æŠ‘åˆ¶è­¦å‘Šã€‚</li>
<li>ç¼–è¯‘æ—¶å’Œéƒ¨ç½²æ—¶çš„å¤„ç† - ç¨‹åºå¯ä»¥å¤„ç†æ³¨è§£ä¿¡æ¯ä»¥ç”Ÿæˆä»£ç ï¼ŒXML æ–‡ä»¶ç­‰ã€‚</li>
<li>è¿è¡Œæ—¶å¤„ç† - å¯ä»¥åœ¨è¿è¡Œæ—¶æ£€æŸ¥æŸäº›æ³¨è§£å¹¶å¤„ç†ã€‚</li>
</ul>
<p>ä½œä¸º Java ç¨‹åºå‘˜ï¼Œå¤šå¤šå°‘å°‘éƒ½æ›¾ç»å†è¿‡è¢«å„ç§é…ç½®æ–‡ä»¶ï¼ˆxmlã€propertiesï¼‰æ”¯é…çš„ææƒ§ã€‚è¿‡å¤šçš„é…ç½®æ–‡ä»¶ä¼šä½¿å¾—é¡¹ç›®éš¾ä»¥ç»´æŠ¤ã€‚ä¸ªäººè®¤ä¸ºï¼Œä½¿ç”¨æ³¨è§£ä»¥å‡å°‘é…ç½®æ–‡ä»¶æˆ–ä»£ç ï¼Œæ˜¯æ³¨è§£æœ€å¤§çš„ç”¨å¤„ã€‚</p>
<h3 id="æ³¨è§£çš„ä»£ä»·"><a href="#æ³¨è§£çš„ä»£ä»·" class="headerlink" title="æ³¨è§£çš„ä»£ä»·"></a>æ³¨è§£çš„ä»£ä»·</h3><p>å‡¡äº‹æœ‰å¾—å¿…æœ‰å¤±ï¼Œæ³¨è§£æŠ€æœ¯åŒæ ·å¦‚æ­¤ã€‚ä½¿ç”¨æ³¨è§£ä¹Ÿæœ‰ä¸€å®šçš„ä»£ä»·ï¼š</p>
<ul>
<li>æ˜¾ç„¶ï¼Œå®ƒæ˜¯ä¸€ç§ä¾µå…¥å¼ç¼–ç¨‹ï¼Œé‚£ä¹ˆï¼Œè‡ªç„¶å°±å­˜åœ¨ç€å¢åŠ ç¨‹åºè€¦åˆåº¦çš„é—®é¢˜ã€‚</li>
<li>è‡ªå®šä¹‰æ³¨è§£çš„å¤„ç†éœ€è¦åœ¨è¿è¡Œæ—¶ï¼Œé€šè¿‡åå°„æŠ€æœ¯æ¥è·å–å±æ€§ã€‚å¦‚æœæ³¨è§£æ‰€ä¿®é¥°çš„å…ƒç´ æ˜¯ç±»çš„é public æˆå‘˜ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åå°„è·å–ã€‚è¿™å°±è¿èƒŒäº†é¢å‘å¯¹è±¡çš„å°è£…æ€§ã€‚</li>
<li>æ³¨è§£æ‰€äº§ç”Ÿçš„é—®é¢˜ï¼Œç›¸å¯¹è€Œè¨€ï¼Œæ›´éš¾ä»¥ debug æˆ–å®šä½ã€‚</li>
</ul>
<p>ä½†æ˜¯ï¼Œæ­£æ‰€è°“ç‘•ä¸æ©ç‘œï¼Œæ³¨è§£æ‰€ä»˜å‡ºçš„ä»£ä»·ï¼Œç›¸è¾ƒäºå®ƒæä¾›çš„åŠŸèƒ½è€Œè¨€ï¼Œè¿˜æ˜¯å¯ä»¥æ¥å—çš„ã€‚</p>
<h3 id="æ³¨è§£çš„åº”ç”¨èŒƒå›´"><a href="#æ³¨è§£çš„åº”ç”¨èŒƒå›´" class="headerlink" title="æ³¨è§£çš„åº”ç”¨èŒƒå›´"></a>æ³¨è§£çš„åº”ç”¨èŒƒå›´</h3><p>æ³¨è§£å¯ä»¥åº”ç”¨äºç±»ã€å­—æ®µã€æ–¹æ³•å’Œå…¶ä»–ç¨‹åºå…ƒç´ çš„å£°æ˜ã€‚</p>
<p>JDK8 å¼€å§‹ï¼Œæ³¨è§£çš„åº”ç”¨èŒƒå›´è¿›ä¸€æ­¥æ‰©å¤§ï¼Œä»¥ä¸‹æ˜¯æ–°çš„åº”ç”¨èŒƒå›´ï¼š</p>
<p>ç±»å®ä¾‹åˆå§‹åŒ–è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="meta">@Interned</span> MyObject();</span><br></pre></td></tr></table></figure>

<p>ç±»å‹è½¬æ¢ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">myString = (<span class="meta">@NonNull</span> String) str;</span><br></pre></td></tr></table></figure>

<p>å®ç°æ¥å£çš„å£°æ˜ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UnmodifiableList</span>&lt;T&gt; implements</span><br><span class="line">    <span class="meta">@Readonly</span> List&lt;<span class="meta">@Readonly</span> T&gt; &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>æŠ›å‡ºå¼‚å¸¸å£°æ˜ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> <span class="title function_">monitorTemperature</span><span class="params">()</span></span><br><span class="line">    <span class="keyword">throws</span> <span class="meta">@Critical</span> TemperatureException &#123;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å†…ç½®æ³¨è§£"><a href="#å†…ç½®æ³¨è§£" class="headerlink" title="å†…ç½®æ³¨è§£"></a>å†…ç½®æ³¨è§£</h2><p>JDK ä¸­å†…ç½®äº†ä»¥ä¸‹æ³¨è§£ï¼š</p>
<ul>
<li><code>@Override</code></li>
<li><code>@Deprecated</code></li>
<li><code>@SuppressWarnnings</code></li>
<li><code>@SafeVarargs</code>ï¼ˆJDK7 å¼•å…¥ï¼‰</li>
<li><code>@FunctionalInterface</code>ï¼ˆJDK8 å¼•å…¥ï¼‰</li>
</ul>
<h3 id="Override"><a href="#Override" class="headerlink" title="@Override"></a>@Override</h3><p><strong><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Override.html"><code>@Override</code></a> ç”¨äºè¡¨æ˜è¢«ä¿®é¥°æ–¹æ³•è¦†å†™äº†çˆ¶ç±»çš„æ–¹æ³•ã€‚</strong></p>
<p>å¦‚æœè¯•å›¾ä½¿ç”¨ <code>@Override</code> æ ‡è®°ä¸€ä¸ªå®é™…ä¸Šå¹¶æ²¡æœ‰è¦†å†™çˆ¶ç±»çš„æ–¹æ³•æ—¶ï¼Œjava ç¼–è¯‘å™¨ä¼šå‘Šè­¦ã€‚</p>
<p><code>@Override</code> ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OverrideAnnotationDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;getName&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Man</span> <span class="keyword">extends</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;override getName&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         *  æ”¾å¼€ä¸‹é¢çš„æ³¨é‡Šï¼Œç¼–è¯‘æ—¶ä¼šå‘Šè­¦</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">       <span class="comment">/*</span></span><br><span class="line"><span class="comment">        @Override</span></span><br><span class="line"><span class="comment">        public String getName2() &#123;</span></span><br><span class="line"><span class="comment">            return &quot;override getName2&quot;;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Person</span> <span class="variable">per</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Man</span>();</span><br><span class="line">        System.out.println(per.getName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Deprecated"><a href="#Deprecated" class="headerlink" title="@Deprecated"></a>@Deprecated</h3><p><strong><code>@Deprecated</code> ç”¨äºæ ‡æ˜è¢«ä¿®é¥°çš„ç±»æˆ–ç±»æˆå‘˜ã€ç±»æ–¹æ³•å·²ç»åºŸå¼ƒã€è¿‡æ—¶ï¼Œä¸å»ºè®®ä½¿ç”¨ã€‚</strong></p>
<p><code>@Deprecated</code> æœ‰ä¸€å®šçš„<strong>å»¶ç»­æ€§</strong>ï¼šå¦‚æœæˆ‘ä»¬åœ¨ä»£ç ä¸­é€šè¿‡ç»§æ‰¿æˆ–è€…è¦†ç›–çš„æ–¹å¼ä½¿ç”¨äº†è¿‡æ—¶çš„ç±»æˆ–ç±»æˆå‘˜ï¼Œå³ä½¿å­ç±»æˆ–å­æ–¹æ³•æ²¡æœ‰æ ‡è®°ä¸º <code>@Deprecated</code>ï¼Œä½†ç¼–è¯‘å™¨ä»ç„¶ä¼šå‘Šè­¦ã€‚</p>
<blockquote>
<p>ğŸ”” æ³¨æ„ï¼š <code>@Deprecated</code> è¿™ä¸ªæ³¨è§£ç±»å‹å’Œ javadoc ä¸­çš„ <code>@deprecated</code> è¿™ä¸ª tag æ˜¯æœ‰åŒºåˆ«çš„ï¼šå‰è€…æ˜¯ java ç¼–è¯‘å™¨è¯†åˆ«çš„ï¼›è€Œåè€…æ˜¯è¢« javadoc å·¥å…·æ‰€è¯†åˆ«ç”¨æ¥ç”Ÿæˆæ–‡æ¡£ï¼ˆåŒ…å«ç¨‹åºæˆå‘˜ä¸ºä»€ä¹ˆå·²ç»è¿‡æ—¶ã€å®ƒåº”å½“å¦‚ä½•è¢«ç¦æ­¢æˆ–è€…æ›¿ä»£çš„æè¿°ï¼‰ã€‚</p>
</blockquote>
<p><code>@Deprecated</code> ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeprecatedAnnotationDemo</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DeprecatedField</span> &#123;</span><br><span class="line">        <span class="meta">@Deprecated</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">DEPRECATED_FIELD</span> <span class="operator">=</span> <span class="string">&quot;DeprecatedField&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DeprecatedMethod</span> &#123;</span><br><span class="line">        <span class="meta">@Deprecated</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;DeprecatedMethod&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">DeprecatedClass</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;DeprecatedClass&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        System.out.println(DeprecatedField.DEPRECATED_FIELD);</span><br><span class="line"></span><br><span class="line">        <span class="type">DeprecatedMethod</span> <span class="variable">dm</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DeprecatedMethod</span>();</span><br><span class="line">        System.out.println(dm.print());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="type">DeprecatedClass</span> <span class="variable">dc</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DeprecatedClass</span>();</span><br><span class="line">        System.out.println(dc.print());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Output:</span></span><br><span class="line"><span class="comment">//DeprecatedField</span></span><br><span class="line"><span class="comment">//DeprecatedMethod</span></span><br><span class="line"><span class="comment">//DeprecatedClass</span></span><br></pre></td></tr></table></figure>

<h3 id="SuppressWarnnings"><a href="#SuppressWarnnings" class="headerlink" title="@SuppressWarnnings"></a>@SuppressWarnnings</h3><p><strong><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/lang/SuppressWarnings.html"><code>@SuppressWarnings</code></a> ç”¨äºå…³é—­å¯¹ç±»ã€æ–¹æ³•ã€æˆå‘˜ç¼–è¯‘æ—¶äº§ç”Ÿçš„ç‰¹å®šè­¦å‘Šã€‚</strong></p>
<p><code>@SuppressWarning</code> ä¸æ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ã€‚å®ƒæœ‰ä¸€ä¸ªç±»å‹ä¸º <code>String[]</code> çš„æ•°ç»„æˆå‘˜ï¼Œè¿™ä¸ªæ•°ç»„ä¸­å­˜å‚¨çš„æ˜¯è¦å…³é—­çš„å‘Šè­¦ç±»å‹ã€‚å¯¹äº javac ç¼–è¯‘å™¨æ¥è®²ï¼Œå¯¹ <code>-Xlint</code> é€‰é¡¹æœ‰æ•ˆçš„è­¦å‘Šåä¹ŸåŒæ ·å¯¹ <code>@SuppressWarings</code> æœ‰æ•ˆï¼ŒåŒæ—¶ç¼–è¯‘å™¨ä¼šå¿½ç•¥æ‰æ— æ³•è¯†åˆ«çš„è­¦å‘Šåã€‚</p>
<p><code>@SuppressWarning</code> ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;, &quot;unchecked&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SuppressWarningsAnnotationDemo</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">SuppressDemo</span>&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">private</span> T value;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> T <span class="title function_">getValue</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">this</span>.value;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setValue</span><span class="params">(T <span class="keyword">var</span>)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.value = <span class="keyword">var</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;deprecation&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">SuppressDemo</span> <span class="variable">d</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SuppressDemo</span>();</span><br><span class="line">        d.setValue(<span class="string">&quot;å—äº¬&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;åœ°åï¼š&quot;</span> + d.getValue());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>@SuppressWarnings</code> æ³¨è§£çš„å¸¸è§å‚æ•°å€¼çš„ç®€å•è¯´æ˜ï¼š</p>
<ul>
<li><code>deprecation</code> - ä½¿ç”¨äº†ä¸èµæˆä½¿ç”¨çš„ç±»æˆ–æ–¹æ³•æ—¶çš„è­¦å‘Šï¼›</li>
<li><code>unchecked</code> - æ‰§è¡Œäº†æœªæ£€æŸ¥çš„è½¬æ¢æ—¶çš„è­¦å‘Šï¼Œä¾‹å¦‚å½“ä½¿ç”¨é›†åˆæ—¶æ²¡æœ‰ç”¨æ³›å‹ (Generics) æ¥æŒ‡å®šé›†åˆä¿å­˜çš„ç±»å‹;</li>
<li><code>fallthrough</code> - å½“ Switch ç¨‹åºå—ç›´æ¥é€šå¾€ä¸‹ä¸€ç§æƒ…å†µè€Œæ²¡æœ‰ Break æ—¶çš„è­¦å‘Š;</li>
<li><code>path</code> - åœ¨ç±»è·¯å¾„ã€æºæ–‡ä»¶è·¯å¾„ç­‰ä¸­æœ‰ä¸å­˜åœ¨çš„è·¯å¾„æ—¶çš„è­¦å‘Š;</li>
<li><code>serial</code> - å½“åœ¨å¯åºåˆ—åŒ–çš„ç±»ä¸Šç¼ºå°‘ serialVersionUID å®šä¹‰æ—¶çš„è­¦å‘Š;</li>
<li><code>finally</code> - ä»»ä½• finally å­å¥ä¸èƒ½æ­£å¸¸å®Œæˆæ—¶çš„è­¦å‘Š;</li>
<li><code>all</code> - æ‰€æœ‰çš„è­¦å‘Šã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SuppressWarnings(&#123;&quot;uncheck&quot;, &quot;deprecation&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InternalAnnotationDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@SuppressWarnings</span> æ ‡è®°æ¶ˆé™¤å½“å‰ç±»çš„å‘Šè­¦ä¿¡æ¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&#123;&quot;deprecation&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">A</span> &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method1</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;call method1&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@Deprecated</span> æ ‡è®°å½“å‰æ–¹æ³•ä¸ºåºŸå¼ƒæ–¹æ³•ï¼Œä¸å»ºè®®ä½¿ç”¨</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Deprecated</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method2</span><span class="params">()</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;call method2&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@Deprecated</span> æ ‡è®°å½“å‰ç±»ä¸ºåºŸå¼ƒç±»ï¼Œä¸å»ºè®®ä½¿ç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Deprecated</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">B</span> <span class="keyword">extends</span> <span class="title class_">A</span> &#123;</span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * <span class="doctag">@Override</span> æ ‡è®°æ˜¾ç¤ºæŒ‡æ˜å½“å‰æ–¹æ³•è¦†å†™äº†çˆ¶ç±»æˆ–æ¥å£çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">method1</span><span class="params">()</span> &#123; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">A</span> <span class="variable">obj</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">B</span>();</span><br><span class="line">        obj.method1();</span><br><span class="line">        obj.method2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="SafeVarargs"><a href="#SafeVarargs" class="headerlink" title="@SafeVarargs"></a>@SafeVarargs</h3><p><code>@SafeVarargs</code> åœ¨ JDK7 ä¸­å¼•å…¥ã€‚</p>
<p><strong><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/lang/SafeVarargs.html"><code>@SafeVarargs</code></a> çš„ä½œç”¨æ˜¯ï¼šå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œåœ¨å¯å˜é•¿å‚æ•°ä¸­çš„æ³›å‹æ˜¯ç±»å‹å®‰å…¨çš„ã€‚å¯å˜é•¿å‚æ•°æ˜¯ä½¿ç”¨æ•°ç»„å­˜å‚¨çš„ï¼Œè€Œæ•°ç»„å’Œæ³›å‹ä¸èƒ½å¾ˆå¥½çš„æ··åˆä½¿ç”¨ã€‚</strong></p>
<p>ç®€å•çš„è¯´ï¼Œæ•°ç»„å…ƒç´ çš„æ•°æ®ç±»å‹åœ¨ç¼–è¯‘å’Œè¿è¡Œæ—¶éƒ½æ˜¯ç¡®å®šçš„ï¼Œè€Œæ³›å‹çš„æ•°æ®ç±»å‹åªæœ‰åœ¨è¿è¡Œæ—¶æ‰èƒ½ç¡®å®šä¸‹æ¥ã€‚å› æ­¤ï¼Œå½“æŠŠä¸€ä¸ªæ³›å‹å­˜å‚¨åˆ°æ•°ç»„ä¸­æ—¶ï¼Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘é˜¶æ®µæ— æ³•ç¡®è®¤æ•°æ®ç±»å‹æ˜¯å¦åŒ¹é…ï¼Œå› æ­¤ä¼šç»™å‡ºè­¦å‘Šä¿¡æ¯ï¼›å³å¦‚æœæ³›å‹çš„çœŸå®æ•°æ®ç±»å‹æ— æ³•å’Œå‚æ•°æ•°ç»„çš„ç±»å‹åŒ¹é…ï¼Œä¼šå¯¼è‡´ <code>ClassCastException</code> å¼‚å¸¸ã€‚</p>
<p><code>@SafeVarargs</code> æ³¨è§£ä½¿ç”¨èŒƒå›´ï¼š</p>
<ul>
<li><code>@SafeVarargs</code> æ³¨è§£å¯ä»¥ç”¨äºæ„é€ æ–¹æ³•ã€‚</li>
<li><code>@SafeVarargs</code> æ³¨è§£å¯ä»¥ç”¨äº <code>static</code> æˆ– <code>final</code> æ–¹æ³•ã€‚</li>
</ul>
<p><code>@SafeVarargs</code> ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SafeVarargsAnnotationDemo</span> &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ­¤æ–¹æ³•å®é™…ä¸Šå¹¶ä¸å®‰å…¨ï¼Œä¸ä½¿ç”¨æ­¤æ³¨è§£ï¼Œç¼–è¯‘æ—¶ä¼šå‘Šè­¦</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SafeVarargs</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">wrongMethod</span><span class="params">(List&lt;String&gt;... stringLists)</span> &#123;</span><br><span class="line">        Object[] array = stringLists;</span><br><span class="line">        List&lt;Integer&gt; tmpList = Arrays.asList(<span class="number">42</span>);</span><br><span class="line">        array[<span class="number">0</span>] = tmpList; <span class="comment">// è¯­æ³•é”™è¯¯ï¼Œä½†æ˜¯ç¼–è¯‘ä¸å‘Šè­¦</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> stringLists[<span class="number">0</span>].get(<span class="number">0</span>); <span class="comment">// è¿è¡Œæ—¶æŠ¥ ClassCastException</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;A&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;B&quot;</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;String&gt; list2 = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        list.add(<span class="string">&quot;2&quot;</span>);</span><br><span class="line"></span><br><span class="line">        wrongMethod(list, list2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»¥ä¸Šä»£ç ï¼Œå¦‚æœä¸ä½¿ç”¨ <code>@SafeVarargs</code> ï¼Œç¼–è¯‘æ—¶ä¼šå‘Šè­¦</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[WARNING] <span class="regexp">/D:/</span>Codes<span class="regexp">/ZP/</span>Java<span class="regexp">/javacore/</span>codes<span class="regexp">/basics/</span>src<span class="regexp">/main/</span>java<span class="regexp">/io/gi</span>thub<span class="regexp">/dunwu/</span>javacore<span class="regexp">/annotation/</span>SafeVarargsAnnotationDemo.java: æŸäº›è¾“å…¥æ–‡ä»¶ä½¿ç”¨äº†æœªç»æ£€æŸ¥æˆ–ä¸å®‰å…¨çš„æ“ä½œã€‚</span><br><span class="line">[WARNING] <span class="regexp">/D:/</span>Codes<span class="regexp">/ZP/</span>Java<span class="regexp">/javacore/</span>codes<span class="regexp">/basics/</span>src<span class="regexp">/main/</span>java<span class="regexp">/io/gi</span>thub<span class="regexp">/dunwu/</span>javacore<span class="regexp">/annotation/</span>SafeVarargsAnnotationDemo.java: æœ‰å…³è¯¦ç»†ä¿¡æ¯, è¯·ä½¿ç”¨ -Xlint:unchecked é‡æ–°ç¼–è¯‘ã€‚</span><br></pre></td></tr></table></figure>

<h3 id="FunctionalInterface"><a href="#FunctionalInterface" class="headerlink" title="@FunctionalInterface"></a>@FunctionalInterface</h3><p><code>@FunctionalInterface</code> åœ¨ JDK8 å¼•å…¥ã€‚</p>
<p><strong><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/lang/FunctionalInterface.html"><code>@FunctionalInterface</code></a> ç”¨äºæŒ‡ç¤ºè¢«ä¿®é¥°çš„æ¥å£æ˜¯å‡½æ•°å¼æ¥å£ã€‚</strong></p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªæ¥å£ç¬¦åˆâ€å‡½æ•°å¼æ¥å£â€å®šä¹‰ï¼Œä¸åŠ  <code>@FunctionalInterface</code> ä¹Ÿæ²¡å…³ç³»ï¼›ä½†å¦‚æœç¼–å†™çš„ä¸æ˜¯å‡½æ•°å¼æ¥å£ï¼Œå´ä½¿ç”¨ <code>@FunctionInterface</code>ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ä¼šæŠ¥é”™ã€‚</p>
<p>ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ï¼Ÿ</p>
<p><strong>å‡½æ•°å¼æ¥å£(Functional Interface)å°±æ˜¯ä¸€ä¸ªæœ‰ä¸”ä»…æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥æœ‰å¤šä¸ªéæŠ½è±¡æ–¹æ³•çš„æ¥å£</strong>ã€‚å‡½æ•°å¼æ¥å£å¯ä»¥è¢«éšå¼è½¬æ¢ä¸º lambda è¡¨è¾¾å¼ã€‚</p>
<p>å‡½æ•°å¼æ¥å£çš„ç‰¹ç‚¹ï¼š</p>
<ul>
<li>æ¥å£æœ‰ä¸”åªèƒ½æœ‰ä¸ªä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼ˆæŠ½è±¡æ–¹æ³•åªæœ‰æ–¹æ³•å®šä¹‰ï¼Œæ²¡æœ‰æ–¹æ³•ä½“ï¼‰ã€‚</li>
<li>ä¸èƒ½åœ¨æ¥å£ä¸­è¦†å†™ Object ç±»ä¸­çš„ public æ–¹æ³•ï¼ˆå†™äº†ç¼–è¯‘å™¨ä¹Ÿä¼šæŠ¥é”™ï¼‰ã€‚</li>
<li>å…è®¸æœ‰ default å®ç°æ–¹æ³•ã€‚</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FunctionalInterfaceAnnotationDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@FunctionalInterface</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Func1</span>&lt;T&gt; &#123;</span><br><span class="line">        <span class="keyword">void</span> <span class="title function_">printMessage</span><span class="params">(T message)</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@FunctionalInterface</span> ä¿®é¥°çš„æ¥å£ä¸­å®šä¹‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç¼–è¯‘æ—¶ä¼šæŠ¥é”™</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/*@FunctionalInterface</span></span><br><span class="line"><span class="comment">    public interface Func2&lt;T&gt; &#123;</span></span><br><span class="line"><span class="comment">        void printMessage(T message);</span></span><br><span class="line"><span class="comment">        void printMessage2(T message);</span></span><br><span class="line"><span class="comment">    &#125;*/</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Func1</span> <span class="variable">func1</span> <span class="operator">=</span> message -&gt; System.out.println(message);</span><br><span class="line">        func1.printMessage(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line">        func1.printMessage(<span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…ƒæ³¨è§£"><a href="#å…ƒæ³¨è§£" class="headerlink" title="å…ƒæ³¨è§£"></a>å…ƒæ³¨è§£</h2><p>JDK ä¸­è™½ç„¶å†…ç½®äº†å‡ ä¸ªæ³¨è§£ï¼Œä½†è¿™è¿œè¿œä¸èƒ½æ»¡è¶³å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°çš„åƒå˜ä¸‡åŒ–çš„éœ€æ±‚ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦è‡ªå®šä¹‰æ³¨è§£ï¼Œè€Œè¿™å°±éœ€è¦ç”¨åˆ°å…ƒæ³¨è§£ã€‚</p>
<p><strong>å…ƒæ³¨è§£çš„ä½œç”¨å°±æ˜¯ç”¨äºå®šä¹‰å…¶å®ƒçš„æ³¨è§£</strong>ã€‚</p>
<p>Java ä¸­æä¾›äº†ä»¥ä¸‹å…ƒæ³¨è§£ç±»å‹ï¼š</p>
<ul>
<li><code>@Retention</code></li>
<li><code>@Target</code></li>
<li><code>@Documented</code></li>
<li><code>@Inherited</code>ï¼ˆJDK8 å¼•å…¥ï¼‰</li>
<li><code>@Repeatable</code>ï¼ˆJDK8 å¼•å…¥ï¼‰</li>
</ul>
<p>è¿™äº›ç±»å‹å’Œå®ƒä»¬æ‰€æ”¯æŒçš„ç±»åœ¨ <code>java.lang.annotation</code> åŒ…ä¸­å¯ä»¥æ‰¾åˆ°ã€‚ä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹æ¯ä¸ªå…ƒæ³¨è§£çš„ä½œç”¨å’Œç›¸åº”åˆ†å‚æ•°çš„ä½¿ç”¨è¯´æ˜ã€‚</p>
<h3 id="Retention"><a href="#Retention" class="headerlink" title="@Retention"></a>@Retention</h3><p><strong><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Retention.html"><code>@Retention</code></a> æŒ‡æ˜äº†æ³¨è§£çš„ä¿ç•™çº§åˆ«ã€‚</strong></p>
<p><code>@Retention</code> æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.ANNOTATION_TYPE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Retention &#123;</span><br><span class="line">    RetentionPolicy <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>RetentionPolicy</code> æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå®ƒå®šä¹‰äº†è¢« <code>@Retention</code> ä¿®é¥°çš„æ³¨è§£æ‰€æ”¯æŒçš„ä¿ç•™çº§åˆ«ï¼š</p>
<ul>
<li><code>RetentionPolicy.SOURCE</code> - æ ‡è®°çš„æ³¨è§£ä»…åœ¨æºæ–‡ä»¶ä¸­æœ‰æ•ˆï¼Œç¼–è¯‘å™¨ä¼šå¿½ç•¥ã€‚</li>
<li><code>RetentionPolicy.CLASS</code> - æ ‡è®°çš„æ³¨è§£åœ¨ class æ–‡ä»¶ä¸­æœ‰æ•ˆï¼ŒJVM ä¼šå¿½ç•¥ã€‚</li>
<li><code>RetentionPolicy.RUNTIME</code> - æ ‡è®°çš„æ³¨è§£åœ¨è¿è¡Œæ—¶æœ‰æ•ˆã€‚</li>
</ul>
<p><code>@Retention</code> ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Column &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;fieldName&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">setFuncName</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;setField&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFuncName</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;getField&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">defaultDBValue</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Documented"><a href="#Documented" class="headerlink" title="@Documented"></a>@Documented</h3><p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Documented.html"><code>@Documented</code></a> è¡¨ç¤ºæ— è®ºä½•æ—¶ä½¿ç”¨æŒ‡å®šçš„æ³¨è§£ï¼Œéƒ½åº”ä½¿ç”¨ Javadocï¼ˆé»˜è®¤æƒ…å†µä¸‹ï¼Œæ³¨é‡Šä¸åŒ…å«åœ¨ Javadoc ä¸­ï¼‰ã€‚æ›´å¤šå†…å®¹å¯ä»¥å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/technotes/guides/javadoc/index.html">Javadoc tools page</a>ã€‚</p>
<p><code>@Documented</code> ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Column &#123;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">name</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;fieldName&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">setFuncName</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;setField&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getFuncName</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;getField&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">defaultDBValue</span><span class="params">()</span> <span class="keyword">default</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Target"><a href="#Target" class="headerlink" title="@Target"></a>@Target</h3><p><strong><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Target.html"><code>@Target</code></a> æŒ‡å®šæ³¨è§£å¯ä»¥ä¿®é¥°çš„å…ƒç´ ç±»å‹ã€‚</strong></p>
<p><code>@Target</code> æºç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Target(ElementType.ANNOTATION_TYPE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Target &#123;</span><br><span class="line">    ElementType[] value();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>ElementType</code> æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå®ƒå®šä¹‰äº†è¢« <code>@Target</code> ä¿®é¥°çš„æ³¨è§£å¯ä»¥åº”ç”¨çš„èŒƒå›´ï¼š</p>
<ul>
<li><code>ElementType.ANNOTATION_TYPE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ³¨è§£ç±»å‹ã€‚</li>
<li><code>ElementType.CONSTRUCTOR</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ„é€ å‡½æ•°ã€‚</li>
<li><code>ElementType.FIELD</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºå­—æ®µæˆ–å±æ€§ã€‚</li>
<li><code>ElementType.LOCAL_VARIABLE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºå±€éƒ¨å˜é‡ã€‚</li>
<li><code>ElementType.METHOD</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ–¹æ³•ã€‚</li>
<li><code>ElementType.PACKAGE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºåŒ…å£°æ˜ã€‚</li>
<li><code>ElementType.PARAMETER</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºæ–¹æ³•çš„å‚æ•°ã€‚</li>
<li><code>ElementType.TYPE</code> - æ ‡è®°çš„æ³¨è§£å¯ä»¥åº”ç”¨äºç±»çš„ä»»ä½•å…ƒç´ ã€‚</li>
</ul>
<p><code>@Target</code> ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(ElementType.TYPE)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Table &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ•°æ®è¡¨åç§°æ³¨è§£ï¼Œé»˜è®¤å€¼ä¸ºç±»åç§°</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">tableName</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;className&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(ElementType.FIELD)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> NoDBColumn &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Inherited"><a href="#Inherited" class="headerlink" title="@Inherited"></a>@Inherited</h3><p><strong><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Inherited.html"><code>@Inherited</code></a> è¡¨ç¤ºæ³¨è§£ç±»å‹å¯ä»¥è¢«ç»§æ‰¿ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä¸æ˜¯è¿™æ ·ï¼‰</strong>ã€‚</p>
<p>è¡¨ç¤ºè‡ªåŠ¨ç»§æ‰¿æ³¨è§£ç±»å‹ã€‚ å¦‚æœæ³¨è§£ç±»å‹å£°æ˜ä¸­å­˜åœ¨ <code>@Inherited</code> å…ƒæ³¨è§£ï¼Œåˆ™æ³¨è§£æ‰€ä¿®é¥°ç±»çš„æ‰€æœ‰å­ç±»éƒ½å°†ä¼šç»§æ‰¿æ­¤æ³¨è§£ã€‚</p>
<blockquote>
<p>ğŸ”” æ³¨æ„ï¼š<code>@Inherited</code> æ³¨è§£ç±»å‹æ˜¯è¢«æ ‡æ³¨è¿‡çš„ç±»çš„å­ç±»æ‰€ç»§æ‰¿ã€‚ç±»å¹¶ä¸ä»å®ƒæ‰€å®ç°çš„æ¥å£ç»§æ‰¿æ³¨è§£ï¼Œæ–¹æ³•å¹¶ä¸ä»å®ƒæ‰€è¦†å†™çš„æ–¹æ³•ç»§æ‰¿æ³¨è§£ã€‚</p>
<p>æ­¤å¤–ï¼Œå½“ <code>@Inherited</code> ç±»å‹æ ‡æ³¨çš„æ³¨è§£çš„ <code>@Retention</code> æ˜¯ <code>RetentionPolicy.RUNTIME</code>ï¼Œåˆ™åå°„ API å¢å¼ºäº†è¿™ç§ç»§æ‰¿æ€§ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨ <code>java.lang.reflect</code> å»æŸ¥è¯¢ä¸€ä¸ª <code>@Inherited</code> ç±»å‹çš„æ³¨è§£æ—¶ï¼Œåå°„ä»£ç æ£€æŸ¥å°†å±•å¼€å·¥ä½œï¼šæ£€æŸ¥ç±»å’Œå…¶çˆ¶ç±»ï¼Œç›´åˆ°å‘ç°æŒ‡å®šçš„æ³¨è§£ç±»å‹è¢«å‘ç°ï¼Œæˆ–è€…åˆ°è¾¾ç±»ç»§æ‰¿ç»“æ„çš„é¡¶å±‚ã€‚</p>
</blockquote>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inherited</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Greeting &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">enum</span> <span class="title class_">FontColor</span>&#123; BULE,RED,GREEN&#125;;</span><br><span class="line">    String <span class="title function_">name</span><span class="params">()</span>;</span><br><span class="line">    FontColor <span class="title function_">fontColor</span><span class="params">()</span> <span class="keyword">default</span> FontColor.GREEN;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Repeatable"><a href="#Repeatable" class="headerlink" title="@Repeatable"></a>@Repeatable</h3><p><strong><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/lang/annotation/Repeatable.html"><code>@Repeatable</code></a> è¡¨ç¤ºæ³¨è§£å¯ä»¥é‡å¤ä½¿ç”¨ã€‚</strong></p>
<p>ä»¥ Spring <code>@Scheduled</code> ä¸ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD, ElementType.ANNOTATION_TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Schedules &#123;</span><br><span class="line">	Scheduled[] value();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.METHOD, ElementType.ANNOTATION_TYPE&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Repeatable(Schedules.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Scheduled &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åº”ç”¨ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">TaskRunner</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Scheduled(&quot;0 0/15 * * * ?&quot;)</span></span><br><span class="line">    <span class="meta">@Scheduled(&quot;0 0 12 * ?&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">task1</span><span class="params">()</span> &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è‡ªå®šä¹‰æ³¨è§£"><a href="#è‡ªå®šä¹‰æ³¨è§£" class="headerlink" title="è‡ªå®šä¹‰æ³¨è§£"></a>è‡ªå®šä¹‰æ³¨è§£</h2><p>ä½¿ç”¨ <code>@interface</code> è‡ªå®šä¹‰æ³¨è§£æ—¶ï¼Œè‡ªåŠ¨ç»§æ‰¿äº† <code>java.lang.annotation.Annotation</code> æ¥å£ï¼Œç”±ç¼–è¯‘ç¨‹åºè‡ªåŠ¨å®Œæˆå…¶ä»–ç»†èŠ‚ã€‚åœ¨å®šä¹‰æ³¨è§£æ—¶ï¼Œä¸èƒ½ç»§æ‰¿å…¶ä»–çš„æ³¨è§£æˆ–æ¥å£ã€‚<code>@interface</code> ç”¨æ¥å£°æ˜ä¸€ä¸ªæ³¨è§£ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªæ–¹æ³•å®é™…ä¸Šæ˜¯å£°æ˜äº†ä¸€ä¸ªé…ç½®å‚æ•°ã€‚æ–¹æ³•çš„åç§°å°±æ˜¯å‚æ•°çš„åç§°ï¼Œè¿”å›å€¼ç±»å‹å°±æ˜¯å‚æ•°çš„ç±»å‹ï¼ˆè¿”å›å€¼ç±»å‹åªèƒ½æ˜¯åŸºæœ¬ç±»å‹ã€Classã€Stringã€enumï¼‰ã€‚å¯ä»¥é€šè¿‡ <code>default</code> æ¥å£°æ˜å‚æ•°çš„é»˜è®¤å€¼ã€‚</p>
<p>è¿™é‡Œï¼Œæˆ‘ä¼šé€šè¿‡å®ç°ä¸€ä¸ªåä¸º <code>RegexValid</code> çš„æ­£åˆ™æ ¡éªŒæ³¨è§£å·¥å…·æ¥å±•ç¤ºè‡ªå®šä¹‰æ³¨è§£çš„å…¨æ­¥éª¤ã€‚</p>
<h3 id="æ³¨è§£çš„å®šä¹‰"><a href="#æ³¨è§£çš„å®šä¹‰" class="headerlink" title="æ³¨è§£çš„å®šä¹‰"></a>æ³¨è§£çš„å®šä¹‰</h3><p>æ³¨è§£çš„è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> æ³¨è§£å &#123;å®šä¹‰ä½“&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ¥å®šä¹‰ä¸€ä¸ªæ³¨è§£ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD, ElementType.PARAMETER&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RegexValid &#123;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>é€šè¿‡ä¸Šä¸€èŠ‚å¯¹äºå…ƒæ³¨è§£ <a href="#target"><code>@Target</code></a>ã€<a href="#retention"><code>@Retention</code></a>ã€<a href="#documented"><code>@Documented</code></a> çš„è¯´æ˜ï¼Œè¿™é‡Œå°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚</p>
<ul>
<li>ä¸Šé¢çš„ä»£ç ä¸­å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>@RegexValid</code> çš„æ³¨è§£ã€‚</li>
<li><code>@Documented</code> è¡¨ç¤º <code>@RegexValid</code> åº”è¯¥ä½¿ç”¨ javadocã€‚</li>
<li><code>@Target(&#123;ElementType.FIELD, ElementType.PARAMETER&#125;)</code> è¡¨ç¤º <code>@RegexValid</code> å¯ä»¥åœ¨ç±»æˆå‘˜æˆ–æ–¹æ³•å‚æ•°ä¸Šä¿®é¥°ã€‚</li>
<li>@Retention(RetentionPolicy.RUNTIME) è¡¨ç¤º <code>@RegexValid</code> åœ¨è¿è¡Œæ—¶æœ‰æ•ˆã€‚</li>
</ul>
</blockquote>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å·²ç»å®šä¹‰äº†ä¸€ä¸ªæ²¡æœ‰ä»»ä½•å±æ€§çš„æ³¨è§£ï¼Œå¦‚æœåˆ°æ­¤ä¸ºæ­¢ï¼Œå®ƒä»…ä»…æ˜¯ä¸€ä¸ªæ ‡è®°æ³¨è§£ã€‚ä½œä¸ºæ­£åˆ™å·¥å…·ï¼Œæ²¡æœ‰å±æ€§å¯ä»€ä¹ˆä¹Ÿåšä¸äº†ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä¸ºå®ƒæ·»åŠ æ³¨è§£å±æ€§ã€‚</p>
<h3 id="æ³¨è§£å±æ€§"><a href="#æ³¨è§£å±æ€§" class="headerlink" title="æ³¨è§£å±æ€§"></a>æ³¨è§£å±æ€§</h3><p>æ³¨è§£å±æ€§çš„è¯­æ³•å½¢å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[è®¿é—®çº§åˆ«ä¿®é¥°ç¬¦]</span> <span class="selector-attr">[æ•°æ®ç±»å‹]</span> åç§°() default é»˜è®¤å€¼;</span><br></pre></td></tr></table></figure>

<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦å®šä¹‰åœ¨æ³¨è§£ä¸­å®šä¹‰ä¸€ä¸ªåä¸º value çš„å­—ç¬¦ä¸²å±æ€§ï¼Œå…¶é»˜è®¤å€¼ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè®¿é—®çº§åˆ«ä¸ºé»˜è®¤çº§åˆ«ï¼Œé‚£ä¹ˆåº”è¯¥å®šä¹‰å¦‚ä¸‹ï¼š</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">String</span> value() <span class="literal">default</span> <span class="string">&quot;&quot;</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>ğŸ”” æ³¨æ„ï¼š**åœ¨æ³¨è§£ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰å±æ€§æ—¶ï¼Œå±æ€§ååé¢éœ€è¦åŠ  <code>()</code>**ã€‚</p>
</blockquote>
<p>å®šä¹‰æ³¨è§£å±æ€§æœ‰ä»¥ä¸‹è¦ç‚¹ï¼š</p>
<ul>
<li><p><strong>æ³¨è§£å±æ€§åªèƒ½ä½¿ç”¨ <code>public</code> æˆ–é»˜è®¤è®¿é—®çº§åˆ«ï¼ˆå³ä¸æŒ‡å®šè®¿é—®çº§åˆ«ä¿®é¥°ç¬¦ï¼‰ä¿®é¥°</strong>ã€‚</p>
</li>
<li><p><strong>æ³¨è§£å±æ€§çš„æ•°æ®ç±»å‹æœ‰é™åˆ¶è¦æ±‚</strong>ã€‚æ”¯æŒçš„æ•°æ®ç±»å‹å¦‚ä¸‹ï¼š</p>
<ul>
<li>æ‰€æœ‰åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆbyteã€charã€shortã€intã€longã€floatã€doubleã€booleanï¼‰</li>
<li>String ç±»å‹</li>
<li>Class ç±»</li>
<li>enum ç±»å‹</li>
<li>Annotation ç±»å‹</li>
<li>ä»¥ä¸Šæ‰€æœ‰ç±»å‹çš„æ•°ç»„</li>
</ul>
</li>
<li><p><strong>æ³¨è§£å±æ€§å¿…é¡»æœ‰ç¡®å®šçš„å€¼ï¼Œå»ºè®®æŒ‡å®šé»˜è®¤å€¼</strong>ã€‚æ³¨è§£å±æ€§åªèƒ½é€šè¿‡æŒ‡å®šé»˜è®¤å€¼æˆ–ä½¿ç”¨æ³¨è§£æ—¶æŒ‡å®šå±æ€§å€¼ï¼Œç›¸è¾ƒä¹‹ä¸‹ï¼ŒæŒ‡å®šé»˜è®¤å€¼çš„æ–¹å¼æ›´ä¸ºå¯é ã€‚æ³¨è§£å±æ€§å¦‚æœæ˜¯å¼•ç”¨ç±»å‹ï¼Œä¸å¯ä»¥ä¸º nullã€‚è¿™ä¸ªçº¦æŸä½¿å¾—æ³¨è§£å¤„ç†å™¨å¾ˆéš¾åˆ¤æ–­æ³¨è§£å±æ€§æ˜¯é»˜è®¤å€¼ï¼Œæˆ–æ˜¯ä½¿ç”¨æ³¨è§£æ—¶æ‰€æŒ‡å®šçš„å±æ€§å€¼ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬è®¾ç½®é»˜è®¤å€¼æ—¶ï¼Œä¸€èˆ¬ä¼šå®šä¹‰ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œä¾‹å¦‚ç©ºå­—ç¬¦ä¸²æˆ–è€…è´Ÿæ•°ã€‚</p>
</li>
<li><p>å¦‚æœæ³¨è§£ä¸­åªæœ‰ä¸€ä¸ªå±æ€§å€¼ï¼Œæœ€å¥½å°†å…¶å‘½åä¸º valueã€‚å› ä¸ºï¼ŒæŒ‡å®šå±æ€§åä¸º valueï¼Œåœ¨ä½¿ç”¨æ³¨è§£æ—¶ï¼ŒæŒ‡å®š value çš„å€¼å¯ä»¥ä¸æŒ‡å®šå±æ€§åç§°ã€‚</p>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™ä¸¤ç§æ–¹å¼æ•ˆæœç›¸åŒ</span></span><br><span class="line"><span class="meta">@RegexValid(&quot;^((\\+)?86\\s*)?((13[0-9])|(15([0-3]|[5-9]))|(18[0,2,5-9]))\\d&#123;8&#125;$&quot;)</span></span><br><span class="line"><span class="meta">@RegexValid(value = &quot;^((\\+)?86\\s*)?((13[0-9])|(15([0-3]|[5-9]))|(18[0,2,5-9]))\\d&#123;8&#125;$&quot;)</span></span><br></pre></td></tr></table></figure>

<p>ç¤ºä¾‹ï¼š</p>
<p>äº†è§£äº†æ³¨è§£å±æ€§çš„å®šä¹‰è¦ç‚¹ï¼Œè®©æˆ‘ä»¬æ¥ä¸º <code>@RegexValid</code> æ³¨è§£å®šä¹‰å‡ ä¸ªå±æ€§ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Target(&#123;ElementType.FIELD, ElementType.PARAMETER&#125;)</span></span><br><span class="line"><span class="meta">@Retention(RetentionPolicy.RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> RegexValid &#123;</span><br><span class="line">    <span class="keyword">enum</span> <span class="title class_">Policy</span> &#123;</span><br><span class="line">        <span class="comment">// @formatter:off</span></span><br><span class="line">        EMPTY(<span class="literal">null</span>),</span><br><span class="line">        DATE(<span class="string">&quot;^(?:(?!0000)[0-9]&#123;4&#125;([-/.]?)(?:(?:0?[1-9]|1[0-2])\\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\\1&quot;</span></span><br><span class="line">            + <span class="string">&quot;(?:29|30)|(?:0?[13578]|1[02])\\1(?:31))|(?:[0-9]&#123;2&#125;(?:0[48]|[2468][048]|[13579][26])|&quot;</span></span><br><span class="line">            + <span class="string">&quot;(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\\2(?:29))$&quot;</span>),</span><br><span class="line">        MAIL(<span class="string">&quot;^[A-Za-z0-9](([_\\.\\-]?[a-zA-Z0-9]+)*)@([A-Za-z0-9]+)(([\\.\\-]?[a-zA-Z0-9]+)*)\\.([A-Za-z]&#123;2,&#125;)$&quot;</span>);</span><br><span class="line">        <span class="comment">// @formatter:on</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> String policy;</span><br><span class="line"></span><br><span class="line">        Policy(String policy) &#123;</span><br><span class="line">            <span class="built_in">this</span>.policy = policy;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">getPolicy</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> policy;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span> <span class="keyword">default</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    Policy <span class="title function_">policy</span><span class="params">()</span> <span class="keyword">default</span> Policy.EMPTY;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸¤ä¸ªæ³¨è§£å±æ€§ï¼š<code>String</code> ç±»å‹çš„ value å±æ€§å’Œ <code>Policy</code> æšä¸¾ç±»å‹çš„ policy å±æ€§ã€‚<code>Policy</code> æšä¸¾ä¸­å®šä¹‰äº†å‡ ä¸ªé»˜è®¤çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œè¿™æ˜¯ä¸ºäº†ç›´æ¥ä½¿ç”¨è¿™å‡ ä¸ªå¸¸ç”¨è¡¨è¾¾å¼å»æ­£åˆ™æ ¡éªŒã€‚è€ƒè™‘åˆ°ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦è‡ªå·±ä¼ å…¥ä¸€äº›è‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼å»æ ¡éªŒå…¶ä»–åœºæ™¯ï¼Œæ‰€ä»¥å®šä¹‰äº† value å±æ€§ï¼Œå…è®¸ä½¿ç”¨è€…ä¼ å…¥æ­£åˆ™è¡¨è¾¾å¼ã€‚</p>
</blockquote>
<p>è‡³æ­¤ï¼Œ<code>@RegexValid</code> çš„å£°æ˜å·²ç»ç»“æŸã€‚ä½†æ˜¯ï¼Œç¨‹åºä»ä¸çŸ¥é“å¦‚ä½•å¤„ç† <code>@RegexValid</code> è¿™ä¸ªæ³¨è§£ã€‚æˆ‘ä»¬è¿˜éœ€è¦å®šä¹‰æ³¨è§£å¤„ç†å™¨ã€‚</p>
<h3 id="æ³¨è§£å¤„ç†å™¨"><a href="#æ³¨è§£å¤„ç†å™¨" class="headerlink" title="æ³¨è§£å¤„ç†å™¨"></a>æ³¨è§£å¤„ç†å™¨</h3><p>å¦‚æœæ²¡æœ‰ç”¨æ¥è¯»å–æ³¨è§£çš„æ–¹æ³•å’Œå·¥ä½œï¼Œé‚£ä¹ˆæ³¨è§£ä¹Ÿå°±ä¸ä¼šæ¯”æ³¨é‡Šæ›´æœ‰ç”¨å¤„äº†ã€‚ä½¿ç”¨æ³¨è§£çš„è¿‡ç¨‹ä¸­ï¼Œå¾ˆé‡è¦çš„ä¸€éƒ¨åˆ†å°±æ˜¯åˆ›å»ºäºä½¿ç”¨æ³¨è§£å¤„ç†å™¨ã€‚JDK5 æ‰©å±•äº†åå°„æœºåˆ¶çš„ APIï¼Œä»¥å¸®åŠ©ç¨‹åºå‘˜å¿«é€Ÿçš„æ„é€ è‡ªå®šä¹‰æ³¨è§£å¤„ç†å™¨ã€‚</p>
<p><strong><code>java.lang.annotation.Annotation</code> æ˜¯ä¸€ä¸ªæ¥å£ï¼Œç¨‹åºå¯ä»¥é€šè¿‡åå°„æ¥è·å–æŒ‡å®šç¨‹åºå…ƒç´ çš„æ³¨è§£å¯¹è±¡ï¼Œç„¶åé€šè¿‡æ³¨è§£å¯¹è±¡æ¥è·å–æ³¨è§£é‡Œé¢çš„å…ƒæ•°æ®</strong>ã€‚</p>
<p><code>Annotation</code> æ¥å£æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Annotation</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object obj)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    String <span class="title function_">toString</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    Class&lt;? <span class="keyword">extends</span> <span class="title class_">Annotation</span>&gt; annotationType();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤æ­¤ä¹‹å¤–ï¼ŒJava ä¸­æ”¯æŒ<strong>æ³¨è§£å¤„ç†å™¨æ¥å£ <code>java.lang.reflect.AnnotatedElement</code></strong> ï¼Œè¯¥æ¥å£ä»£è¡¨ç¨‹åºä¸­å¯ä»¥æ¥å—æ³¨è§£çš„ç¨‹åºå…ƒç´ ï¼Œè¯¥æ¥å£ä¸»è¦æœ‰å¦‚ä¸‹å‡ ä¸ªå®ç°ç±»ï¼š</p>
<ul>
<li><code>Class</code> - ç±»å®šä¹‰</li>
<li><code>Constructor</code> - æ„é€ å™¨å®šä¹‰</li>
<li><code>Field</code> - ç´¯çš„æˆå‘˜å˜é‡å®šä¹‰</li>
<li><code>Method</code> - ç±»çš„æ–¹æ³•å®šä¹‰</li>
<li><code>Package</code> - ç±»çš„åŒ…å®šä¹‰</li>
</ul>
<p><code>java.lang.reflect</code> åŒ…ä¸‹ä¸»è¦åŒ…å«ä¸€äº›å®ç°åå°„åŠŸèƒ½çš„å·¥å…·ç±»ã€‚å®é™…ä¸Šï¼Œ<code>java.lang.reflect</code> åŒ…æ‰€æœ‰æä¾›çš„åå°„ API æ‰©å……äº†è¯»å–è¿è¡Œæ—¶æ³¨è§£ä¿¡æ¯çš„èƒ½åŠ›ã€‚å½“ä¸€ä¸ªæ³¨è§£ç±»å‹è¢«å®šä¹‰ä¸ºè¿è¡Œæ—¶çš„æ³¨è§£åï¼Œè¯¥æ³¨è§£æ‰èƒ½æ˜¯è¿è¡Œæ—¶å¯è§ï¼Œå½“ class æ–‡ä»¶è¢«è£…è½½æ—¶è¢«ä¿å­˜åœ¨ class æ–‡ä»¶ä¸­çš„æ³¨è§£æ‰ä¼šè¢«è™šæ‹Ÿæœºè¯»å–ã€‚<br><code>AnnotatedElement</code> æ¥å£æ˜¯æ‰€æœ‰ç¨‹åºå…ƒç´ ï¼ˆClassã€Method å’Œ Constructorï¼‰çš„çˆ¶æ¥å£ï¼Œæ‰€ä»¥ç¨‹åºé€šè¿‡åå°„è·å–äº†æŸä¸ªç±»çš„<code>AnnotatedElement</code> å¯¹è±¡ä¹‹åï¼Œç¨‹åºå°±å¯ä»¥è°ƒç”¨è¯¥å¯¹è±¡çš„å¦‚ä¸‹å››ä¸ªä¸ªæ–¹æ³•æ¥è®¿é—®æ³¨è§£ä¿¡æ¯ï¼š</p>
<ul>
<li><code>getAnnotation</code> - è¿”å›è¯¥ç¨‹åºå…ƒç´ ä¸Šå­˜åœ¨çš„ã€æŒ‡å®šç±»å‹çš„æ³¨è§£ï¼Œå¦‚æœè¯¥ç±»å‹æ³¨è§£ä¸å­˜åœ¨ï¼Œåˆ™è¿”å› nullã€‚</li>
<li><code>getAnnotations</code> - è¿”å›è¯¥ç¨‹åºå…ƒç´ ä¸Šå­˜åœ¨çš„æ‰€æœ‰æ³¨è§£ã€‚</li>
<li><code>isAnnotationPresent</code> - åˆ¤æ–­è¯¥ç¨‹åºå…ƒç´ ä¸Šæ˜¯å¦åŒ…å«æŒ‡å®šç±»å‹çš„æ³¨è§£ï¼Œå­˜åœ¨åˆ™è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚</li>
<li><code>getDeclaredAnnotations</code> - è¿”å›ç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šçš„æ‰€æœ‰æ³¨é‡Šã€‚ä¸æ­¤æ¥å£ä¸­çš„å…¶ä»–æ–¹æ³•ä¸åŒï¼Œè¯¥æ–¹æ³•å°†å¿½ç•¥ç»§æ‰¿çš„æ³¨é‡Šã€‚ï¼ˆå¦‚æœæ²¡æœ‰æ³¨é‡Šç›´æ¥å­˜åœ¨äºæ­¤å…ƒç´ ä¸Šï¼Œåˆ™è¿”å›é•¿åº¦ä¸ºé›¶çš„ä¸€ä¸ªæ•°ç»„ã€‚ï¼‰è¯¥æ–¹æ³•çš„è°ƒç”¨è€…å¯ä»¥éšæ„ä¿®æ”¹è¿”å›çš„æ•°ç»„ï¼›è¿™ä¸ä¼šå¯¹å…¶ä»–è°ƒç”¨è€…è¿”å›çš„æ•°ç»„äº§ç”Ÿä»»ä½•å½±å“ã€‚</li>
</ul>
<p>äº†è§£äº†ä»¥ä¸Šå†…å®¹ï¼Œè®©æˆ‘ä»¬æ¥å®ç° <code>@RegexValid</code> çš„æ³¨è§£å¤„ç†å™¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Matcher;</span><br><span class="line"><span class="keyword">import</span> java.util.regex.Pattern;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RegexValidUtil</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">boolean</span> <span class="title function_">check</span><span class="params">(Object obj)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">        Field[] fields = obj.getClass().getDeclaredFields();</span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æˆå‘˜æ˜¯å¦è¢« @RegexValid æ³¨è§£æ‰€ä¿®é¥°</span></span><br><span class="line">            <span class="keyword">if</span> (field.isAnnotationPresent(RegexValid.class)) &#123;</span><br><span class="line">                <span class="type">RegexValid</span> <span class="variable">valid</span> <span class="operator">=</span> field.getAnnotation(RegexValid.class);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å¦‚æœ value ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œè¯´æ˜æ²¡æœ‰æ³¨å…¥è‡ªå®šä¹‰æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ”¹ç”¨ policy å±æ€§</span></span><br><span class="line">                <span class="type">String</span> <span class="variable">value</span> <span class="operator">=</span> valid.value();</span><br><span class="line">                <span class="keyword">if</span> (<span class="string">&quot;&quot;</span>.equals(value)) &#123;</span><br><span class="line">                    RegexValid.<span class="type">Policy</span> <span class="variable">policy</span> <span class="operator">=</span> valid.policy();</span><br><span class="line">                    value = policy.getPolicy();</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// é€šè¿‡è®¾ç½® setAccessible(true) æ¥è®¿é—®ç§æœ‰æˆå‘˜</span></span><br><span class="line">                field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">                <span class="type">Object</span> <span class="variable">fieldObj</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    fieldObj = field.get(obj);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (fieldObj == <span class="literal">null</span>) &#123;</span><br><span class="line">                    sb.append(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">                        .append(String.format(<span class="string">&quot;%s ç±»ä¸­çš„ %s å­—æ®µä¸èƒ½ä¸ºç©ºï¼&quot;</span>, obj.getClass().getName(), field.getName()));</span><br><span class="line">                    result = <span class="literal">false</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (fieldObj <span class="keyword">instanceof</span> String) &#123;</span><br><span class="line">                        <span class="type">String</span> <span class="variable">text</span> <span class="operator">=</span> (String) fieldObj;</span><br><span class="line">                        <span class="type">Pattern</span> <span class="variable">p</span> <span class="operator">=</span> Pattern.compile(value);</span><br><span class="line">                        <span class="type">Matcher</span> <span class="variable">m</span> <span class="operator">=</span> p.matcher(text);</span><br><span class="line">                        result = m.matches();</span><br><span class="line">                        <span class="keyword">if</span> (!result) &#123;</span><br><span class="line">                            sb.append(<span class="string">&quot;\n&quot;</span>).append(String.format(<span class="string">&quot;%s ä¸æ˜¯åˆæ³•çš„ %s ï¼&quot;</span>, text, field.getName()));</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        sb.append(<span class="string">&quot;\n&quot;</span>).append(</span><br><span class="line">                            String.format(<span class="string">&quot;%s ç±»ä¸­çš„ %s å­—æ®µä¸æ˜¯å­—ç¬¦ä¸²ç±»å‹ï¼Œä¸èƒ½ä½¿ç”¨æ­¤æ³¨è§£æ ¡éªŒï¼&quot;</span>, obj.getClass().getName(), field.getName()));</span><br><span class="line">                        result = <span class="literal">false</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (sb.length() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Exception</span>(sb.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>è¯´æ˜ï¼š</p>
<p>ä»¥ä¸Šç¤ºä¾‹ä¸­çš„æ³¨è§£å¤„ç†å™¨ï¼Œæ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>é€šè¿‡ getDeclaredFields åå°„æ–¹æ³•è·å–ä¼ å…¥å¯¹è±¡çš„æ‰€æœ‰æˆå‘˜ã€‚</li>
<li>éå†æˆå‘˜ï¼Œä½¿ç”¨ isAnnotationPresent åˆ¤æ–­æˆå‘˜æ˜¯å¦è¢«æŒ‡å®šæ³¨è§£æ‰€ä¿®é¥°ï¼Œå¦‚æœä¸æ˜¯ï¼Œç›´æ¥è·³è¿‡ã€‚</li>
<li>å¦‚æœæˆå‘˜è¢«æ³¨è§£æ‰€ä¿®é¥°ï¼Œé€šè¿‡ <code>RegexValid valid = field.getAnnotation(RegexValid.class);</code> è¿™æ ·çš„å½¢å¼è·å–ï¼Œæ³¨è§£å®ä¾‹åŒ–å¯¹è±¡ï¼Œç„¶åï¼Œå°±å¯ä»¥ä½¿ç”¨ <code>valid.value()</code> æˆ– <code>valid.policy()</code> è¿™æ ·çš„å½¢å¼è·å–æ³¨è§£ä¸­è®¾å®šçš„å±æ€§å€¼ã€‚</li>
<li>æ ¹æ®å±æ€§å€¼ï¼Œè¿›è¡Œé€»è¾‘å¤„ç†ã€‚</li>
</ol>
</blockquote>
<h3 id="ä½¿ç”¨æ³¨è§£"><a href="#ä½¿ç”¨æ³¨è§£" class="headerlink" title="ä½¿ç”¨æ³¨è§£"></a>ä½¿ç”¨æ³¨è§£</h3><p>å®Œæˆäº†ä»¥ä¸Šå·¥ä½œï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰æ³¨è§£äº†ï¼Œç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RegexValidDemo</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="meta">@RegexValid(policy = RegexValid.Policy.DATE)</span></span><br><span class="line">        <span class="keyword">private</span> String date;</span><br><span class="line">        <span class="meta">@RegexValid(policy = RegexValid.Policy.MAIL)</span></span><br><span class="line">        <span class="keyword">private</span> String mail;</span><br><span class="line">        <span class="meta">@RegexValid(&quot;^((\\+)?86\\s*)?((13[0-9])|(15([0-3]|[5-9]))|(18[0,2,5-9]))\\d&#123;8&#125;$&quot;)</span></span><br><span class="line">        <span class="keyword">private</span> String phone;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name, String date, String mail, String phone)</span> &#123;</span><br><span class="line">            <span class="built_in">this</span>.name = name;</span><br><span class="line">            <span class="built_in">this</span>.date = date;</span><br><span class="line">            <span class="built_in">this</span>.mail = mail;</span><br><span class="line">            <span class="built_in">this</span>.phone = phone;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;User&#123;&quot;</span> + <span class="string">&quot;name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> + <span class="string">&quot;, date=&#x27;&quot;</span> + date + <span class="string">&#x27;\&#x27;&#x27;</span> + <span class="string">&quot;, mail=&#x27;&quot;</span> + mail + <span class="string">&#x27;\&#x27;&#x27;</span> + <span class="string">&quot;, phone=&#x27;&quot;</span></span><br><span class="line">                + phone + <span class="string">&#x27;\&#x27;&#x27;</span> + <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">printDate</span><span class="params">(<span class="meta">@RegexValid(policy = RegexValid.Policy.DATE)</span> String date)</span>&#123;</span><br><span class="line">        System.out.println(date);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;Tom&quot;</span>, <span class="string">&quot;1990-01-31&quot;</span>, <span class="string">&quot;xxx@163.com&quot;</span>, <span class="string">&quot;18612341234&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;2019-02-29&quot;</span>, <span class="string">&quot;sadhgs&quot;</span>, <span class="string">&quot;183xxxxxxxx&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (RegexValidUtil.check(user)) &#123;</span><br><span class="line">            System.out.println(user + <span class="string">&quot;æ­£åˆ™æ ¡éªŒé€šè¿‡&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (RegexValidUtil.check(user2)) &#123;</span><br><span class="line">            System.out.println(user2 + <span class="string">&quot;æ­£åˆ™æ ¡éªŒé€šè¿‡&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h2><p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/xmind/%E6%B3%A8%E8%A7%A3%E7%AE%80%E4%BB%8B.svg" alt="img"></p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/xmind/%E5%85%83%E6%B3%A8%E8%A7%A3.svg" alt="img"></p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/xmind/%E5%86%85%E7%BD%AE%E6%B3%A8%E8%A7%A3.svg" alt="img"></p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/cs/java/javacore/xmind/%E8%87%AA%E5%AE%9A%E4%B9%89%E6%B3%A8%E8%A7%A3.svg" alt="img"></p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/2130190/">Java ç¼–ç¨‹æ€æƒ³</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/3146174/">Java æ ¸å¿ƒæŠ€æœ¯ï¼ˆå· 1ï¼‰</a></li>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/3360807/">Effective java</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/tutorial/java/annotations/">Oracle å®˜æ–¹æ–‡æ¡£ä¹‹æ³¨è§£ç¯‡</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/peida/archive/2013/04/24/3036689.html">æ·±å…¥ç†è§£ Javaï¼šæ³¨è§£ï¼ˆAnnotationï¼‰è‡ªå®šä¹‰æ³¨è§£å…¥é—¨</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/briblue/article/details/73824058">https://blog.csdn.net/briblue/article/details/73824058</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/ad1cce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/ad1cce/" class="post-title-link" itemprop="url">JDK8 å…¥é—¨æŒ‡å—</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-05-06 15:02:02" itemprop="dateCreated datePublished" datetime="2019-05-06T15:02:02+08:00">2019-05-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/JavaSE/" itemprop="url" rel="index"><span itemprop="name">JavaSE</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/JavaSE/%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/" itemprop="url" rel="index"><span itemprop="name">é«˜çº§ç‰¹æ€§</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>19k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>17 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="JDK8-å…¥é—¨æŒ‡å—"><a href="#JDK8-å…¥é—¨æŒ‡å—" class="headerlink" title="JDK8 å…¥é—¨æŒ‡å—"></a>JDK8 å…¥é—¨æŒ‡å—</h1><blockquote>
<p>JDK8 å‡çº§å¸¸è§é—®é¢˜ç« èŠ‚æ˜¯æˆ‘ä¸ªäººçš„ç»éªŒæ•´ç†ã€‚å…¶ä»–å†…å®¹åŸºæœ¬ç¿»è¯‘è‡ª <a target="_blank" rel="noopener" href="https://github.com/winterbe/java8-tutorial">java8-tutorial</a></p>
<p><strong>ğŸ“¦ æœ¬æ–‡ä»¥åŠç¤ºä¾‹æºç å·²å½’æ¡£åœ¨ <a target="_blank" rel="noopener" href="https://github.com/dunwu/javacore/">javacore</a></strong></p>
<p>å…³é”®è¯ï¼š<code>Stream</code>ã€<code>lambda</code>ã€<code>Optional</code>ã€<code>@FunctionalInterface</code></p>
</blockquote>
<h2 id="Default-Methods-for-Interfaces-æ¥å£çš„é»˜è®¤æ–¹æ³•"><a href="#Default-Methods-for-Interfaces-æ¥å£çš„é»˜è®¤æ–¹æ³•" class="headerlink" title="Default Methods for Interfaces(æ¥å£çš„é»˜è®¤æ–¹æ³•)"></a>Default Methods for Interfaces(æ¥å£çš„é»˜è®¤æ–¹æ³•)</h2><p>Java 8 ä½¿æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡ä½¿ç”¨ <code>default</code> å…³é”®å­—å°†éæŠ½è±¡æ–¹æ³•å®ç°æ·»åŠ åˆ°æ¥å£ã€‚è¿™ä¸ªåŠŸèƒ½ä¹Ÿè¢«ç§°ä¸ºè™šæ‹Ÿæ‰©å±•æ–¹æ³•ã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬çš„ç¬¬ä¸€ä¸ªä¾‹å­ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">Formula</span> &#123;</span><br><span class="line">    <span class="type">double</span> <span class="title function_">calculate</span><span class="params">(<span class="type">int</span> a)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span> <span class="type">double</span> <span class="title function_">sqrt</span><span class="params">(<span class="type">int</span> a)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> Math.sqrt(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é™¤äº†æŠ½è±¡æ–¹æ³• <code>calculate</code> ï¼Œæ¥å£ <code>Formula</code> è¿˜å®šä¹‰äº†é»˜è®¤æ–¹æ³• <code>sqrt</code>ã€‚å…·ä½“ç±»åªéœ€è¦æ‰§è¡ŒæŠ½è±¡æ–¹æ³•è®¡ç®—ã€‚é»˜è®¤çš„æ–¹æ³• <code>sqrt</code> å¯ä»¥ç”¨äºå¼€ç®±å³ç”¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Formula</span> <span class="variable">formula</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Formula</span>() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">double</span> <span class="title function_">calculate</span><span class="params">(<span class="type">int</span> a)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> sqrt(a * <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">formula.calculate(<span class="number">100</span>);     <span class="comment">// 100.0</span></span><br><span class="line">formula.sqrt(<span class="number">16</span>);           <span class="comment">// 4.0</span></span><br></pre></td></tr></table></figure>

<p><code>Formula</code> è¢«å®ç°ä¸ºä¸€ä¸ªåŒ¿åå¯¹è±¡ã€‚ä»£ç éå¸¸å†—é•¿ï¼šç”¨äº <code>sqrt(a * 100)</code> è¿™æ ·ç®€å•çš„è®¡ç®—çš„ 6 è¡Œä»£ç ã€‚æ­£å¦‚æˆ‘ä»¬å°†åœ¨ä¸‹ä¸€èŠ‚ä¸­çœ‹åˆ°çš„ï¼Œåœ¨ Java 8 ä¸­å®ç°å•ä¸ªæ–¹æ³•å¯¹è±¡æœ‰æ›´å¥½çš„æ–¹æ³•ã€‚</p>
<h2 id="Lambda-expressions-Lambda-è¡¨è¾¾å¼"><a href="#Lambda-expressions-Lambda-è¡¨è¾¾å¼" class="headerlink" title="Lambda expressions(Lambda è¡¨è¾¾å¼)"></a>Lambda expressions(Lambda è¡¨è¾¾å¼)</h2><p>è®©æˆ‘ä»¬ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜å¦‚ä½•åœ¨ä»¥å‰ç‰ˆæœ¬çš„ Java ä¸­å¯¹å­—ç¬¦ä¸²åˆ—è¡¨è¿›è¡Œæ’åºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; names = Arrays.asList(<span class="string">&quot;peter&quot;</span>, <span class="string">&quot;anna&quot;</span>, <span class="string">&quot;mike&quot;</span>, <span class="string">&quot;xenia&quot;</span>);</span><br><span class="line"></span><br><span class="line">Collections.sort(names, <span class="keyword">new</span> <span class="title class_">Comparator</span>&lt;String&gt;() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">compare</span><span class="params">(String a, String b)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> b.compareTo(a);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>é™æ€å·¥å…·æ–¹æ³• <code>Collections.sort</code> ä¸ºäº†å¯¹æŒ‡å®šçš„åˆ—è¡¨è¿›è¡Œæ’åºï¼Œæ¥å—ä¸€ä¸ªåˆ—è¡¨å’Œä¸€ä¸ªæ¯”è¾ƒå™¨ã€‚æ‚¨ä¼šå‘ç°è‡ªå·±ç»å¸¸éœ€è¦åˆ›å»ºåŒ¿åæ¯”è¾ƒå™¨å¹¶å°†å…¶ä¼ é€’ç»™æ’åºæ–¹æ³•ã€‚</p>
<p>Java 8 ä½¿ç”¨æ›´ç®€çŸ­çš„ <strong>lambda è¡¨è¾¾å¼</strong>æ¥é¿å…å¸¸å¸¸åˆ›å»ºåŒ¿åå¯¹è±¡çš„é—®é¢˜ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Collections.sort(names, (String a, String b) -&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> b.compareTo(a);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>å¦‚æ‚¨æ‰€è§ï¼Œè¿™æ®µä»£ç æ¯”ä¸Šæ®µä»£ç ç®€æ´å¾ˆå¤šã€‚ä½†æ˜¯ï¼Œè¿˜å¯ä»¥æ›´åŠ ç®€æ´ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Collections.sort(names, (String a, String b) -&gt; b.compareTo(a));</span><br></pre></td></tr></table></figure>

<p>è¿™è¡Œä»£ç ä¸­ï¼Œä½ çœå»äº†èŠ±æ‹¬å· <code>&#123;&#125;</code> å’Œ return å…³é”®å­—ã€‚ä½†æ˜¯ï¼Œè¿™è¿˜ä¸ç®—å®Œï¼Œå®ƒè¿˜å¯ä»¥å†è¿›ä¸€æ­¥ç®€æ´ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">names.sort((a, b) -&gt; b.compareTo(a));</span><br></pre></td></tr></table></figure>

<p>åˆ—è¡¨ç°åœ¨æœ‰ä¸€ä¸ª <code>sort</code> æ–¹æ³•ã€‚æ­¤å¤–ï¼Œjava ç¼–è¯‘å™¨çŸ¥é“å‚æ•°ç±»å‹ï¼Œæ‰€ä»¥ä½ å¯ä»¥ä¸æŒ‡å®šå…¥å‚çš„æ•°æ®ç±»å‹ã€‚è®©æˆ‘ä»¬æ·±å…¥æ¢è®¨å¦‚ä½•ä½¿ç”¨ lambda è¡¨è¾¾å¼ã€‚</p>
<h2 id="Functional-Interfaces-å‡½æ•°æ¥å£"><a href="#Functional-Interfaces-å‡½æ•°æ¥å£" class="headerlink" title="Functional Interfaces(å‡½æ•°æ¥å£)"></a>Functional Interfaces(å‡½æ•°æ¥å£)</h2><p>lambda è¡¨è¾¾å¼å¦‚ä½•é€‚åº” Java çš„ç±»å‹ç³»ç»Ÿï¼Ÿæ¯ä¸ª lambda å¯¹åº”ä¸€ä¸ªç”±æ¥å£æŒ‡å®šçš„ç±»å‹ã€‚ä¸€ä¸ªæ‰€è°“çš„<em>å‡½æ•°æ¥å£</em>å¿…é¡»åŒ…å«ä¸€ä¸ª<strong>æŠ½è±¡æ–¹æ³•å£°æ˜</strong>ã€‚è¯¥ç±»å‹çš„æ¯ä¸ª lambda è¡¨è¾¾å¼éƒ½å°†ä¸æ­¤æŠ½è±¡æ–¹æ³•åŒ¹é…ã€‚ç”±äºé»˜è®¤æ–¹æ³•ä¸æ˜¯æŠ½è±¡çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥è‡ªç”±åœ°æ·»åŠ é»˜è®¤æ–¹æ³•åˆ°ä½ çš„å‡½æ•°æ¥å£ã€‚</p>
<p>åªè¦ä¿è¯æ¥å£ä»…åŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œå°±å¯ä»¥ä½¿ç”¨ä»»æ„çš„æ¥å£ä½œä¸º lambda è¡¨è¾¾å¼ã€‚ä¸ºç¡®ä¿æ‚¨çš„æ¥å£ç¬¦åˆè¦æ±‚ï¼Œæ‚¨åº”è¯¥æ·»åŠ  <code>@FunctionalInterface</code> æ³¨è§£ã€‚ç¼–è¯‘å™¨æ³¨æ„åˆ°è¿™ä¸ªæ³¨è§£åï¼Œä¸€æ—¦æ‚¨å°è¯•åœ¨æ¥å£ä¸­æ·»åŠ ç¬¬äºŒä¸ªæŠ½è±¡æ–¹æ³•å£°æ˜ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ›å‡ºç¼–è¯‘å™¨é”™è¯¯ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FunctionalInterface</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">Converter</span>&lt;F, T&gt; &#123;</span><br><span class="line">    T <span class="title function_">convert</span><span class="params">(F from)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Converter&lt;String, Integer&gt; converter = (from) -&gt; Integer.valueOf(from);</span><br><span class="line"><span class="type">Integer</span> <span class="variable">converted</span> <span class="operator">=</span> converter.convert(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">System.out.println(converted);    <span class="comment">// 123</span></span><br></pre></td></tr></table></figure>

<p>è¯·è®°ä½ï¼Œå¦‚æœ <code>@FunctionalInterface</code> æ³¨è§£è¢«çœç•¥ï¼Œä»£ç ä¹Ÿæ˜¯æœ‰æ•ˆçš„ã€‚</p>
<h2 id="Method-and-Constructor-References-æ–¹æ³•å’Œæ„é€ å™¨å¼•ç”¨"><a href="#Method-and-Constructor-References-æ–¹æ³•å’Œæ„é€ å™¨å¼•ç”¨" class="headerlink" title="Method and Constructor References(æ–¹æ³•å’Œæ„é€ å™¨å¼•ç”¨)"></a>Method and Constructor References(æ–¹æ³•å’Œæ„é€ å™¨å¼•ç”¨)</h2><p>ä¸Šé¢çš„ç¤ºä¾‹ä»£ç å¯ä»¥é€šè¿‡ä½¿ç”¨é™æ€æ–¹æ³•å¼•ç”¨è¿›ä¸€æ­¥ç®€åŒ–ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Converter&lt;String, Integer&gt; converter = Integer::valueOf;</span><br><span class="line"><span class="type">Integer</span> <span class="variable">converted</span> <span class="operator">=</span> converter.convert(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">System.out.println(converted);   <span class="comment">// 123</span></span><br></pre></td></tr></table></figure>

<p>Java 8 å…è®¸æ‚¨é€šè¿‡ <code>::</code> å…³é”®å­—ä¼ é€’æ–¹æ³•æˆ–æ„é€ å‡½æ•°çš„å¼•ç”¨ã€‚ä¸Šé¢çš„ä¾‹å­å±•ç¤ºäº†å¦‚ä½•å¼•ç”¨ä¸€ä¸ªé™æ€æ–¹æ³•ã€‚ä½†æ˜¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å¼•ç”¨å¯¹è±¡æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Something</span> &#123;</span><br><span class="line">    String <span class="title function_">startsWith</span><span class="params">(String s)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(s.charAt(<span class="number">0</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Something</span> <span class="variable">something</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Something</span>();</span><br><span class="line">Converter&lt;String, String&gt; converter = something::startsWith;</span><br><span class="line"><span class="type">String</span> <span class="variable">converted</span> <span class="operator">=</span> converter.convert(<span class="string">&quot;Java&quot;</span>);</span><br><span class="line">System.out.println(converted);    <span class="comment">// &quot;J&quot;</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æ¥è§‚å¯Ÿä¸€ä¸‹ <code>::</code> å…³é”®å­—æ˜¯å¦‚ä½•ä½œç”¨äºæ„é€ å™¨çš„ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæœ‰å¤šä¸ªæ„é€ å™¨çš„ç¤ºä¾‹ç±»ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">    String firstName;</span><br><span class="line">    String lastName;</span><br><span class="line"></span><br><span class="line">    Person() &#123;&#125;</span><br><span class="line"></span><br><span class="line">    Person(String firstName, String lastName) &#123;</span><br><span class="line">        <span class="built_in">this</span>.firstName = firstName;</span><br><span class="line">        <span class="built_in">this</span>.lastName = lastName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ¥ç€ï¼Œæˆ‘ä»¬æŒ‡å®šä¸€ä¸ªç”¨äºåˆ›å»º Person å¯¹è±¡çš„ PersonFactory æ¥å£ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">PersonFactory</span>&lt;P <span class="keyword">extends</span> <span class="title class_">Person</span>&gt; &#123;</span><br><span class="line">    P <span class="title function_">create</span><span class="params">(String firstName, String lastName)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬ä¸æ˜¯æ‰‹åŠ¨å®ç°å·¥å‚ï¼Œè€Œæ˜¯é€šè¿‡æ„é€ å¼•ç”¨å°†æ‰€æœ‰ä¸œè¥¿ç²˜åˆåœ¨ä¸€èµ·ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PersonFactory&lt;Person&gt; personFactory = Person::<span class="keyword">new</span>;</span><br><span class="line"><span class="type">Person</span> <span class="variable">person</span> <span class="operator">=</span> personFactory.create(<span class="string">&quot;Peter&quot;</span>, <span class="string">&quot;Parker&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬é€šè¿‡ <code>Person::new</code> æ¥åˆ›å»ºä¸€ä¸ª Person æ„é€ å™¨çš„å¼•ç”¨ã€‚Java ç¼–è¯‘å™¨ä¼šæ ¹æ®<code>PersonFactory.create</code> çš„ç­¾åè‡ªåŠ¨åŒ¹é…æ­£ç¡®çš„æ„é€ å™¨ã€‚</p>
<h2 id="Lambda-Scopes-Lambda-ä½œç”¨åŸŸ"><a href="#Lambda-Scopes-Lambda-ä½œç”¨åŸŸ" class="headerlink" title="Lambda Scopes(Lambda ä½œç”¨åŸŸ)"></a>Lambda Scopes(Lambda ä½œç”¨åŸŸ)</h2><p>ä» lambda è¡¨è¾¾å¼è®¿é—®å¤–éƒ¨ä½œç”¨åŸŸå˜é‡ä¸åŒ¿åå¯¹è±¡éå¸¸ç›¸ä¼¼ã€‚æ‚¨å¯ä»¥è®¿é—®æœ¬åœ°å¤–éƒ¨ä½œç”¨åŸŸçš„å¸¸é‡ä»¥åŠå®ä¾‹çš„æˆå‘˜å˜é‡å’Œé™æ€å˜é‡ã€‚</p>
<h3 id="Accessing-local-variables-è®¿é—®æœ¬åœ°å˜é‡"><a href="#Accessing-local-variables-è®¿é—®æœ¬åœ°å˜é‡" class="headerlink" title="Accessing local variables(è®¿é—®æœ¬åœ°å˜é‡)"></a>Accessing local variables(è®¿é—®æœ¬åœ°å˜é‡)</h3><p>æˆ‘ä»¬å¯ä»¥è®¿é—® lambda è¡¨è¾¾å¼ä½œç”¨åŸŸå¤–éƒ¨çš„å¸¸é‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">Converter&lt;Integer, String&gt; stringConverter =</span><br><span class="line">        (from) -&gt; String.valueOf(from + num);</span><br><span class="line"></span><br><span class="line">stringConverter.convert(<span class="number">2</span>);     <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>ä¸åŒäºåŒ¿åå¯¹è±¡çš„æ˜¯ï¼šè¿™ä¸ªå˜é‡ <code>num</code> ä¸æ˜¯ä¸€å®šè¦è¢« <code>final</code> ä¿®é¥°ã€‚ä¸‹é¢çš„ä»£ç ä¸€æ ·åˆæ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">Converter&lt;Integer, String&gt; stringConverter =</span><br><span class="line">        (from) -&gt; String.valueOf(from + num);</span><br><span class="line"></span><br><span class="line">stringConverter.convert(<span class="number">2</span>);     <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ï¼Œ<code>num</code> å¿…é¡»æ˜¯éšå¼å¸¸é‡çš„ã€‚ä¸‹é¢çš„ä»£ç ä¸èƒ½ç¼–è¯‘é€šè¿‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">num</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line">Converter&lt;Integer, String&gt; stringConverter =</span><br><span class="line">        (from) -&gt; String.valueOf(from + num);</span><br><span class="line">num = <span class="number">3</span>;</span><br></pre></td></tr></table></figure>

<p>æ­¤å¤–ï¼Œåœ¨ lambda è¡¨è¾¾å¼ä¸­å¯¹ <code>num</code> åšå†™æ“ä½œä¹Ÿæ˜¯è¢«ç¦æ­¢çš„ã€‚</p>
<h3 id="Accessing-fields-and-static-variables-è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡"><a href="#Accessing-fields-and-static-variables-è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡" class="headerlink" title="Accessing fields and static variables(è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡)"></a>Accessing fields and static variables(è®¿é—®æˆå‘˜å˜é‡å’Œé™æ€å˜é‡)</h3><p>ä¸å±€éƒ¨å˜é‡ç›¸æ¯”ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥åœ¨ lambda è¡¨è¾¾å¼ä¸­è¯»å†™å®ä¾‹çš„æˆå‘˜å˜é‡ï¼Œä¹Ÿå¯ä»¥è¯»å†™å®ä¾‹çš„é™æ€å˜é‡ã€‚è¿™ç§è¡Œä¸ºåœ¨åŒ¿åå¯¹è±¡ä¸­æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Lambda4</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="type">int</span> outerStaticNum;</span><br><span class="line">    <span class="type">int</span> outerNum;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">testScopes</span><span class="params">()</span> &#123;</span><br><span class="line">        Converter&lt;Integer, String&gt; stringConverter1 = (from) -&gt; &#123;</span><br><span class="line">            outerNum = <span class="number">23</span>;</span><br><span class="line">            <span class="keyword">return</span> String.valueOf(from);</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        Converter&lt;Integer, String&gt; stringConverter2 = (from) -&gt; &#123;</span><br><span class="line">            outerStaticNum = <span class="number">72</span>;</span><br><span class="line">            <span class="keyword">return</span> String.valueOf(from);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Accessing-Default-Interface-Methodsï¼ˆè®¿é—®é»˜è®¤çš„æ¥å£æ–¹æ³•ï¼‰"><a href="#Accessing-Default-Interface-Methodsï¼ˆè®¿é—®é»˜è®¤çš„æ¥å£æ–¹æ³•ï¼‰" class="headerlink" title="Accessing Default Interface Methodsï¼ˆè®¿é—®é»˜è®¤çš„æ¥å£æ–¹æ³•ï¼‰"></a>Accessing Default Interface Methodsï¼ˆè®¿é—®é»˜è®¤çš„æ¥å£æ–¹æ³•ï¼‰</h3><p>è¿˜è®°å¾—ç¬¬ä¸€èŠ‚çš„ formula ä¾‹å­å—ï¼Ÿ <code>Formula</code> æ¥å£å®šä¹‰äº†ä¸€ä¸ªé»˜è®¤æ–¹æ³• <code>sqrt</code>ï¼Œå®ƒå¯ä»¥è¢«æ¯ä¸ª formula å®ä¾‹ï¼ˆåŒ…æ‹¬åŒ¿åå¯¹è±¡ï¼‰è®¿é—®ã€‚è¿™ä¸ªç‰¹æ€§ä¸é€‚ç”¨äº lambda è¡¨è¾¾å¼ã€‚</p>
<p>é»˜è®¤æ–¹æ³•<strong>ä¸èƒ½</strong>è¢« lambda è¡¨è¾¾å¼è®¿é—®ã€‚ä¸‹é¢çš„ä»£ç ä¸èƒ½ç¼–è¯‘é€šè¿‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Formula</span> <span class="variable">formula</span> <span class="operator">=</span> (a) -&gt; sqrt(a * <span class="number">100</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Built-in-Functional-Interfaces-å†…ç½®å‡½æ•°æ¥å£"><a href="#Built-in-Functional-Interfaces-å†…ç½®å‡½æ•°æ¥å£" class="headerlink" title="Built-in Functional Interfaces(å†…ç½®å‡½æ•°æ¥å£)"></a>Built-in Functional Interfaces(å†…ç½®å‡½æ•°æ¥å£)</h2><p>JDK 1.8 API åŒ…å«è®¸å¤šå†…ç½®çš„åŠŸèƒ½æ¥å£ã€‚å®ƒä»¬ä¸­çš„ä¸€äº›åœ¨è¾ƒæ—©çš„ Java ç‰ˆæœ¬ï¼ˆæ¯”å¦‚ <code>Comparator</code> æˆ– <code>Runnable</code>ï¼‰ä¸­æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€‚è¿™äº›ç°æœ‰çš„æ¥å£é€šè¿‡ <code>@FunctionalInterfaceannotation</code> æ³¨è§£è¢«æ‰©å±•ä¸ºæ”¯æŒ Lambdaã€‚</p>
<p>ä½†æ˜¯ï¼ŒJava 8 API ä¹Ÿæä¾›äº†ä¸å°‘æ–°çš„å‡½æ•°æ¥å£ã€‚å…¶ä¸­ä¸€äº›æ–°æ¥å£åœ¨ <a target="_blank" rel="noopener" href="https://code.google.com/p/guava-libraries/">Google Guava</a> åº“ä¸­æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€‚å³ä½¿æ‚¨ç†Ÿæ‚‰è¿™ä¸ªåº“ï¼Œä¹Ÿåº”è¯¥å¯†åˆ‡å…³æ³¨å¦‚ä½•é€šè¿‡ä¸€äº›æœ‰ç”¨çš„æ–¹æ³•æ‰©å±•æ¥æ‰©å±•è¿™äº›æ¥å£ã€‚</p>
<h3 id="Predicates"><a href="#Predicates" class="headerlink" title="Predicates"></a>Predicates</h3><p><code>Predicate</code> æ˜¯åªæœ‰ä¸€ä¸ªå‚æ•°çš„å¸ƒå°”å€¼å‡½æ•°ã€‚è¯¥æ¥å£åŒ…å«å„ç§é»˜è®¤æ–¹æ³•ï¼Œç”¨äºå°†è°“è¯ç»„åˆæˆå¤æ‚çš„é€»è¾‘æœ¯è¯­ï¼ˆä¸ã€æˆ–ã€éï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Predicate&lt;String&gt; predicate = (s) -&gt; s.length() &gt; <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">predicate.test(<span class="string">&quot;foo&quot;</span>);              <span class="comment">// true</span></span><br><span class="line">predicate.negate().test(<span class="string">&quot;foo&quot;</span>);     <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">Predicate&lt;Boolean&gt; nonNull = Objects::nonNull;</span><br><span class="line">Predicate&lt;Boolean&gt; isNull = Objects::isNull;</span><br><span class="line"></span><br><span class="line">Predicate&lt;String&gt; isEmpty = String::isEmpty;</span><br><span class="line">Predicate&lt;String&gt; isNotEmpty = isEmpty.negate();</span><br></pre></td></tr></table></figure>

<h3 id="Functions"><a href="#Functions" class="headerlink" title="Functions"></a>Functions</h3><p><code>Function</code> æ¥å—ä¸€ä¸ªå‚æ•°å¹¶äº§ç”Ÿä¸€ä¸ªç»“æœã€‚å¯ä»¥ä½¿ç”¨é»˜è®¤æ–¹æ³•å°†å¤šä¸ªå‡½æ•°é“¾æ¥åœ¨ä¸€èµ·ï¼ˆcomposeã€andThenï¼‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Function&lt;String, Integer&gt; toInteger = Integer::valueOf;</span><br><span class="line">Function&lt;String, String&gt; backToString = toInteger.andThen(String::valueOf);</span><br><span class="line"></span><br><span class="line">backToString.apply(<span class="string">&quot;123&quot;</span>);     <span class="comment">// &quot;123&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Suppliers"><a href="#Suppliers" class="headerlink" title="Suppliers"></a>Suppliers</h3><p><code>Supplier</code> äº§ç”Ÿä¸€ä¸ªæ³›å‹ç»“æœã€‚ä¸ <code>Function</code> ä¸åŒï¼Œ<code>Supplier</code> ä¸æ¥å—å‚æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Supplier&lt;Person&gt; personSupplier = Person::<span class="keyword">new</span>;</span><br><span class="line">personSupplier.get();   <span class="comment">// new Person</span></span><br></pre></td></tr></table></figure>

<h3 id="Consumers"><a href="#Consumers" class="headerlink" title="Consumers"></a>Consumers</h3><p>Consumer è¡¨ç¤ºè¦åœ¨ä¸€ä¸ªè¾“å…¥å‚æ•°ä¸Šæ‰§è¡Œçš„æ“ä½œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Consumer&lt;Person&gt; greeter = (p) -&gt; System.out.println(<span class="string">&quot;Hello, &quot;</span> + p.firstName);</span><br><span class="line">greeter.accept(<span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Luke&quot;</span>, <span class="string">&quot;Skywalker&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="Comparators"><a href="#Comparators" class="headerlink" title="Comparators"></a>Comparators</h3><p>æ¯”è¾ƒå™¨åœ¨è€ç‰ˆæœ¬çš„ Java ä¸­æ˜¯ä¼—æ‰€å‘¨çŸ¥çš„ã€‚ Java 8 ä¸ºæ¥å£æ·»åŠ äº†å„ç§é»˜è®¤æ–¹æ³•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Comparator&lt;Person&gt; comparator = (p1, p2) -&gt; p1.firstName.compareTo(p2.firstName);</span><br><span class="line"></span><br><span class="line"><span class="type">Person</span> <span class="variable">p1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;John&quot;</span>, <span class="string">&quot;Doe&quot;</span>);</span><br><span class="line"><span class="type">Person</span> <span class="variable">p2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;Alice&quot;</span>, <span class="string">&quot;Wonderland&quot;</span>);</span><br><span class="line"></span><br><span class="line">comparator.compare(p1, p2);             <span class="comment">// &gt; 0</span></span><br><span class="line">comparator.reversed().compare(p1, p2);  <span class="comment">// &lt; 0</span></span><br></pre></td></tr></table></figure>

<h2 id="Optionals"><a href="#Optionals" class="headerlink" title="Optionals"></a>Optionals</h2><p><code>Optional</code> ä¸æ˜¯åŠŸèƒ½æ€§æ¥å£ï¼Œè€Œæ˜¯é˜²æ­¢ <code>NullPointerException</code> çš„å¥½å·¥å…·ã€‚è¿™æ˜¯ä¸‹ä¸€èŠ‚çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µï¼Œæ‰€ä»¥è®©æˆ‘ä»¬å¿«é€Ÿçœ‹çœ‹ <code>Optional</code> æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p>
<p><code>Optional</code> æ˜¯ä¸€ä¸ªç®€å•çš„å®¹å™¨ï¼Œå…¶å€¼å¯ä»¥æ˜¯ null æˆ–é nullã€‚æƒ³æƒ³ä¸€ä¸ªå¯èƒ½è¿”å›ä¸€ä¸ªéç©ºç»“æœçš„æ–¹æ³•ï¼Œä½†æœ‰æ—¶å€™ä»€ä¹ˆéƒ½ä¸è¿”å›ã€‚ä¸æ˜¯è¿”å› nullï¼Œè€Œæ˜¯è¿”å› Java 8 ä¸­çš„ <code>Optional</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; optional = Optional.of(<span class="string">&quot;bam&quot;</span>);</span><br><span class="line"></span><br><span class="line">optional.isPresent();           <span class="comment">// true</span></span><br><span class="line">optional.get();                 <span class="comment">// &quot;bam&quot;</span></span><br><span class="line">optional.orElse(<span class="string">&quot;fallback&quot;</span>);    <span class="comment">// &quot;bam&quot;</span></span><br><span class="line"></span><br><span class="line">optional.ifPresent((s) -&gt; System.out.println(s.charAt(<span class="number">0</span>)));     <span class="comment">// &quot;b&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Streams"><a href="#Streams" class="headerlink" title="Streams"></a>Streams</h2><p><code>java.util.Stream</code> è¡¨ç¤ºå¯ä»¥åœ¨å…¶ä¸Šæ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ªæ“ä½œçš„å…ƒç´ åºåˆ—ã€‚æµæ“ä½œæ˜¯ä¸­é—´æˆ–ç»ˆç«¯ã€‚å½“ç»ˆç«¯æ“ä½œè¿”å›ä¸€ä¸ªç‰¹å®šç±»å‹çš„ç»“æœæ—¶ï¼Œä¸­é—´æ“ä½œè¿”å›æµæœ¬èº«ï¼Œæ‰€ä»¥ä½ å¯ä»¥é“¾æ¥å¤šä¸ªæ–¹æ³•è°ƒç”¨ã€‚æµåœ¨æºä¸Šåˆ›å»ºï¼Œä¾‹å¦‚ä¸€ä¸ª <code>java.util.Collection</code> åƒåˆ—è¡¨æˆ–é›†åˆï¼ˆä¸æ”¯æŒæ˜ å°„ï¼‰ã€‚æµæ“ä½œæ—¢å¯ä»¥æŒ‰é¡ºåºæ‰§è¡Œï¼Œä¹Ÿå¯ä»¥å¹¶è¡Œæ‰§è¡Œã€‚</p>
<blockquote>
<p>æµæ˜¯éå¸¸å¼ºå¤§çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘å†™äº†ä¸€ä¸ªç‹¬ç«‹çš„ <a target="_blank" rel="noopener" href="http://winterbe.com/posts/2014/07/31/java8-stream-tutorial-examples/">Java8 Streams æ•™ç¨‹</a> ã€‚<strong>æ‚¨è¿˜åº”è¯¥æŸ¥çœ‹ Sequentï¼Œå°†å…¶ä½œä¸º Web çš„ç±»ä¼¼åº“ã€‚</strong></p>
</blockquote>
<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹é¡ºåºæµå¦‚ä½•å·¥ä½œã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä»¥å­—ç¬¦ä¸²åˆ—è¡¨çš„å½¢å¼åˆ›å»ºä¸€ä¸ªç¤ºä¾‹æºä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">List&lt;String&gt; stringCollection = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">stringCollection.add(<span class="string">&quot;ddd2&quot;</span>);</span><br><span class="line">stringCollection.add(<span class="string">&quot;aaa2&quot;</span>);</span><br><span class="line">stringCollection.add(<span class="string">&quot;bbb1&quot;</span>);</span><br><span class="line">stringCollection.add(<span class="string">&quot;aaa1&quot;</span>);</span><br><span class="line">stringCollection.add(<span class="string">&quot;bbb3&quot;</span>);</span><br><span class="line">stringCollection.add(<span class="string">&quot;ccc&quot;</span>);</span><br><span class="line">stringCollection.add(<span class="string">&quot;bbb2&quot;</span>);</span><br><span class="line">stringCollection.add(<span class="string">&quot;ddd1&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>Java 8 ä¸­çš„é›†åˆå·²è¢«æ‰©å±•ï¼Œå› æ­¤æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨ <code>Collection.stream()</code> æˆ–<code>Collection.parallelStream()</code> æ¥ç®€å•åœ°åˆ›å»ºæµã€‚ä»¥ä¸‹å„èŠ‚ä»‹ç»æœ€å¸¸è§çš„æµæ“ä½œã€‚</p>
<h3 id="Filter"><a href="#Filter" class="headerlink" title="Filter"></a>Filter</h3><p>è¿‡æ»¤å™¨æ¥å—ä¸€ä¸ªè°“è¯æ¥è¿‡æ»¤æµçš„æ‰€æœ‰å…ƒç´ ã€‚è¿™ä¸ªæ“ä½œæ˜¯ä¸­é—´çš„ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿè°ƒç”¨å¦ä¸€ä¸ªæµæ“ä½œï¼ˆ<code>forEach</code>ï¼‰çš„ç»“æœã€‚ ForEach æ¥å—ä¸€ä¸ªæ¶ˆè´¹è€…è¢«æ‰§è¡Œçš„è¿‡æ»¤æµä¸­çš„æ¯ä¸ªå…ƒç´ ã€‚ ForEach æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œã€‚å®ƒæ˜¯æ— æ•ˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½è°ƒç”¨å¦ä¸€ä¸ªæµæ“ä½œã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">stringCollection</span><br><span class="line">    .stream()</span><br><span class="line">    .filter((s) -&gt; s.startsWith(<span class="string">&quot;a&quot;</span>))</span><br><span class="line">    .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;aaa2&quot;, &quot;aaa1&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Sorted"><a href="#Sorted" class="headerlink" title="Sorted"></a>Sorted</h3><p>æ’åºæ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œï¼Œè¿”å›æµçš„æ’åºè§†å›¾ã€‚å…ƒç´ æŒ‰è‡ªç„¶é¡ºåºæ’åºï¼Œé™¤éæ‚¨ä¼ é€’è‡ªå®šä¹‰æ¯”è¾ƒå™¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">stringCollection</span><br><span class="line">    .stream()</span><br><span class="line">    .sorted()</span><br><span class="line">    .filter((s) -&gt; s.startsWith(<span class="string">&quot;a&quot;</span>))</span><br><span class="line">    .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;aaa1&quot;, &quot;aaa2&quot;</span></span><br></pre></td></tr></table></figure>

<p>è¯·è®°ä½ï¼Œæ’åºåªä¼šåˆ›å»ºæµçš„æ’åºè§†å›¾ï¼Œè€Œä¸ä¼šæ“çºµæ”¯æŒçš„é›†åˆçš„æ’åºã€‚ <code>stringCollection</code> çš„æ’åºæ˜¯ä¸å˜çš„ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(stringCollection);</span><br><span class="line"><span class="comment">// ddd2, aaa2, bbb1, aaa1, bbb3, ccc, bbb2, ddd1</span></span><br></pre></td></tr></table></figure>

<h3 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h3><p>ä¸­é—´æ“ä½œæ˜ å°„é€šè¿‡ç»™å®šå‡½æ•°å°†æ¯ä¸ªå…ƒç´ è½¬æ¢ä¸ºå¦ä¸€ä¸ªå¯¹è±¡ã€‚ä»¥ä¸‹ç¤ºä¾‹å°†æ¯ä¸ªå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¤§å†™å­—æ¯å­—ç¬¦ä¸²ã€‚ä½†æ˜¯æ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>map</code> å°†æ¯ä¸ªå¯¹è±¡è½¬æ¢ä¸ºå¦ä¸€ç§ç±»å‹ã€‚ç»“æœæµçš„æ³›å‹ç±»å‹å–å†³äºæ‚¨ä¼ é€’ç»™ <code>map</code> çš„å‡½æ•°çš„æ³›å‹ç±»å‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">stringCollection</span><br><span class="line">    .stream()</span><br><span class="line">    .map(String::toUpperCase)</span><br><span class="line">    .sorted((a, b) -&gt; b.compareTo(a))</span><br><span class="line">    .forEach(System.out::println);</span><br><span class="line"></span><br><span class="line"><span class="comment">// &quot;DDD2&quot;, &quot;DDD1&quot;, &quot;CCC&quot;, &quot;BBB3&quot;, &quot;BBB2&quot;, &quot;AAA2&quot;, &quot;AAA1&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="Match"><a href="#Match" class="headerlink" title="Match"></a>Match</h3><p>å¯ä»¥ä½¿ç”¨å„ç§åŒ¹é…æ“ä½œæ¥æ£€æŸ¥æŸä¸ªè°“è¯æ˜¯å¦ä¸æµåŒ¹é…ã€‚æ‰€æœ‰è¿™äº›æ“ä½œéƒ½æ˜¯ç»ˆç«¯å¹¶è¿”å›å¸ƒå°”ç»“æœã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="variable">anyStartsWithA</span> <span class="operator">=</span></span><br><span class="line">    stringCollection</span><br><span class="line">        .stream()</span><br><span class="line">        .anyMatch((s) -&gt; s.startsWith(<span class="string">&quot;a&quot;</span>));</span><br><span class="line"></span><br><span class="line">System.out.println(anyStartsWithA);      <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="variable">allStartsWithA</span> <span class="operator">=</span></span><br><span class="line">    stringCollection</span><br><span class="line">        .stream()</span><br><span class="line">        .allMatch((s) -&gt; s.startsWith(<span class="string">&quot;a&quot;</span>));</span><br><span class="line"></span><br><span class="line">System.out.println(allStartsWithA);      <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="type">boolean</span> <span class="variable">noneStartsWithZ</span> <span class="operator">=</span></span><br><span class="line">    stringCollection</span><br><span class="line">        .stream()</span><br><span class="line">        .noneMatch((s) -&gt; s.startsWith(<span class="string">&quot;z&quot;</span>));</span><br><span class="line"></span><br><span class="line">System.out.println(noneStartsWithZ);      <span class="comment">// true</span></span><br></pre></td></tr></table></figure>

<h4 id="Count"><a href="#Count" class="headerlink" title="Count"></a>Count</h4><p>Count æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œè¿”å›æµä¸­å…ƒç´ çš„ä¸ªæ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">startsWithB</span> <span class="operator">=</span></span><br><span class="line">    stringCollection</span><br><span class="line">        .stream()</span><br><span class="line">        .filter((s) -&gt; s.startsWith(<span class="string">&quot;b&quot;</span>))</span><br><span class="line">        .count();</span><br><span class="line"></span><br><span class="line">System.out.println(startsWithB);    <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<h3 id="Reduce"><a href="#Reduce" class="headerlink" title="Reduce"></a>Reduce</h3><p>è¯¥ç»ˆç«¯æ“ä½œä½¿ç”¨ç»™å®šçš„åŠŸèƒ½å¯¹æµçš„å…ƒç´ è¿›è¡Œç¼©å‡ã€‚ç»“æœæ˜¯ä¸€ä¸ª <code>Optional</code> æŒæœ‰ç¼©å°åçš„å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Optional&lt;String&gt; reduced =</span><br><span class="line">    stringCollection</span><br><span class="line">        .stream()</span><br><span class="line">        .sorted()</span><br><span class="line">        .reduce((s1, s2) -&gt; s1 + <span class="string">&quot;#&quot;</span> + s2);</span><br><span class="line"></span><br><span class="line">reduced.ifPresent(System.out::println);</span><br><span class="line"><span class="comment">// &quot;aaa1##aaa2##bbb1##bbb2##bbb3##ccc##ddd1##ddd2&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Parallel-Streams"><a href="#Parallel-Streams" class="headerlink" title="Parallel Streams"></a>Parallel Streams</h2><p>å¦‚ä¸Šæ‰€è¿°ï¼Œæµå¯ä»¥æ˜¯é¡ºåºçš„ä¹Ÿå¯ä»¥æ˜¯å¹¶è¡Œçš„ã€‚é¡ºåºæµä¸Šçš„æ“ä½œåœ¨å•ä¸ªçº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œè€Œå¹¶è¡Œæµä¸Šçš„æ“ä½œåœ¨å¤šä¸ªçº¿ç¨‹ä¸ŠåŒæ—¶æ‰§è¡Œã€‚</p>
<p>ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†é€šè¿‡ä½¿ç”¨å¹¶è¡Œæµæé«˜æ€§èƒ½æ˜¯å¤šä¹ˆå®¹æ˜“ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè¾ƒå¤§çš„ç‹¬ç‰¹å…ƒç´ çš„åˆ—è¡¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> <span class="number">1000000</span>;</span><br><span class="line">List&lt;String&gt; values = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(max);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; max; i++) &#123;</span><br><span class="line">    <span class="type">UUID</span> <span class="variable">uuid</span> <span class="operator">=</span> UUID.randomUUID();</span><br><span class="line">    values.add(uuid.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç°åœ¨æˆ‘ä»¬æµ‹é‡å¯¹è¿™ä¸ªé›†åˆè¿›è¡Œæ’åºæ‰€èŠ±è´¹çš„æ—¶é—´ã€‚</p>
<h3 id="Sequential-Sort"><a href="#Sequential-Sort" class="headerlink" title="Sequential Sort"></a>Sequential Sort</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">t0</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> values.stream().sorted().count();</span><br><span class="line">System.out.println(count);</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">t1</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">millis</span> <span class="operator">=</span> TimeUnit.NANOSECONDS.toMillis(t1 - t0);</span><br><span class="line">System.out.println(String.format(<span class="string">&quot;sequential sort took: %d ms&quot;</span>, millis));</span><br><span class="line"></span><br><span class="line"><span class="comment">// sequential sort took: 899 ms</span></span><br></pre></td></tr></table></figure>

<h3 id="Parallel-Sort"><a href="#Parallel-Sort" class="headerlink" title="Parallel Sort"></a>Parallel Sort</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">long</span> <span class="variable">t0</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> values.parallelStream().sorted().count();</span><br><span class="line">System.out.println(count);</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">t1</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">millis</span> <span class="operator">=</span> TimeUnit.NANOSECONDS.toMillis(t1 - t0);</span><br><span class="line">System.out.println(String.format(<span class="string">&quot;parallel sort took: %d ms&quot;</span>, millis));</span><br><span class="line"></span><br><span class="line"><span class="comment">// parallel sort took: 472 ms</span></span><br></pre></td></tr></table></figure>

<p>å¦‚ä½ æ‰€è§ï¼Œä¸¤ä¸ªä»£ç æ®µå·®ä¸å¤šï¼Œä½†æ˜¯å¹¶è¡Œæ’åºå¿«äº†è¿‘ 50%ã€‚ä½ æ‰€éœ€åšçš„ä»…ä»…æ˜¯å°† <code>stream()</code> æ”¹ä¸º <code>parallelStream()</code> ã€‚</p>
<h2 id="Maps"><a href="#Maps" class="headerlink" title="Maps"></a>Maps</h2><p>å¦‚å‰æ‰€è¿°ï¼Œmap ä¸ç›´æ¥æ”¯æŒæµã€‚Map æ¥å£æœ¬èº«æ²¡æœ‰å¯ç”¨çš„ <code>stream()</code> æ–¹æ³•ï¼Œä½†æ˜¯ä½ å¯ä»¥é€šè¿‡ <code>map.keySet().stream()</code> ã€ <code>map.values().stream()</code> å’Œ <code>map.entrySet().stream()</code> åˆ›å»ºæŒ‡å®šçš„æµã€‚</p>
<p>æ­¤å¤–ï¼Œmap æ”¯æŒå„ç§æ–°çš„ã€æœ‰ç”¨çš„æ–¹æ³•æ¥å¤„ç†å¸¸è§ä»»åŠ¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;Integer, String&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    map.putIfAbsent(i, <span class="string">&quot;val&quot;</span> + i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">map.forEach((id, val) -&gt; System.out.println(val));</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢çš„ä»£ç åº”è¯¥æ˜¯è‡ªæˆ‘è§£é‡Šçš„ï¼š<code>putIfAbsent</code> é˜»æ­¢æˆ‘ä»¬å†™å…¥é¢å¤–çš„ç©ºå€¼æ£€æŸ¥ï¼›<code>forEach</code> æ¥å—æ¶ˆè´¹è€…ä¸º map çš„æ¯ä¸ªå€¼å®ç°æ“ä½œã€‚</p>
<p>è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•åˆ©ç”¨å‡½æ•°æ¥è®¡ç®— map ä¸Šçš„ä»£ç ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">map.computeIfPresent(<span class="number">3</span>, (num, val) -&gt; val + num);</span><br><span class="line">map.get(<span class="number">3</span>);             <span class="comment">// val33</span></span><br><span class="line"></span><br><span class="line">map.computeIfPresent(<span class="number">9</span>, (num, val) -&gt; <span class="literal">null</span>);</span><br><span class="line">map.containsKey(<span class="number">9</span>);     <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line">map.computeIfAbsent(<span class="number">23</span>, num -&gt; <span class="string">&quot;val&quot;</span> + num);</span><br><span class="line">map.containsKey(<span class="number">23</span>);    <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">map.computeIfAbsent(<span class="number">3</span>, num -&gt; <span class="string">&quot;bam&quot;</span>);</span><br><span class="line">map.get(<span class="number">3</span>);             <span class="comment">// val33</span></span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å­¦ä¹ å¦‚ä½•åˆ é™¤ç»™å®šé”®çš„æ¡ç›®ï¼Œåªæœ‰å½“å‰é”®æ˜ å°„åˆ°ç»™å®šå€¼æ—¶ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">map.remove(<span class="number">3</span>, <span class="string">&quot;val3&quot;</span>);</span><br><span class="line">map.get(<span class="number">3</span>);             <span class="comment">// val33</span></span><br><span class="line"></span><br><span class="line">map.remove(<span class="number">3</span>, <span class="string">&quot;val33&quot;</span>);</span><br><span class="line">map.get(<span class="number">3</span>);             <span class="comment">// null</span></span><br></pre></td></tr></table></figure>

<p>å¦ä¸€ä¸ªæœ‰ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map.getOrDefault(<span class="number">42</span>, <span class="string">&quot;not found&quot;</span>);  <span class="comment">// not found</span></span><br></pre></td></tr></table></figure>

<p>åˆå¹¶ä¸€ä¸ª map çš„ entry å¾ˆç®€å•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">map.merge(<span class="number">9</span>, <span class="string">&quot;val9&quot;</span>, (value, newValue) -&gt; value.concat(newValue));</span><br><span class="line">map.get(<span class="number">9</span>);             <span class="comment">// val9</span></span><br><span class="line"></span><br><span class="line">map.merge(<span class="number">9</span>, <span class="string">&quot;concat&quot;</span>, (value, newValue) -&gt; value.concat(newValue));</span><br><span class="line">map.get(<span class="number">9</span>);             <span class="comment">// val9concat</span></span><br></pre></td></tr></table></figure>

<p>å¦‚æœä¸å­˜åœ¨è¯¥é”®çš„æ¡ç›®ï¼Œåˆå¹¶æˆ–è€…å°†é”®&#x2F;å€¼æ”¾å…¥ map ä¸­ï¼›å¦åˆ™å°†è°ƒç”¨åˆå¹¶å‡½æ•°æ¥æ›´æ”¹ç°æœ‰å€¼ã€‚</p>
<h2 id="Date-API"><a href="#Date-API" class="headerlink" title="Date API"></a>Date API</h2><p>Java 8 åœ¨ <code>java.time</code> åŒ…ä¸‹æ–°å¢äº†ä¸€ä¸ªå…¨æ–°çš„æ—¥æœŸå’Œæ—¶é—´ APIã€‚æ–°çš„æ—¥æœŸ API ä¸ <a target="_blank" rel="noopener" href="http://www.joda.org/joda-time/">Joda-Time</a> åº“ç›¸ä¼¼ï¼Œä½†ä¸ä¸€æ ·ã€‚ä»¥ä¸‹ç¤ºä¾‹æ¶µç›–äº†æ­¤æ–° API çš„æœ€é‡è¦éƒ¨åˆ†ã€‚</p>
<h3 id="Clock"><a href="#Clock" class="headerlink" title="Clock"></a>Clock</h3><p><code>Clock</code> æä¾›å¯¹å½“å‰æ—¥æœŸå’Œæ—¶é—´çš„è®¿é—®ã€‚<code>Clock</code> çŸ¥é“ä¸€ä¸ªæ—¶åŒºï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥ä»£æ›¿ <code>System.currentTimeMillis()</code> ï¼Œè·å–ä» <strong>Unix EPOCH</strong> å¼€å§‹çš„ä»¥æ¯«ç§’ä¸ºå•ä½çš„å½“å‰æ—¶é—´ã€‚æ—¶é—´çº¿ä¸Šçš„æŸä¸€æ—¶åˆ»ä¹Ÿç”±ç±» <code>Instant</code> è¡¨ç¤ºã€‚ Instants å¯ä»¥ç”¨æ¥åˆ›å»ºé—ç•™çš„ <code>java.util.Date</code> å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Clock</span> <span class="variable">clock</span> <span class="operator">=</span> Clock.systemDefaultZone();</span><br><span class="line"><span class="type">long</span> <span class="variable">millis</span> <span class="operator">=</span> clock.millis();</span><br><span class="line"></span><br><span class="line"><span class="type">Instant</span> <span class="variable">instant</span> <span class="operator">=</span> clock.instant();</span><br><span class="line"><span class="type">Date</span> <span class="variable">legacyDate</span> <span class="operator">=</span> Date.from(instant);   <span class="comment">// legacy java.util.Date</span></span><br></pre></td></tr></table></figure>

<h3 id="Timezones"><a href="#Timezones" class="headerlink" title="Timezones"></a>Timezones</h3><p>æ—¶åŒºç”± <code>ZoneId</code> è¡¨ç¤ºã€‚ä»–ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ°é€šè¿‡é™æ€å·¥å‚æ–¹æ³•è®¿é—®ã€‚æ—¶åŒºå®šä¹‰äº†æŸä¸€æ—¶åˆ»å’Œå½“åœ°æ—¥æœŸã€æ—¶é—´ä¹‹é—´è½¬æ¢çš„é‡è¦åç§»é‡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(ZoneId.getAvailableZoneIds());</span><br><span class="line"><span class="comment">// prints all available timezone ids</span></span><br><span class="line"></span><br><span class="line"><span class="type">ZoneId</span> <span class="variable">zone1</span> <span class="operator">=</span> ZoneId.of(<span class="string">&quot;Europe/Berlin&quot;</span>);</span><br><span class="line"><span class="type">ZoneId</span> <span class="variable">zone2</span> <span class="operator">=</span> ZoneId.of(<span class="string">&quot;Brazil/East&quot;</span>);</span><br><span class="line">System.out.println(zone1.getRules());</span><br><span class="line">System.out.println(zone2.getRules());</span><br><span class="line"></span><br><span class="line"><span class="comment">// ZoneRules[currentStandardOffset=+01:00]</span></span><br><span class="line"><span class="comment">// ZoneRules[currentStandardOffset=-03:00]</span></span><br></pre></td></tr></table></figure>

<h3 id="LocalTime"><a href="#LocalTime" class="headerlink" title="LocalTime"></a>LocalTime</h3><p><code>LocalTime</code> ä»£è¡¨æ²¡æœ‰æ—¶åŒºçš„æ—¶é—´ï¼Œä¾‹å¦‚æ™šä¸Š 10 ç‚¹æˆ– 17:30:15ã€‚ä»¥ä¸‹ç¤ºä¾‹ä¸ºä¸Šé¢å®šä¹‰çš„æ—¶åŒºåˆ›å»ºä¸¤ä¸ªæœ¬åœ°æ—¶é—´ã€‚ç„¶åæˆ‘ä»¬æ¯”è¾ƒä¸¤æ¬¡ï¼Œå¹¶è®¡ç®—ä¸¤æ¬¡ä¹‹é—´çš„å°æ—¶å’Œåˆ†é’Ÿçš„å·®å¼‚ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LocalTime</span> <span class="variable">now1</span> <span class="operator">=</span> LocalTime.now(zone1);</span><br><span class="line"><span class="type">LocalTime</span> <span class="variable">now2</span> <span class="operator">=</span> LocalTime.now(zone2);</span><br><span class="line"></span><br><span class="line">System.out.println(now1.isBefore(now2));  <span class="comment">// false</span></span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">hoursBetween</span> <span class="operator">=</span> ChronoUnit.HOURS.between(now1, now2);</span><br><span class="line"><span class="type">long</span> <span class="variable">minutesBetween</span> <span class="operator">=</span> ChronoUnit.MINUTES.between(now1, now2);</span><br><span class="line"></span><br><span class="line">System.out.println(hoursBetween);       <span class="comment">// -3</span></span><br><span class="line">System.out.println(minutesBetween);     <span class="comment">// -239</span></span><br></pre></td></tr></table></figure>

<p><code>LocalTime</code> å¸¦æœ‰å„ç§å·¥å‚æ–¹æ³•ï¼Œä»¥ç®€åŒ–æ–°å®ä¾‹çš„åˆ›å»ºï¼ŒåŒ…æ‹¬è§£ææ—¶é—´å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LocalTime</span> <span class="variable">late</span> <span class="operator">=</span> LocalTime.of(<span class="number">23</span>, <span class="number">59</span>, <span class="number">59</span>);</span><br><span class="line">System.out.println(late);       <span class="comment">// 23:59:59</span></span><br><span class="line"></span><br><span class="line"><span class="type">DateTimeFormatter</span> <span class="variable">germanFormatter</span> <span class="operator">=</span></span><br><span class="line">    DateTimeFormatter</span><br><span class="line">        .ofLocalizedTime(FormatStyle.SHORT)</span><br><span class="line">        .withLocale(Locale.GERMAN);</span><br><span class="line"></span><br><span class="line"><span class="type">LocalTime</span> <span class="variable">leetTime</span> <span class="operator">=</span> LocalTime.parse(<span class="string">&quot;13:37&quot;</span>, germanFormatter);</span><br><span class="line">System.out.println(leetTime);   <span class="comment">// 13:37</span></span><br></pre></td></tr></table></figure>

<h3 id="LocalDate"><a href="#LocalDate" class="headerlink" title="LocalDate"></a>LocalDate</h3><p><code>LocalDate</code> è¡¨ç¤ºä¸åŒçš„æ—¥æœŸï¼Œä¾‹å¦‚ï¼š2014 å¹´ 3 æœˆ 11 æ—¥ã€‚å®ƒæ˜¯ä¸å¯å˜çš„ï¼Œå¹¶ä¸”ä¸ <code>LocalTime</code> å®Œå…¨ç±»ä¼¼ã€‚è¯¥ç¤ºä¾‹æ¼”ç¤ºå¦‚ä½•é€šè¿‡åŠ å‡æ—¥ã€æœˆæˆ–å¹´æ¥è®¡ç®—æ–°æ—¥æœŸã€‚è¯·è®°ä½ï¼Œæ¯ä¸ªæ“ä½œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LocalDate</span> <span class="variable">today</span> <span class="operator">=</span> LocalDate.now();</span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">tomorrow</span> <span class="operator">=</span> today.plus(<span class="number">1</span>, ChronoUnit.DAYS);</span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">yesterday</span> <span class="operator">=</span> tomorrow.minusDays(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">independenceDay</span> <span class="operator">=</span> LocalDate.of(<span class="number">2014</span>, Month.JULY, <span class="number">4</span>);</span><br><span class="line"><span class="type">DayOfWeek</span> <span class="variable">dayOfWeek</span> <span class="operator">=</span> independenceDay.getDayOfWeek();</span><br><span class="line">System.out.println(dayOfWeek);    <span class="comment">// FRIDAY</span></span><br></pre></td></tr></table></figure>

<p>ä»ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­è§£æå‡º LocalDate å¯¹è±¡ï¼Œå’Œè§£æ LocalTime ä¸€æ ·çš„ç®€å•ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DateTimeFormatter</span> <span class="variable">germanFormatter</span> <span class="operator">=</span></span><br><span class="line">    DateTimeFormatter</span><br><span class="line">        .ofLocalizedDate(FormatStyle.MEDIUM)</span><br><span class="line">        .withLocale(Locale.GERMAN);</span><br><span class="line"></span><br><span class="line"><span class="type">LocalDate</span> <span class="variable">xmas</span> <span class="operator">=</span> LocalDate.parse(<span class="string">&quot;24.12.2014&quot;</span>, germanFormatter);</span><br><span class="line">System.out.println(xmas);   <span class="comment">// 2014-12-24</span></span><br></pre></td></tr></table></figure>

<h3 id="LocalDateTime"><a href="#LocalDateTime" class="headerlink" title="LocalDateTime"></a>LocalDateTime</h3><p>LocalDateTime è¡¨ç¤ºæ—¥æœŸæ—¶é—´ã€‚å®ƒå°†æ—¥æœŸå’Œæ—¶é—´ç»„åˆæˆä¸€ä¸ªå®ä¾‹ã€‚ <code>LocalDateTime</code> æ˜¯ä¸å¯å˜çš„ï¼Œå…¶ä½œç”¨ç±»ä¼¼äº <code>LocalTime</code> å’Œ <code>LocalDate</code>ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ–¹æ³•å»è·å–æ—¥æœŸæ—¶é—´ä¸­æŸä¸ªå•ä½çš„å€¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">LocalDateTime</span> <span class="variable">sylvester</span> <span class="operator">=</span> LocalDateTime.of(<span class="number">2014</span>, Month.DECEMBER, <span class="number">31</span>, <span class="number">23</span>, <span class="number">59</span>, <span class="number">59</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">DayOfWeek</span> <span class="variable">dayOfWeek</span> <span class="operator">=</span> sylvester.getDayOfWeek();</span><br><span class="line">System.out.println(dayOfWeek);      <span class="comment">// WEDNESDAY</span></span><br><span class="line"></span><br><span class="line"><span class="type">Month</span> <span class="variable">month</span> <span class="operator">=</span> sylvester.getMonth();</span><br><span class="line">System.out.println(month);          <span class="comment">// DECEMBER</span></span><br><span class="line"></span><br><span class="line"><span class="type">long</span> <span class="variable">minuteOfDay</span> <span class="operator">=</span> sylvester.getLong(ChronoField.MINUTE_OF_DAY);</span><br><span class="line">System.out.println(minuteOfDay);    <span class="comment">// 1439</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸€ä¸ªæ—¶åŒºçš„é™„åŠ ä¿¡æ¯å¯ä»¥è½¬ä¸ºä¸€ä¸ªå®ä¾‹ã€‚è¿™ä¸ªå®ä¾‹å¾ˆå®¹æ˜“è½¬ä¸º<code>java.util.Date</code> ç±»å‹ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Instant</span> <span class="variable">instant</span> <span class="operator">=</span> sylvester</span><br><span class="line">        .atZone(ZoneId.systemDefault())</span><br><span class="line">        .toInstant();</span><br><span class="line"></span><br><span class="line"><span class="type">Date</span> <span class="variable">legacyDate</span> <span class="operator">=</span> Date.from(instant);</span><br><span class="line">System.out.println(legacyDate);     <span class="comment">// Wed Dec 31 23:59:59 CET 2014</span></span><br></pre></td></tr></table></figure>

<p>æ—¥æœŸæ—¶é—´çš„æ ¼å¼åŒ–ç±»ä¼¼äº Date æˆ– Timeã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰æ¨¡å¼åˆ›å»ºæ ¼å¼åŒ–ç¨‹åºï¼Œè€Œä¸æ˜¯ä½¿ç”¨é¢„å®šä¹‰çš„æ ¼å¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DateTimeFormatter</span> <span class="variable">formatter</span> <span class="operator">=</span></span><br><span class="line">    DateTimeFormatter</span><br><span class="line">        .ofPattern(<span class="string">&quot;MMM dd, yyyy - HH:mm&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">LocalDateTime</span> <span class="variable">parsed</span> <span class="operator">=</span> LocalDateTime.parse(<span class="string">&quot;Nov 03, 2014 - 07:13&quot;</span>, formatter);</span><br><span class="line"><span class="type">String</span> <span class="variable">string</span> <span class="operator">=</span> formatter.format(parsed);</span><br><span class="line">System.out.println(string);     <span class="comment">// Nov 03, 2014 - 07:13</span></span><br></pre></td></tr></table></figure>

<p>ä¸åŒäº <code>java.text.NumberFormat</code> ï¼Œ <code>DateTimeFormatter</code> æ˜¯ä¸å¯å˜ä¸”<strong>çº¿ç¨‹å®‰å…¨çš„</strong> ã€‚</p>
<p>æ›´å¤šå…³äºæ—¥æœŸæ ¼å¼åŒ–çš„å†…å®¹å¯ä»¥å‚è€ƒ<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/time/format/DateTimeFormatter.html">è¿™é‡Œ</a>.</p>
<h2 id="Annotations"><a href="#Annotations" class="headerlink" title="Annotations"></a>Annotations</h2><p>Java 8 ä¸­çš„æ³¨é‡Šæ˜¯å¯é‡å¤çš„ã€‚è®©æˆ‘ä»¬ç›´æ¥çœ‹ä¸€ä¸ªä¾‹å­æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŒ…å«å®é™…æ³¨é‡Šæ•°ç»„çš„å¤–å±‚æ³¨é‡Šï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@interface</span> Hints &#123;</span><br><span class="line">    Hint[] value();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repeatable(Hints.class)</span></span><br><span class="line"><span class="meta">@interface</span> Hint &#123;</span><br><span class="line">    String <span class="title function_">value</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Java8 å…è®¸æˆ‘ä»¬é€šè¿‡ä½¿ç”¨ <code>@Repeatable</code> æ³¨è§£æ¥å¼•å…¥å¤šä¸ªåŒç±»å‹çš„æ³¨è§£ã€‚</p>
<h3 id="Variant-1-ä½¿ç”¨å®¹å™¨æ³¨è§£-è€å¥—è·¯"><a href="#Variant-1-ä½¿ç”¨å®¹å™¨æ³¨è§£-è€å¥—è·¯" class="headerlink" title="Variant 1: ä½¿ç”¨å®¹å™¨æ³¨è§£ (è€å¥—è·¯)"></a>Variant 1: ä½¿ç”¨å®¹å™¨æ³¨è§£ (è€å¥—è·¯)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Hints(&#123;@Hint(&quot;hint1&quot;), @Hint(&quot;hint2&quot;)&#125;)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Variant-2-ä½¿ç”¨-repeatable-æ³¨è§£-æ–°å¥—è·¯"><a href="#Variant-2-ä½¿ç”¨-repeatable-æ³¨è§£-æ–°å¥—è·¯" class="headerlink" title="Variant 2: ä½¿ç”¨ repeatable æ³¨è§£ (æ–°å¥—è·¯)"></a>Variant 2: ä½¿ç”¨ repeatable æ³¨è§£ (æ–°å¥—è·¯)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Hint(&quot;hint1&quot;)</span></span><br><span class="line"><span class="meta">@Hint(&quot;hint2&quot;)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨åœºæ™¯ 2ï¼ŒJava ç¼–è¯‘å™¨éšå¼åœ°è®¾ç½®äº† <code>@Hints</code> æ³¨è§£ã€‚</p>
<p>è¿™å¯¹äºé€šè¿‡åå°„æ¥è¯»å–æ³¨è§£ä¿¡æ¯å¾ˆé‡è¦ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Hint</span> <span class="variable">hint</span> <span class="operator">=</span> Person.class.getAnnotation(Hint.class);</span><br><span class="line">System.out.println(hint);                   <span class="comment">// null</span></span><br><span class="line"></span><br><span class="line"><span class="type">Hints</span> <span class="variable">hints1</span> <span class="operator">=</span> Person.class.getAnnotation(Hints.class);</span><br><span class="line">System.out.println(hints1.value().length);  <span class="comment">// 2</span></span><br><span class="line"></span><br><span class="line">Hint[] hints2 = Person.class.getAnnotationsByType(Hint.class);</span><br><span class="line">System.out.println(hints2.length);          <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<p>å°½ç®¡ï¼Œæˆ‘ä»¬ä»æ²¡æœ‰åœ¨ Person ç±»ä¸Šå£°æ˜ <code>@Hints</code> æ³¨è§£ï¼Œä½†æ˜¯ä»å¯ä»¥é€šè¿‡<code>getAnnotation(Hints.class)</code> è¯»å–å®ƒã€‚ç„¶è€Œï¼Œæ›´ä¾¿åˆ©çš„æ–¹å¼æ˜¯ <code>getAnnotationsByType</code> ï¼Œå®ƒå¯ä»¥ç›´æ¥è®¿é—®æ‰€æœ‰ <code>@Hint</code> æ³¨è§£ã€‚</p>
<p>æ­¤å¤–ï¼ŒJava 8 ä¸­çš„æ³¨é‡Šä½¿ç”¨æ‰©å±•äº†ä¸¤ä¸ªæ–°çš„ç›®æ ‡ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Target(&#123;ElementType.TYPE_PARAMETER, ElementType.TYPE_USE&#125;)</span></span><br><span class="line"><span class="meta">@interface</span> MyAnnotation &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>æ°´å¹³çº¿ä»¥ä¸Šä¸º <a target="_blank" rel="noopener" href="https://github.com/winterbe/java8-tutorial">java8-tutorial</a> ç¿»è¯‘å†…å®¹ã€‚</p>
<hr>
<h2 id="JDK8-å‡çº§å¸¸è§é—®é¢˜"><a href="#JDK8-å‡çº§å¸¸è§é—®é¢˜" class="headerlink" title="JDK8 å‡çº§å¸¸è§é—®é¢˜"></a>JDK8 å‡çº§å¸¸è§é—®é¢˜</h2><blockquote>
<p>JDK8 å‘å¸ƒå¾ˆä¹…äº†ï¼Œå®ƒæä¾›äº†è®¸å¤šå¸å¼•äººçš„æ–°ç‰¹æ€§ï¼Œèƒ½å¤Ÿæé«˜ç¼–ç¨‹æ•ˆç‡ã€‚</p>
<p>å¦‚æœæ˜¯æ–°çš„é¡¹ç›®ï¼Œä½¿ç”¨ JDK8 å½“ç„¶æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚ä½†æ˜¯ï¼Œå¯¹äºä¸€äº›è€çš„é¡¹ç›®ï¼Œå‡çº§åˆ° JDK8 åˆ™å­˜åœ¨ä¸€äº›å…¼å®¹æ€§é—®é¢˜ï¼Œæ˜¯å¦å‡çº§éœ€è¦é…Œæƒ…è€ƒè™‘ã€‚</p>
<p>è¿‘æœŸï¼Œæˆ‘åœ¨å·¥ä½œä¸­é‡åˆ°ä¸€ä¸ªä»»åŠ¡ï¼Œå°†éƒ¨é—¨æ‰€æœ‰é¡¹ç›®çš„ JDK ç‰ˆæœ¬å‡çº§åˆ° 1.8 ï¼ˆè€ç‰ˆæœ¬å¤§å¤šæ˜¯ 1.6ï¼‰ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œé‡åˆ°ä¸€äº›é—®é¢˜ç‚¹ï¼Œå¹¶ç»“åˆåœ¨ç½‘ä¸Šçœ‹åˆ°çš„å‘ï¼Œåœ¨è¿™é‡Œæ€»ç»“ä¸€ä¸‹ã€‚</p>
</blockquote>
<h3 id="Intellij-ä¸­çš„-JDK-ç¯å¢ƒè®¾ç½®"><a href="#Intellij-ä¸­çš„-JDK-ç¯å¢ƒè®¾ç½®" class="headerlink" title="Intellij ä¸­çš„ JDK ç¯å¢ƒè®¾ç½®"></a>Intellij ä¸­çš„ JDK ç¯å¢ƒè®¾ç½®</h3><h4 id="Settings"><a href="#Settings" class="headerlink" title="Settings"></a>Settings</h4><p>ç‚¹å‡» <strong>File &gt; Settings &gt; Java Compiler</strong></p>
<p>Project bytecode version é€‰æ‹© 1.8</p>
<p>ç‚¹å‡» <strong>File &gt; Settings &gt; Build Tools &gt; Maven &gt; Importing</strong></p>
<p>é€‰æ‹© JDK for importer ä¸º 1.8</p>
<h4 id="Projcet-Settings"><a href="#Projcet-Settings" class="headerlink" title="Projcet Settings"></a>Projcet Settings</h4><p><strong>Project SDK</strong> é€‰æ‹© 1.8</p>
<h4 id="Application"><a href="#Application" class="headerlink" title="Application"></a>Application</h4><p>å¦‚æœ web åº”ç”¨çš„å¯åŠ¨æ–¹å¼ä¸º Application ï¼Œéœ€è¦ä¿®æ”¹ JRE</p>
<p>ç‚¹å‡» <strong>Run&#x2F;Debug Configurations &gt; Configuration</strong></p>
<p>é€‰æ‹© JRE ä¸º 1.8</p>
<h3 id="Linux-ç¯å¢ƒä¿®æ”¹"><a href="#Linux-ç¯å¢ƒä¿®æ”¹" class="headerlink" title="Linux ç¯å¢ƒä¿®æ”¹"></a>Linux ç¯å¢ƒä¿®æ”¹</h3><h4 id="ä¿®æ”¹ç¯å¢ƒå˜é‡"><a href="#ä¿®æ”¹ç¯å¢ƒå˜é‡" class="headerlink" title="ä¿®æ”¹ç¯å¢ƒå˜é‡"></a>ä¿®æ”¹ç¯å¢ƒå˜é‡</h4><p>ä¿®æ”¹ <code>/etc/profile</code> ä¸­çš„ <strong>JAVA_HOME</strong>ï¼Œè®¾ç½® ä¸º jdk8 æ‰€åœ¨è·¯å¾„ã€‚</p>
<p>ä¿®æ”¹åï¼Œæ‰§è¡Œ <code>source /etc/profile</code> ç”Ÿæ•ˆã€‚</p>
<p>ç¼–è¯‘ã€å‘å¸ƒè„šæœ¬ä¸­å¦‚æœæœ‰ <code>export JAVA_HOME</code> ï¼Œéœ€è¦æ³¨æ„ï¼Œéœ€è¦ä½¿ç”¨ jdk8 çš„è·¯å¾„ã€‚</p>
<h4 id="ä¿®æ”¹-maven"><a href="#ä¿®æ”¹-maven" class="headerlink" title="ä¿®æ”¹ maven"></a>ä¿®æ”¹ maven</h4><p>settings.xml ä¸­ profile çš„æ¿€æ´»æ¡ä»¶å¦‚æœæ˜¯ jdkï¼Œéœ€è¦ä¿®æ”¹ä¸€ä¸‹ jdk ç‰ˆæœ¬</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">activation</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">jdk</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">jdk</span>&gt;</span> <span class="comment">&lt;!-- ä¿®æ”¹ä¸º 1.8 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">activation</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="ä¿®æ”¹-server"><a href="#ä¿®æ”¹-server" class="headerlink" title="ä¿®æ”¹ server"></a>ä¿®æ”¹ server</h4><p>ä¿®æ”¹ server ä¸­çš„ javac ç‰ˆæœ¬ï¼Œä»¥ resin ä¸ºä¾‹ï¼š</p>
<p>ä¿®æ”¹ resin é…ç½®æ–‡ä»¶ä¸­çš„ javac å‚æ•°ã€‚</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">javac</span> <span class="attr">compiler</span>=<span class="string">&quot;internal&quot;</span> <span class="attr">args</span>=<span class="string">&quot;-source 1.8&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="sun-åŒ…ç¼ºå¤±é—®é¢˜"><a href="#sun-åŒ…ç¼ºå¤±é—®é¢˜" class="headerlink" title="sun.* åŒ…ç¼ºå¤±é—®é¢˜"></a>sun.* åŒ…ç¼ºå¤±é—®é¢˜</h3><p>JDK8 ä¸å†æä¾› <code>sun.*</code> åŒ…ä¾›å¼€å‘è€…ä½¿ç”¨ï¼Œå› ä¸ºè¿™äº›æ¥å£ä¸æ˜¯å…¬å…±æ¥å£ï¼Œä¸èƒ½ä¿è¯åœ¨æ‰€æœ‰ Java å…¼å®¹çš„å¹³å°ä¸Šå·¥ä½œã€‚</p>
<p>ä½¿ç”¨äº†è¿™äº› API çš„ç¨‹åºå¦‚æœè¦å‡çº§åˆ° JDK 1.8 éœ€è¦å¯»æ±‚æ›¿ä»£æ–¹æ¡ˆã€‚</p>
<p>è™½ç„¶ï¼Œä¹Ÿå¯ä»¥è‡ªå·±å¯¼å…¥åŒ…å« <code>sun.*</code> æ¥å£ jar åŒ…åˆ° classpath ç›®å½•ï¼Œä½†è¿™ä¸æ˜¯ä¸€ä¸ªå¥½çš„åšæ³•ã€‚</p>
<p>éœ€è¦è¯¦ç»†äº†è§£ä¸ºä»€ä¹ˆä¸è¦ä½¿ç”¨ <code>sun.*</code> ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼š<a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/java/faq-sun-packages-142232.html">Why Developers Should Not Write Programs That Call â€˜sunâ€™ Packages</a></p>
<h3 id="é»˜è®¤å®‰å…¨ç­–ç•¥ä¿®æ”¹"><a href="#é»˜è®¤å®‰å…¨ç­–ç•¥ä¿®æ”¹" class="headerlink" title="é»˜è®¤å®‰å…¨ç­–ç•¥ä¿®æ”¹"></a>é»˜è®¤å®‰å…¨ç­–ç•¥ä¿®æ”¹</h3><p>å‡çº§åä¼°è®¡æœ‰äº›å°ä¼™ä¼´åœ¨ä½¿ç”¨ä¸å®‰å…¨ç®—æ³•æ—¶å¯èƒ½ä¼šå‘ç”Ÿé”™è¯¯ï¼Œsoï¼Œæ”¯æŒä¸å®‰å…¨ç®—æ³•è¿˜æ˜¯æœ‰å¿…è¦çš„</p>
<p>æ‰¾åˆ°$JAVA_HOME ä¸‹ <code>jre/lib/security/java.security</code> ï¼Œå°†ç¦ç”¨çš„ç®—æ³•è®¾ç½®ä¸ºç©ºï¼š<code>jdk.certpath.disabledAlgorithms=</code> ã€‚</p>
<h3 id="JVM-å‚æ•°è°ƒæ•´"><a href="#JVM-å‚æ•°è°ƒæ•´" class="headerlink" title="JVM å‚æ•°è°ƒæ•´"></a>JVM å‚æ•°è°ƒæ•´</h3><p>åœ¨ jdk8 ä¸­ï¼ŒPermSize ç›¸å…³çš„å‚æ•°å·²ç»ä¸è¢«ä½¿ç”¨ï¼š</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-XX:MaxPermSize=size</span><br><span class="line"></span><br><span class="line">Sets <span class="keyword">the</span> maximum permanent generation <span class="literal">space</span> size (<span class="keyword">in</span> <span class="keyword">bytes</span>). This option was deprecated <span class="keyword">in</span> JDK <span class="number">8</span>, <span class="keyword">and</span> superseded <span class="keyword">by</span> <span class="keyword">the</span> -XX:MaxMetaspaceSize option.</span><br><span class="line"></span><br><span class="line">-XX:PermSize=size</span><br><span class="line"></span><br><span class="line">Sets <span class="keyword">the</span> <span class="literal">space</span> (<span class="keyword">in</span> <span class="keyword">bytes</span>) allocated <span class="built_in">to</span> <span class="keyword">the</span> permanent generation that triggers <span class="keyword">a</span> garbage collection <span class="keyword">if</span> <span class="keyword">it</span> is exceeded. This option was deprecated un JDK <span class="number">8</span>, <span class="keyword">and</span> superseded <span class="keyword">by</span> <span class="keyword">the</span> -XX:MetaspaceSize option.</span><br></pre></td></tr></table></figure>

<p>JDK8 ä¸­å†ä¹Ÿæ²¡æœ‰ <code>PermGen</code> äº†ã€‚å…¶ä¸­çš„æŸäº›éƒ¨åˆ†ï¼Œå¦‚è¢« intern çš„å­—ç¬¦ä¸²ï¼Œåœ¨ JDK7 ä¸­å·²ç»ç§»åˆ°äº†æ™®é€šå †é‡Œã€‚<strong>å…¶ä½™ç»“æ„åœ¨ JDK8 ä¸­ä¼šè¢«ç§»åˆ°ç§°ä½œâ€œMetaspaceâ€çš„æœ¬æœºå†…å­˜åŒºä¸­ï¼Œè¯¥åŒºåŸŸåœ¨é»˜è®¤æƒ…å†µä¸‹ä¼šè‡ªåŠ¨ç”Ÿé•¿ï¼Œä¹Ÿä¼šè¢«åƒåœ¾å›æ”¶ã€‚å®ƒæœ‰ä¸¤ä¸ªæ ‡è®°ï¼šMetaspaceSize å’Œ MaxMetaspaceSizeã€‚</strong></p>
<p>-XX:MetaspaceSize&#x3D;size</p>
<blockquote>
<p>Sets the size of the allocated class metadata space that will trigger a garbage collection the first time it is exceeded. This threshold for a garbage collection is increased or decreased depending on the amount of metadata used. The default size depends on the platform.</p>
</blockquote>
<p>-XX:MaxMetaspaceSize&#x3D;size</p>
<blockquote>
<p>Sets the maximum amount of native memory that can be allocated for class metadata. By default, the size is not limited. The amount of metadata for an application depends on the application itself, other running applications, and the amount of memory available on the system.</p>
</blockquote>
<p>ä»¥ä¸‹ç¤ºä¾‹æ˜¾ç¤ºå¦‚ä½•å°†ç±»ç±»å…ƒæ•°æ®çš„ä¸Šé™è®¾ç½®ä¸º 256 MBï¼š</p>
<p>XX:MaxMetaspaceSize&#x3D;256m</p>
<h3 id="å­—èŠ‚ç é—®é¢˜"><a href="#å­—èŠ‚ç é—®é¢˜" class="headerlink" title="å­—èŠ‚ç é—®é¢˜"></a>å­—èŠ‚ç é—®é¢˜</h3><p>ASM 5.0 beta å¼€å§‹æ”¯æŒ JDK8</p>
<p><strong>å­—èŠ‚ç é”™è¯¯</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Caused by: java<span class="selector-class">.io</span><span class="selector-class">.IOException</span>: invalid constant type: <span class="number">15</span></span><br><span class="line">	at javassist<span class="selector-class">.bytecode</span><span class="selector-class">.ConstPool</span><span class="selector-class">.readOne</span>(ConstPool<span class="selector-class">.java</span>:<span class="number">1113</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li>æŸ¥æ‰¾ç»„ä»¶ç”¨åˆ°äº† mvelï¼Œmvel ä¸ºäº†æé«˜æ•ˆç‡è¿›è¡Œäº†å­—èŠ‚ç ä¼˜åŒ–ï¼Œæ­£å¥½ç¢°ä¸Š JDK8 æ­»ç©´ï¼Œæ‰€ä»¥éœ€è¦å‡çº§ã€‚</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mvel<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mvel2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.7.Final<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>javassist</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.javassist<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javassist<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.18.1-GA<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>æ³¨æ„</strong></p>
<p>æœ‰äº›éƒ¨ç½²å·¥å…·ä¸ä¼šåˆ é™¤æ—§ç‰ˆæœ¬ jar åŒ…ï¼Œæ‰€ä»¥å¯ä»¥å°è¯•æ‰‹åŠ¨åˆ é™¤è€ç‰ˆæœ¬ jar åŒ…ã€‚</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="http://asm.ow2.org/history.html">http://asm.ow2.org/history.html</a></p>
<h3 id="Java-è¿æ¥-redis-å¯åŠ¨æŠ¥é”™-Error-redis-clients-jedis-HostAndPort-cant-resolve-localhost-address"><a href="#Java-è¿æ¥-redis-å¯åŠ¨æŠ¥é”™-Error-redis-clients-jedis-HostAndPort-cant-resolve-localhost-address" class="headerlink" title="Java è¿æ¥ redis å¯åŠ¨æŠ¥é”™ Error redis clients jedis HostAndPort cant resolve localhost address"></a>Java è¿æ¥ redis å¯åŠ¨æŠ¥é”™ Error redis clients jedis HostAndPort cant resolve localhost address</h3><p>é”™è¯¯ç¯å¢ƒ:<br>æœ¬åœ° window å¼€å‘ç¯å¢ƒæ²¡æœ‰é—®é¢˜ã€‚ä¸Šåˆ° Linux ç¯å¢ƒ,å¯åŠ¨å‡ºç°é—®é¢˜ã€‚<br>é”™è¯¯ä¿¡æ¯:<br>Error redis clients jedis HostAndPort cant resolve localhost address</p>
<p>è§£å†³åŠæ³•:</p>
<p>ï¼ˆ1ï¼‰æŸ¥çœ‹ Linux ç³»ç»Ÿçš„ä¸»æœºå</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># hostname</span></span><br><span class="line"><span class="keyword">template</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰æŸ¥çœ‹&#x2F;etc&#x2F;hosts æ–‡ä»¶ä¸­æ˜¯å¦æœ‰ 127.0.0.1 å¯¹åº”ä¸»æœºåï¼Œå¦‚æœæ²¡æœ‰åˆ™æ·»åŠ </p>
<h3 id="Resin-å®¹å™¨æŒ‡å®š-JDK-1-8"><a href="#Resin-å®¹å™¨æŒ‡å®š-JDK-1-8" class="headerlink" title="Resin å®¹å™¨æŒ‡å®š JDK 1.8"></a>Resin å®¹å™¨æŒ‡å®š JDK 1.8</h3><p>å¦‚æœ resin å®¹å™¨åŸæ¥ç‰ˆæœ¬ä½äº JDK1.8ï¼Œè¿è¡Œ JDK 1.8 ç¼–è¯‘çš„ web app æ—¶ï¼Œå¯èƒ½ä¼šæç¤ºé”™è¯¯ï¼š</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java.lang.UnsupportedClassVersionError: <span class="keyword">PR</span>/<span class="keyword">Sort</span> : Unsupported major.minor <span class="keyword">version</span> 52.0</span><br></pre></td></tr></table></figure>

<p>è§£å†³æ–¹æ³•å°±æ˜¯ï¼Œä½¿ç”¨ JDK 1.8 è¦é‡æ–°ç¼–è¯‘ä¸€ä¸‹ã€‚ç„¶åï¼Œæˆ‘åœ¨éƒ¨ç½²æ—¶å‡ºç°è¿‡ç¼–è¯‘åä»æŠ¥é”™çš„æƒ…å†µï¼Œé‡å¯ä¸€ä¸‹æœåŠ¡å™¨åï¼Œé—®é¢˜è§£å†³ï¼Œä¸çŸ¥æ˜¯ä»€ä¹ˆåŸå› ã€‚</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.<span class="regexp">/configure --prefix=/u</span>sr<span class="regexp">/local/</span>resin  --with-java=<span class="regexp">/usr/</span>local/jdk1.<span class="number">8.0</span>_121</span><br><span class="line">make &amp; make install</span><br></pre></td></tr></table></figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://github.com/winterbe/java8-tutorial">java8-tutorial</a></li>
<li><a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/java/javase/8-compatibility-guide-2156366.html">Compatibility Guide for JDK 8</a></li>
<li><a target="_blank" rel="noopener" href="https://yq.aliyun.com/articles/236">Compatibility Guide for JDK 8 ä¸­æ–‡ç¿»è¯‘</a></li>
<li><a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/java/faq-sun-packages-142232.html">Why Developers Should Not Write Programs That Call â€˜sunâ€™ Packages</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/d71f2c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/d71f2c/" class="post-title-link" itemprop="url">Java ç¼–ç¨‹è§„èŒƒ</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-05-06 15:02:02" itemprop="dateCreated datePublished" datetime="2019-05-06T15:02:02+08:00">2019-05-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/JavaSE/" itemprop="url" rel="index"><span itemprop="name">JavaSE</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/JavaSE/%E9%AB%98%E7%BA%A7%E7%89%B9%E6%80%A7/" itemprop="url" rel="index"><span itemprop="name">é«˜çº§ç‰¹æ€§</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>1.5k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>1 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Java-ç¼–ç¨‹è§„èŒƒ"><a href="#Java-ç¼–ç¨‹è§„èŒƒ" class="headerlink" title="Java ç¼–ç¨‹è§„èŒƒ"></a>Java ç¼–ç¨‹è§„èŒƒ</h1><blockquote>
<p>ç¼–ç¨‹è§„èŒƒå°±æ˜¯ Java å¼€å‘çš„æœ€ä½³å®è·µã€‚å¸®åŠ©å¼€å‘äººå‘˜å°‘èµ°å¼¯è·¯ã€‚</p>
</blockquote>
<h2 id="Effective-Java"><a href="#Effective-Java" class="headerlink" title="Effective Java"></a>Effective Java</h2><ul>
<li>ç¬¬ 2 ç«  åˆ›å»ºã€é”€æ¯å¯¹è±¡<ul>
<li>ç¬¬ 1 æ¡ï¼šè€ƒè™‘ç”¨é™æ€å·¥å‚æ–¹æ³•ä»£æ›¿æ„é€ å™¨</li>
<li>ç¬¬ 2 æ¡ï¼šé‡åˆ°å¤šä¸ªæ„é€ å™¨å‚æ•°æ—¶è¦è€ƒè™‘ç”¨æ„å»ºå™¨</li>
<li>ç¬¬ 3 æ¡ï¼šç”¨ç§æœ‰æ„é€ å™¨æˆ–è€…æšä¸¾ç±»å‹å¼ºåŒ– Singleton å±æ€§</li>
<li>ç¬¬ 4 æ¡ï¼šé€šè¿‡ç§æœ‰æ„é€ å™¨å¼ºåŒ–ä¸å¯å®ä¾‹åŒ–çš„èƒ½åŠ›</li>
<li>ç¬¬ 5 æ¡ï¼šé¿å…åˆ›å»ºä¸å¿…è¦çš„å¯¹è±¡</li>
<li>ç¬¬ 6 æ¡ï¼šæ¶ˆé™¤è¿‡æœŸçš„å¯¹è±¡å¼•ç”¨</li>
<li>ç¬¬ 7 æ¡ï¼šé¿å…ä½¿ç”¨ç»ˆç»“æ–¹æ³•</li>
</ul>
</li>
<li>ç¬¬ 3 ç«  å¯¹äºæ‰€æœ‰å¯¹è±¡éƒ½é€šç”¨çš„æ–¹æ³•<ul>
<li>ç¬¬ 8 æ¡ï¼šè¦†ç›– equals æ—¶è¯·éµå®ˆé€šç”¨çº¦å®š</li>
<li>ç¬¬ 9 æ¡ï¼šè¦†ç›– equals æ—¶æ€»è¦è¦†ç›– hashCode</li>
<li>ç¬¬ 10 æ¡ï¼šå§‹ç»ˆè¦è¦†ç›– toString</li>
<li>ç¬¬ 11 æ¡ï¼šè°¨æ…åœ°è¦†ç›– clone</li>
<li>ç¬¬ 12 æ¡ï¼šè€ƒè™‘å®ç° Comparable æ¥å£</li>
</ul>
</li>
<li>ç¬¬ 4 ç«  ç±»å’Œæ¥å£<ul>
<li>ç¬¬ 13 æ¡ï¼šä½¿ç±»å’Œæˆå‘˜çš„å¯è®¿é—®æ€§æœ€å°åŒ–</li>
<li>ç¬¬ 14 æ¡ï¼šåœ¨å…¬æœ‰ç±»ä¸­ä½¿ç”¨è®¿é—®æ–¹æ³•è€Œéå…¬æœ‰åŸŸ</li>
<li>ç¬¬ 15 æ¡ï¼šä½¿å¯å˜æ€§æœ€å°åŒ–</li>
<li>ç¬¬ 16 æ¡ï¼šå¤åˆä¼˜å…ˆäºç»§æ‰¿</li>
<li>ç¬¬ 17 æ¡ï¼šè¦ä¹ˆä¸ºç»§æ‰¿è€Œè®¾è®¡ï¼Œå¹¶æä¾›æ–‡æ¡£è¯´æ˜ï¼Œè¦ä¹ˆå°±ç¦æ­¢ç»§æ‰¿</li>
<li>ç¬¬ 18 æ¡ï¼šæ¥å£ä¼˜äºæŠ½è±¡ç±»</li>
<li>ç¬¬ 19 æ¡ï¼šæ¥å£åªç”¨äºå®šä¹‰ç±»å‹</li>
<li>ç¬¬ 20 æ¡ï¼šç±»å±‚æ¬¡ä¼˜äºæ ‡ç­¾ç±»</li>
<li>ç¬¬ 21 æ¡ï¼šç”¨å‡½æ•°å¯¹è±¡è¡¨ç¤ºç­–ç•¥</li>
<li>ç¬¬ 22 æ¡ï¼šä¼˜å…ˆè€ƒè™‘é™æ€æˆå‘˜ç±»</li>
</ul>
</li>
<li>ç¬¬ 5 ç«  æ³›å‹<ul>
<li>ç¬¬ 23 æ¡ï¼šè¯·ä¸è¦åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨åŸç”Ÿæ€ç±»å‹</li>
<li>ç¬¬ 24 æ¡ï¼šæ¶ˆé™¤éå—æ£€è­¦å‘Š</li>
<li>ç¬¬ 25 æ¡ï¼šåˆ—è¡¨ä¼˜å…ˆäºæ•°ç»„</li>
<li>ç¬¬ 26 æ¡ï¼šä¼˜å…ˆè€ƒè™‘æ³›å‹</li>
<li>ç¬¬ 27 æ¡ï¼šä¼˜å…ˆè€ƒè™‘æ³›å‹æ–¹æ³•</li>
<li>ç¬¬ 28 æ¡ï¼šåˆ©ç”¨æœ‰é™åˆ¶é€šé…ç¬¦æ¥æå‡ API çš„çµæ´»æ€§</li>
<li>ç¬¬ 29 æ¡ï¼šä¼˜å…ˆè€ƒè™‘ç±»å‹å®‰å…¨çš„å¼‚æ„å®¹å™¨</li>
</ul>
</li>
<li>ç¬¬ 6 ç«  æšä¸¾å’Œæ³¨è§£<ul>
<li>ç¬¬ 30 æ¡ï¼šç”¨ enum ä»£æ›¿ int å¸¸é‡</li>
<li>ç¬¬ 31 æ¡ï¼šç”¨å®ä¾‹åŸŸä»£æ›¿åºæ•°</li>
<li>ç¬¬ 32 æ¡ï¼šç”¨ EnumSet ä»£æ›¿ä½åŸŸ</li>
<li>ç¬¬ 33 æ¡ï¼šç”¨ EnumMap ä»£æ›¿åºæ•°ç´¢å¼•</li>
<li>ç¬¬ 34 æ¡ï¼šç”¨æ¥å£æ¨¡æ‹Ÿå¯ä¼¸ç¼©çš„æšä¸¾</li>
<li>ç¬¬ 35 æ¡ï¼šæ³¨è§£ä¼˜å…ˆäºå‘½åæ¨¡å¼</li>
<li>ç¬¬ 36 æ¡ï¼šåšæŒä½¿ç”¨ Override æ³¨è§£</li>
<li>ç¬¬ 37 æ¡ï¼šç”¨æ ‡è®°æ¥å£å®šä¹‰ç±»å‹</li>
</ul>
</li>
<li>ç¬¬ 7 ç«  æ–¹æ³•<ul>
<li>ç¬¬ 38 æ¡ï¼šæ£€æŸ¥å‚æ•°çš„æœ‰æ•ˆæ€§</li>
<li>ç¬¬ 39 æ¡ï¼šå¿…è¦æ—¶è¿›è¡Œä¿æŠ¤æ€§æ‹·è´</li>
<li>ç¬¬ 40 æ¡ï¼šè°¨æ…è®¾è®¡æ–¹æ³•ç­¾å</li>
<li>ç¬¬ 41 æ¡ï¼šæ…ç”¨é‡è½½</li>
<li>ç¬¬ 42 æ¡ï¼šæ…ç”¨å¯å˜å‚æ•°</li>
<li>ç¬¬ 43 æ¡ï¼šè¿”å›é›¶é•¿åº¦çš„æ•°ç»„æˆ–è€…é›†åˆï¼Œè€Œä¸æ˜¯ï¼šnull</li>
<li>ç¬¬ 44 æ¡ï¼šä¸ºæ‰€æœ‰å¯¼å‡ºçš„ API å…ƒç´ ç¼–å†™æ–‡æ¡£æ³¨é‡Š</li>
</ul>
</li>
<li>ç¬¬ 8 ç«  é€šç”¨ç¨‹åºè®¾è®¡<ul>
<li>ç¬¬ 45 æ¡ï¼šå°†å±€éƒ¨å˜é‡çš„ä½œç”¨åŸŸæœ€å°åŒ–</li>
<li>ç¬¬ 46 æ¡ï¼šfor-each å¾ªç¯ä¼˜å…ˆäºä¼ ç»Ÿçš„ for å¾ªç¯</li>
<li>ç¬¬ 47 æ¡ï¼šäº†è§£å’Œä½¿ç”¨ç±»åº“</li>
<li>ç¬¬ 48 æ¡ï¼šå¦‚æœéœ€è¦ç²¾ç¡®çš„ç­”æ¡ˆï¼Œè¯·é¿å…ä½¿ç”¨ float å’Œ double</li>
<li>ç¬¬ 49 æ¡ï¼šåŸºæœ¬ç±»å‹ä¼˜å…ˆäºè£…ç®±åŸºæœ¬ç±»å‹</li>
<li>ç¬¬ 50 æ¡ï¼šå¦‚æœå…¶ä»–ç±»å‹æ›´é€‚åˆï¼Œåˆ™å°½é‡é¿å…ä½¿ç”¨å­—ç¬¦ä¸²</li>
<li>ç¬¬ 51 æ¡ï¼šå½“å¿ƒå­—ç¬¦ä¸²è¿æ¥çš„æ€§èƒ½</li>
<li>ç¬¬ 52 æ¡ï¼šé€šè¿‡æ¥å£å¼•ç”¨å¯¹è±¡</li>
<li>ç¬¬ 53 æ¡ï¼šæ¥å£ä¼˜å…ˆäºåå°„æœºåˆ¶</li>
<li>ç¬¬ 54 æ¡ï¼šè°¨æ…åœ°ä½¿ç”¨æœ¬åœ°æ–¹æ³•</li>
<li>ç¬¬ 55 æ¡ï¼šè°¨æ…åœ°è¿›è¡Œä¼˜åŒ–</li>
<li>ç¬¬ 56 æ¡ï¼šéµå®ˆæ™®éæ¥å—çš„å‘½åæƒ¯ä¾‹</li>
</ul>
</li>
<li>ç¬¬ 9 ç«  å¼‚å¸¸<ul>
<li>ç¬¬ 57 æ¡ï¼šåªé’ˆå¯¹å¼‚å¸¸çš„æƒ…å†µæ‰ä½¿ç”¨å¼‚å¸¸</li>
<li>ç¬¬ 58 æ¡ï¼šå¯¹å¯æ¢å¤çš„æƒ…å†µä½¿ç”¨å—æ£€å¼‚å¸¸ï¼Œå¯¹ç¼–ç¨‹é”™è¯¯ä½¿ç”¨è¿è¡Œæ—¶å¼‚å¸¸</li>
<li>ç¬¬ 59 æ¡ï¼šé¿å…ä¸å¿…è¦åœ°ä½¿ç”¨å—æ£€çš„å¼‚å¸¸</li>
<li>ç¬¬ 60 æ¡ï¼šä¼˜å…ˆä½¿ç”¨æ ‡å‡†çš„å¼‚å¸¸</li>
<li>ç¬¬ 61 æ¡ï¼šæŠ›å‡ºä¸æŠ½è±¡ç›¸å¯¹åº”çš„å¼‚å¸¸</li>
<li>ç¬¬ 62 æ¡ï¼šæ¯ä¸ªæ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸éƒ½è¦æœ‰æ–‡æ¡£</li>
<li>ç¬¬ 63 æ¡ï¼šåœ¨ç»†èŠ‚æ¶ˆæ¯ä¸­åŒ…å«èƒ½æ•è·å¤±è´¥çš„ä¿¡æ¯</li>
<li>ç¬¬ 64 æ¡ï¼šåŠªåŠ›ä½¿å¤±è´¥ä¿æŒåŸå­æ€§</li>
<li>ç¬¬ 65 æ¡ï¼šä¸è¦å¿½ç•¥å¼‚å¸¸</li>
</ul>
</li>
<li>ç¬¬ 10 ç«  å¹¶å‘<ul>
<li>ç¬¬ 66 æ¡ï¼šåŒæ­¥è®¿é—®å…±äº«çš„å¯å˜æ•°æ®</li>
<li>ç¬¬ 67 æ¡ï¼šé¿å…è¿‡åº¦åŒæ­¥</li>
<li>ç¬¬ 68 æ¡ï¼šexecutor å’Œ task ä¼˜å…ˆå¹²çº¿ç¨‹</li>
<li>ç¬¬ 69 æ¡ï¼šå¹¶å‘å·¥å…·ä¼˜å…ˆäº wait å’Œ notify</li>
<li>ç¬¬ 70 æ¡ï¼šçº¿ç¨‹å®‰å…¨æ€§çš„æ–‡æ¡£åŒ–</li>
<li>ç¬¬ 71 æ¡ï¼šæ…ç”¨å»¶è¿Ÿåˆå§‹åŒ–</li>
<li>ç¬¬ 72 æ¡ï¼šä¸è¦ä¾èµ–äºçº¿ç¨‹è°ƒåº¦å™¨</li>
<li>ç¬¬ 73 æ¡ï¼šé¿å…ä½¿ç”¨çº¿ç¨‹ç»„</li>
</ul>
</li>
<li>ç¬¬ 11 ç«  åºåˆ—åŒ–<ul>
<li>ç¬¬ 74 æ¡ï¼šè°¨æ…åœ°å®ç° Serializable æ¥å£</li>
<li>ç¬¬ 75 æ¡ï¼šè€ƒè™‘ä½¿ç”¨è‡ªå®šä¹‰çš„åºåˆ—åŒ–å½¢å¼</li>
<li>ç¬¬ 76 æ¡ï¼šä¿æŠ¤æ€§åœ°ç¼–å†™ readObject æ–¹æ³•</li>
<li>ç¬¬ 77 æ¡ï¼šå¯¹äºå®ä¾‹æ§åˆ¶ï¼Œæšä¸¾ç±»å‹ä¼˜å…ˆäº readResolve</li>
<li>ç¬¬ 78 æ¡ï¼šè€ƒè™‘ç”¨åºåˆ—åŒ–ä»£ç†ä»£æ›¿åºåˆ—åŒ–å®ä¾‹</li>
</ul>
</li>
</ul>
<h2 id="èµ„æº"><a href="#èµ„æº" class="headerlink" title="èµ„æº"></a>èµ„æº</h2><ul>
<li><a target="_blank" rel="noopener" href="https://book.douban.com/subject/3360807/">Effective Java</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/alibaba/p3c/blob/master/%E9%98%BF%E9%87%8C%E5%B7%B4%E5%B7%B4Java%E5%BC%80%E5%8F%91%E6%89%8B%E5%86%8C%EF%BC%88%E8%AF%A6%E5%B0%BD%E7%89%88%EF%BC%89.pdf">é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œ</a></li>
<li><a target="_blank" rel="noopener" href="https://google.github.io/styleguide/javaguide.html">Google Java ç¼–ç¨‹æŒ‡å—</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/a8c9c0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/a8c9c0/" class="post-title-link" itemprop="url">Springäº‹åŠ¡ç®¡ç†</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-04-22 17:36:37" itemprop="dateCreated datePublished" datetime="2019-04-22T17:36:37+08:00">2019-04-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/Spring%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">Springæ•°æ®</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>33k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>30 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="äº‹åŠ¡ç®¡ç†"><a href="#äº‹åŠ¡ç®¡ç†" class="headerlink" title="äº‹åŠ¡ç®¡ç†"></a>äº‹åŠ¡ç®¡ç†</h1><h2 id="ç†è§£äº‹åŠ¡"><a href="#ç†è§£äº‹åŠ¡" class="headerlink" title="ç†è§£äº‹åŠ¡"></a>ç†è§£äº‹åŠ¡</h2><p>åœ¨è½¯ä»¶å¼€å‘é¢†åŸŸï¼Œå…¨æœ‰æˆ–å…¨æ— çš„æ“ä½œè¢«ç§°ä¸º<strong>äº‹åŠ¡ï¼ˆtransactionï¼‰</strong>ã€‚äº‹åŠ¡å…è®¸ä½ å°†å‡ ä¸ªæ“ä½œç»„åˆæˆä¸€ä¸ªè¦ä¹ˆå…¨éƒ¨å‘ç”Ÿè¦ä¹ˆå…¨éƒ¨ä¸å‘ç”Ÿçš„å·¥ä½œå•å…ƒã€‚</p>
<h3 id="äº‹åŠ¡çš„ç‰¹æ€§"><a href="#äº‹åŠ¡çš„ç‰¹æ€§" class="headerlink" title="äº‹åŠ¡çš„ç‰¹æ€§"></a>äº‹åŠ¡çš„ç‰¹æ€§</h3><p>äº‹åŠ¡åº”è¯¥å…·æœ‰ 4 ä¸ªå±æ€§ï¼šåŸå­æ€§ã€ä¸€è‡´æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ã€‚è¿™å››ä¸ªå±æ€§é€šå¸¸ç§°ä¸º <strong>ACID</strong>ã€‚</p>
<ul>
<li><strong>åŸå­æ€§ï¼ˆAtomicï¼‰</strong>ï¼šä¸€ä¸ªäº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­åŒ…æ‹¬çš„è¯¸æ“ä½œè¦ä¹ˆéƒ½åšï¼Œè¦ä¹ˆéƒ½ä¸åšã€‚</li>
<li><strong>ä¸€è‡´æ€§ï¼ˆConsistentï¼‰</strong>ï¼šäº‹åŠ¡å¿…é¡»æ˜¯ä½¿æ•°æ®åº“ä»ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€å˜åˆ°å¦ä¸€ä¸ªä¸€è‡´æ€§çŠ¶æ€ã€‚ä¸€è‡´æ€§ä¸åŸå­æ€§æ˜¯å¯†åˆ‡ç›¸å…³çš„ã€‚</li>
<li><strong>éš”ç¦»æ€§ï¼ˆIsolatedï¼‰</strong>ï¼šä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ã€‚å³ä¸€ä¸ªäº‹åŠ¡å†…éƒ¨çš„æ“ä½œåŠä½¿ç”¨çš„æ•°æ®å¯¹å¹¶å‘çš„å…¶ä»–äº‹åŠ¡æ˜¯éš”ç¦»çš„ï¼Œå¹¶å‘æ‰§è¡Œçš„å„ä¸ªäº‹åŠ¡ä¹‹é—´ä¸èƒ½äº’ç›¸å¹²æ‰°ã€‚</li>
<li><strong>æŒä¹…æ€§ï¼ˆDurableï¼‰</strong>ï¼šæŒä¹…æ€§ä¹Ÿç§°æ°¸ä¹…æ€§ï¼ˆpermanenceï¼‰ï¼ŒæŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±åº”è¯¥æ˜¯æ°¸ä¹…æ€§çš„ã€‚æ¥ä¸‹æ¥çš„å…¶ä»–æ“ä½œæˆ–æ•…éšœä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“ã€‚</li>
</ul>
<h3 id="Spring-å¯¹äº‹åŠ¡çš„æ”¯æŒ"><a href="#Spring-å¯¹äº‹åŠ¡çš„æ”¯æŒ" class="headerlink" title="Spring å¯¹äº‹åŠ¡çš„æ”¯æŒ"></a>Spring å¯¹äº‹åŠ¡çš„æ”¯æŒ</h3><p>Spring é€šè¿‡å›è°ƒæœºåˆ¶å°†å®é™…çš„äº‹åŠ¡å®ç°ä»äº‹åŠ¡æ€§çš„ä»£ç ä¸­æŠ½è±¡å‡ºæ¥ã€‚</p>
<p>Spring æä¾›äº†å¯¹ç¼–ç å¼å’Œå£°æ˜å¼äº‹åŠ¡ç®¡ç†çš„æ”¯æŒã€‚</p>
<ul>
<li>ç¼–ç å¼äº‹åŠ¡å…è®¸ç”¨æˆ·åœ¨ä»£ç ä¸­ç²¾ç¡®å®šä¹‰äº‹åŠ¡çš„è¾¹ç•Œ</li>
<li>å£°æ˜å¼äº‹åŠ¡ï¼ˆåŸºäº AOPï¼‰æœ‰åŠ©äºç”¨æˆ·å°†æ“ä½œä¸äº‹åŠ¡è§„åˆ™è¿›è¡Œè§£è€¦</li>
</ul>
<h2 id="æ ¸å¿ƒ-API"><a href="#æ ¸å¿ƒ-API" class="headerlink" title="æ ¸å¿ƒ API"></a>æ ¸å¿ƒ API</h2><h3 id="PlatformTransactionManager"><a href="#PlatformTransactionManager" class="headerlink" title="PlatformTransactionManager"></a>PlatformTransactionManager</h3><p>Spring å¹¶ä¸ç›´æ¥ç®¡ç†äº‹åŠ¡ï¼Œè€Œæ˜¯æä¾›äº†å¤šç§äº‹åŠ¡ç®¡ç†å™¨ï¼Œå®ƒä»¬å°†äº‹åŠ¡ç®¡ç†çš„èŒè´£å§”æ‰˜ç»™ JTA æˆ–å…¶ä»–æŒä¹…åŒ–æœºåˆ¶æ‰€æä¾›çš„å¹³å°ç›¸å…³çš„äº‹åŠ¡å®ç°ã€‚</p>
<p>Spring äº‹åŠ¡ç®¡ç†å™¨çš„æ¥å£æ˜¯ <code>org.springframework.transaction.PlatformTransactionManager</code>ï¼Œé€šè¿‡è¿™ä¸ªæ¥å£ï¼ŒSpring ä¸ºå„ä¸ªå¹³å°å¦‚ JDBCã€Hibernate ç­‰éƒ½æä¾›äº†å¯¹åº”çš„äº‹åŠ¡ç®¡ç†å™¨ï¼Œä½†æ˜¯å…·ä½“çš„å®ç°å°±æ˜¯å„ä¸ªå¹³å°è‡ªå·±çš„äº‹æƒ…äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">PlatformTransactionManager</span> &#123;</span><br><span class="line"></span><br><span class="line">    TransactionStatus <span class="title function_">getTransaction</span><span class="params">(</span></span><br><span class="line"><span class="params">            TransactionDefinition definition)</span> <span class="keyword">throws</span> TransactionException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">commit</span><span class="params">(TransactionStatus status)</span> <span class="keyword">throws</span> TransactionException;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">rollback</span><span class="params">(TransactionStatus status)</span> <span class="keyword">throws</span> TransactionException;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä»è¿™é‡Œå¯çŸ¥å…·ä½“çš„å…·ä½“çš„äº‹åŠ¡ç®¡ç†æœºåˆ¶å¯¹ Spring æ¥è¯´æ˜¯é€æ˜çš„ï¼Œå®ƒå¹¶ä¸å…³å¿ƒé‚£äº›ï¼Œé‚£äº›æ˜¯å¯¹åº”å„ä¸ªå¹³å°éœ€è¦å…³å¿ƒçš„ï¼Œæ‰€ä»¥ Spring äº‹åŠ¡ç®¡ç†çš„ä¸€ä¸ªä¼˜ç‚¹å°±æ˜¯ä¸ºä¸åŒçš„äº‹åŠ¡ API æä¾›ä¸€è‡´çš„ç¼–ç¨‹æ¨¡å‹ï¼Œå¦‚ JTAã€JDBCã€Hibernateã€JPAã€‚ä¸‹é¢åˆ†åˆ«ä»‹ç»å„ä¸ªå¹³å°æ¡†æ¶å®ç°äº‹åŠ¡ç®¡ç†çš„æœºåˆ¶ã€‚</p>
<p><img src="/blog/assets/images/spring-tx-manager.png" alt="img"></p>
<h4 id="JDBC-äº‹åŠ¡"><a href="#JDBC-äº‹åŠ¡" class="headerlink" title="JDBC äº‹åŠ¡"></a>JDBC äº‹åŠ¡</h4><p>å¦‚æœåº”ç”¨ç¨‹åºä¸­ç›´æ¥ä½¿ç”¨ JDBC æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œ<code>DataSourceTransactionManager</code> ä¼šä¸ºä½ å¤„ç†äº‹åŠ¡è¾¹ç•Œã€‚ä¸ºäº†ä½¿ç”¨ <code>DataSourceTransactionManager</code>ï¼Œä½ éœ€è¦ä½¿ç”¨å¦‚ä¸‹çš„ XML å°†å…¶è£…é…åˆ°åº”ç”¨ç¨‹åºçš„ä¸Šä¸‹æ–‡å®šä¹‰ä¸­ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å®é™…ä¸Šï¼Œ<code>DataSourceTransactionManager</code> æ˜¯é€šè¿‡è°ƒç”¨ <code>java.sql.Connection</code> æ¥ç®¡ç†äº‹åŠ¡ï¼Œè€Œåè€…æ˜¯é€šè¿‡ <code>DataSource</code> è·å–åˆ°çš„ã€‚é€šè¿‡è°ƒç”¨è¿æ¥çš„ <code>commit()</code> æ–¹æ³•æ¥æäº¤äº‹åŠ¡ï¼ŒåŒæ ·ï¼Œäº‹åŠ¡å¤±è´¥åˆ™é€šè¿‡è°ƒç”¨ <code>rollback()</code> æ–¹æ³•è¿›è¡Œå›æ»šã€‚</p>
<h4 id="Hibernate-äº‹åŠ¡"><a href="#Hibernate-äº‹åŠ¡" class="headerlink" title="Hibernate äº‹åŠ¡"></a>Hibernate äº‹åŠ¡</h4><p>å¦‚æœåº”ç”¨ç¨‹åºçš„æŒä¹…åŒ–æ˜¯é€šè¿‡ Hibernate å®ç°çš„ï¼Œé‚£ä¹ˆä½ éœ€è¦ä½¿ç”¨ <code>HibernateTransactionManager</code>ã€‚å¯¹äº Hibernate3ï¼Œéœ€è¦åœ¨ Spring ä¸Šä¸‹æ–‡å®šä¹‰ä¸­æ·»åŠ å¦‚ä¸‹çš„ <code>bean</code> å£°æ˜ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.HibernateTransactionManager&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>sessionFactory</code> å±æ€§éœ€è¦è£…é…ä¸€ä¸ª Hibernate çš„ session å·¥å‚ï¼Œ<code>HibernateTransactionManager</code> çš„å®ç°ç»†èŠ‚æ˜¯å®ƒå°†äº‹åŠ¡ç®¡ç†çš„èŒè´£å§”æ‰˜ç»™ <code>org.hibernate.Transaction</code> å¯¹è±¡ï¼Œè€Œåè€…æ˜¯ä» Hibernate Session ä¸­è·å–åˆ°çš„ã€‚å½“äº‹åŠ¡æˆåŠŸå®Œæˆæ—¶ï¼Œ<code>HibernateTransactionManager</code> å°†ä¼šè°ƒç”¨ <code>Transaction</code> å¯¹è±¡çš„ <code>commit()</code> æ–¹æ³•ï¼Œåä¹‹ï¼Œå°†ä¼šè°ƒç”¨ <code>rollback()</code> æ–¹æ³•ã€‚</p>
<h4 id="Java-æŒä¹…åŒ–-API-äº‹åŠ¡ï¼ˆJPAï¼‰"><a href="#Java-æŒä¹…åŒ–-API-äº‹åŠ¡ï¼ˆJPAï¼‰" class="headerlink" title="Java æŒä¹…åŒ– API äº‹åŠ¡ï¼ˆJPAï¼‰"></a>Java æŒä¹…åŒ– API äº‹åŠ¡ï¼ˆJPAï¼‰</h4><p>Hibernate å¤šå¹´æ¥ä¸€ç›´æ˜¯äº‹å®ä¸Šçš„ Java æŒä¹…åŒ–æ ‡å‡†ï¼Œä½†æ˜¯ç°åœ¨ Java æŒä¹…åŒ– API ä½œä¸ºçœŸæ­£çš„ Java æŒä¹…åŒ–æ ‡å‡†è¿›å…¥å¤§å®¶çš„è§†é‡ã€‚å¦‚æœä½ è®¡åˆ’ä½¿ç”¨ JPA çš„è¯ï¼Œé‚£ä½ éœ€è¦ä½¿ç”¨ Spring çš„ <code>JpaTransactionManager</code> æ¥å¤„ç†äº‹åŠ¡ã€‚ä½ éœ€è¦åœ¨ Spring ä¸­è¿™æ ·é…ç½® <code>JpaTransactionManager</code>ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.jpa.JpaTransactionManager&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>JpaTransactionManager</code> åªéœ€è¦è£…é…ä¸€ä¸ª JPA å®ä½“ç®¡ç†å·¥å‚ï¼ˆ<code>javax.persistence.EntityManagerFactory</code> æ¥å£çš„ä»»æ„å®ç°ï¼‰ã€‚<code>JpaTransactionManager</code> å°†ä¸ç”±å·¥å‚æ‰€äº§ç”Ÿçš„ JPA EntityManager åˆä½œæ¥æ„å»ºäº‹åŠ¡ã€‚</p>
<h4 id="Java-åŸç”Ÿ-API-äº‹åŠ¡ï¼ˆJTAï¼‰"><a href="#Java-åŸç”Ÿ-API-äº‹åŠ¡ï¼ˆJTAï¼‰" class="headerlink" title="Java åŸç”Ÿ API äº‹åŠ¡ï¼ˆJTAï¼‰"></a>Java åŸç”Ÿ API äº‹åŠ¡ï¼ˆJTAï¼‰</h4><p>å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨ä»¥ä¸Šæ‰€è¿°çš„äº‹åŠ¡ç®¡ç†ï¼Œæˆ–è€…æ˜¯è·¨è¶Šäº†å¤šä¸ªäº‹åŠ¡ç®¡ç†æºï¼ˆæ¯”å¦‚ä¸¤ä¸ªæˆ–è€…æ˜¯å¤šä¸ªä¸åŒçš„æ•°æ®æºï¼‰ï¼Œä½ å°±éœ€è¦ä½¿ç”¨<code>JtaTransactionManager</code>ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.transaction.jta.JtaTransactionManager&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionManagerName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;java:/TransactionManager&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>JtaTransactionManager</code> å°†äº‹åŠ¡ç®¡ç†çš„è´£ä»»å§”æ‰˜ç»™ <code>javax.transaction.UserTransaction</code> å’Œ <code>javax.transaction.TransactionManager</code> å¯¹è±¡ï¼Œå…¶ä¸­äº‹åŠ¡æˆåŠŸå®Œæˆé€šè¿‡ <code>UserTransaction.commit()</code> æ–¹æ³•æäº¤ï¼Œäº‹åŠ¡å¤±è´¥é€šè¿‡ <code>UserTransaction.rollback()</code> æ–¹æ³•å›æ»šã€‚</p>
<h3 id="TransactionDefinition"><a href="#TransactionDefinition" class="headerlink" title="TransactionDefinition"></a>TransactionDefinition</h3><p>ä¸Šé¢è®²åˆ°çš„äº‹åŠ¡ç®¡ç†å™¨æ¥å£ <code>PlatformTransactionManager</code> é€šè¿‡ <code>getTransaction(TransactionDefinition definition)</code> æ–¹æ³•æ¥å¾—åˆ°äº‹åŠ¡ï¼Œè¿™ä¸ªæ–¹æ³•é‡Œé¢çš„å‚æ•°æ˜¯ <code>TransactionDefinition</code> ç±»ï¼Œè¿™ä¸ªç±»å°±å®šä¹‰äº†ä¸€äº›åŸºæœ¬çš„äº‹åŠ¡å±æ€§ã€‚<br>é‚£ä¹ˆä»€ä¹ˆæ˜¯äº‹åŠ¡å±æ€§å‘¢ï¼Ÿäº‹åŠ¡å±æ€§å¯ä»¥ç†è§£æˆäº‹åŠ¡çš„ä¸€äº›åŸºæœ¬é…ç½®ï¼Œæè¿°äº†äº‹åŠ¡ç­–ç•¥å¦‚ä½•åº”ç”¨åˆ°æ–¹æ³•ä¸Šã€‚äº‹åŠ¡å±æ€§åŒ…å«äº† 5 ä¸ªæ–¹é¢ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š</p>
<p><img src="http://img.blog.csdn.net/20160325003448793" alt="img"></p>
<p>è€Œ <code>TransactionDefinition</code> æ¥å£å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TransactionDefinition</span> &#123;</span><br><span class="line">    <span class="type">int</span> <span class="title function_">getPropagationBehavior</span><span class="params">()</span>; <span class="comment">// è¿”å›äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">getIsolationLevel</span><span class="params">()</span>; <span class="comment">// è¿”å›äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Œäº‹åŠ¡ç®¡ç†å™¨æ ¹æ®å®ƒæ¥æ§åˆ¶å¦å¤–ä¸€ä¸ªäº‹åŠ¡å¯ä»¥çœ‹åˆ°æœ¬äº‹åŠ¡å†…çš„å“ªäº›æ•°æ®</span></span><br><span class="line">    <span class="type">int</span> <span class="title function_">getTimeout</span><span class="params">()</span>;  <span class="comment">// è¿”å›äº‹åŠ¡å¿…é¡»åœ¨å¤šå°‘ç§’å†…å®Œæˆ</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isReadOnly</span><span class="params">()</span>; <span class="comment">// äº‹åŠ¡æ˜¯å¦åªè¯»ï¼Œäº‹åŠ¡ç®¡ç†å™¨èƒ½å¤Ÿæ ¹æ®è¿™ä¸ªè¿”å›å€¼è¿›è¡Œä¼˜åŒ–ï¼Œç¡®ä¿äº‹åŠ¡æ˜¯åªè¯»çš„</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬å¯ä»¥å‘ç° <code>TransactionDefinition</code> æ­£å¥½ç”¨æ¥å®šä¹‰äº‹åŠ¡å±æ€§ï¼Œä¸‹é¢è¯¦ç»†ä»‹ç»ä¸€ä¸‹å„ä¸ªäº‹åŠ¡å±æ€§ã€‚</p>
<h4 id="ä¼ æ’­è¡Œä¸º"><a href="#ä¼ æ’­è¡Œä¸º" class="headerlink" title="ä¼ æ’­è¡Œä¸º"></a>ä¼ æ’­è¡Œä¸º</h4><p>äº‹åŠ¡çš„ç¬¬ä¸€ä¸ªæ–¹é¢æ˜¯ä¼ æ’­è¡Œä¸ºï¼ˆpropagation behaviorï¼‰ã€‚å½“äº‹åŠ¡æ–¹æ³•è¢«å¦ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨æ—¶ï¼Œå¿…é¡»æŒ‡å®šäº‹åŠ¡åº”è¯¥å¦‚ä½•ä¼ æ’­ã€‚ä¾‹å¦‚ï¼šæ–¹æ³•å¯èƒ½ç»§ç»­åœ¨ç°æœ‰äº‹åŠ¡ä¸­è¿è¡Œï¼Œä¹Ÿå¯èƒ½å¼€å¯ä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œå¹¶åœ¨è‡ªå·±çš„äº‹åŠ¡ä¸­è¿è¡Œã€‚Spring å®šä¹‰äº†ä¸ƒç§ä¼ æ’­è¡Œä¸ºï¼š</p>
<table>
<thead>
<tr>
<th>ä¼ æ’­è¡Œä¸º</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>PROPAGATION_REQUIRED</td>
<td>è¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»è¿è¡Œåœ¨äº‹åŠ¡ä¸­ã€‚å¦‚æœå½“å‰äº‹åŠ¡å­˜åœ¨ï¼Œæ–¹æ³•å°†ä¼šåœ¨è¯¥äº‹åŠ¡ä¸­è¿è¡Œã€‚å¦åˆ™ï¼Œä¼šå¯åŠ¨ä¸€ä¸ªæ–°çš„äº‹åŠ¡</td>
</tr>
<tr>
<td>PROPAGATION_SUPPORTS</td>
<td>è¡¨ç¤ºå½“å‰æ–¹æ³•ä¸éœ€è¦äº‹åŠ¡ä¸Šä¸‹æ–‡ï¼Œä½†æ˜¯å¦‚æœå­˜åœ¨å½“å‰äº‹åŠ¡çš„è¯ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•ä¼šåœ¨è¿™ä¸ªäº‹åŠ¡ä¸­è¿è¡Œ</td>
</tr>
<tr>
<td>PROPAGATION_MANDATORY</td>
<td>è¡¨ç¤ºè¯¥æ–¹æ³•å¿…é¡»åœ¨äº‹åŠ¡ä¸­è¿è¡Œï¼Œå¦‚æœå½“å‰äº‹åŠ¡ä¸å­˜åœ¨ï¼Œåˆ™ä¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</td>
</tr>
<tr>
<td>PROPAGATION_REQUIRED_NEW</td>
<td>è¡¨ç¤ºå½“å‰æ–¹æ³•å¿…é¡»è¿è¡Œåœ¨å®ƒè‡ªå·±çš„äº‹åŠ¡ä¸­ã€‚ä¸€ä¸ªæ–°çš„äº‹åŠ¡å°†è¢«å¯åŠ¨ã€‚å¦‚æœå­˜åœ¨å½“å‰äº‹åŠ¡ï¼Œåœ¨è¯¥æ–¹æ³•æ‰§è¡ŒæœŸé—´ï¼Œå½“å‰äº‹åŠ¡ä¼šè¢«æŒ‚èµ·ã€‚å¦‚æœä½¿ç”¨ JTATransactionManager çš„è¯ï¼Œåˆ™éœ€è¦è®¿é—® TransactionManager</td>
</tr>
<tr>
<td>PROPAGATION_NOT_SUPPORTED</td>
<td>è¡¨ç¤ºè¯¥æ–¹æ³•ä¸åº”è¯¥è¿è¡Œåœ¨äº‹åŠ¡ä¸­ã€‚å¦‚æœå­˜åœ¨å½“å‰äº‹åŠ¡ï¼Œåœ¨è¯¥æ–¹æ³•è¿è¡ŒæœŸé—´ï¼Œå½“å‰äº‹åŠ¡å°†è¢«æŒ‚èµ·ã€‚å¦‚æœä½¿ç”¨ JTATransactionManager çš„è¯ï¼Œåˆ™éœ€è¦è®¿é—® TransactionManager</td>
</tr>
<tr>
<td>PROPAGATION_NEVER</td>
<td>è¡¨ç¤ºå½“å‰æ–¹æ³•ä¸åº”è¯¥è¿è¡Œåœ¨äº‹åŠ¡ä¸Šä¸‹æ–‡ä¸­ã€‚å¦‚æœå½“å‰æ­£æœ‰ä¸€ä¸ªäº‹åŠ¡åœ¨è¿è¡Œï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸</td>
</tr>
<tr>
<td>PROPAGATION_NESTED</td>
<td>è¡¨ç¤ºå¦‚æœå½“å‰å·²ç»å­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œé‚£ä¹ˆè¯¥æ–¹æ³•å°†ä¼šåœ¨åµŒå¥—äº‹åŠ¡ä¸­è¿è¡Œã€‚åµŒå¥—çš„äº‹åŠ¡å¯ä»¥ç‹¬ç«‹äºå½“å‰äº‹åŠ¡è¿›è¡Œå•ç‹¬åœ°æäº¤æˆ–å›æ»šã€‚å¦‚æœå½“å‰äº‹åŠ¡ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆå…¶è¡Œä¸ºä¸ PROPAGATION_REQUIRED ä¸€æ ·ã€‚æ³¨æ„å„å‚å•†å¯¹è¿™ç§ä¼ æ’­è¡Œä¸ºçš„æ”¯æŒæ˜¯æœ‰æ‰€å·®å¼‚çš„ã€‚å¯ä»¥å‚è€ƒèµ„æºç®¡ç†å™¨çš„æ–‡æ¡£æ¥ç¡®è®¤å®ƒä»¬æ˜¯å¦æ”¯æŒåµŒå¥—äº‹åŠ¡</td>
</tr>
</tbody></table>
<p><em>æ³¨ï¼šä»¥ä¸‹å…·ä½“è®²è§£ä¼ æ’­è¡Œä¸ºçš„å†…å®¹å‚è€ƒè‡ª Spring äº‹åŠ¡æœºåˆ¶è¯¦è§£</em></p>
<ol>
<li>PROPAGATION_REQUIRED å¦‚æœå­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œåˆ™æ”¯æŒå½“å‰äº‹åŠ¡ã€‚å¦‚æœæ²¡æœ‰äº‹åŠ¡åˆ™å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//äº‹åŠ¡å±æ€§ PROPAGATION_REQUIRED</span></span><br><span class="line">methodA&#123;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">    <span class="keyword">method</span><span class="constructor">B()</span>;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="regexp">//</span>äº‹åŠ¡å±æ€§ PROPAGATION_REQUIRED</span><br><span class="line">methodB&#123;</span><br><span class="line">   â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ spring å£°æ˜å¼äº‹åŠ¡ï¼Œspring ä½¿ç”¨ AOP æ¥æ”¯æŒå£°æ˜å¼äº‹åŠ¡ï¼Œä¼šæ ¹æ®äº‹åŠ¡å±æ€§ï¼Œè‡ªåŠ¨åœ¨æ–¹æ³•è°ƒç”¨ä¹‹å‰å†³å®šæ˜¯å¦å¼€å¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå¹¶åœ¨æ–¹æ³•æ‰§è¡Œä¹‹åå†³å®šäº‹åŠ¡æäº¤æˆ–å›æ»šäº‹åŠ¡ã€‚</p>
<p>å•ç‹¬è°ƒç”¨ methodB æ–¹æ³•ï¼š</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">main</span>&#123;</span><br><span class="line">    <span class="built_in">metodB</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äº</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Main&#123;</span><br><span class="line">    Connection con=null;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        con = get<span class="constructor">Connection()</span>;</span><br><span class="line">        con.set<span class="constructor">AutoCommit(<span class="params">false</span>)</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–¹æ³•è°ƒç”¨</span></span><br><span class="line">        <span class="keyword">method</span><span class="constructor">B()</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æäº¤äº‹åŠ¡</span></span><br><span class="line">        con.commit<span class="literal">()</span>;</span><br><span class="line">    &#125; <span class="constructor">Catch(RuntimeException <span class="params">ex</span>)</span> &#123;</span><br><span class="line">        <span class="comment">//å›æ»šäº‹åŠ¡</span></span><br><span class="line">        con.rollback<span class="literal">()</span>;</span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        <span class="comment">//é‡Šæ”¾èµ„æº</span></span><br><span class="line">        close<span class="constructor">Con()</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Spring ä¿è¯åœ¨ methodB æ–¹æ³•ä¸­æ‰€æœ‰çš„è°ƒç”¨éƒ½è·å¾—åˆ°ä¸€ä¸ªç›¸åŒçš„è¿æ¥ã€‚åœ¨è°ƒç”¨ methodB æ—¶ï¼Œæ²¡æœ‰ä¸€ä¸ªå­˜åœ¨çš„äº‹åŠ¡ï¼Œæ‰€ä»¥è·å¾—ä¸€ä¸ªæ–°çš„è¿æ¥ï¼Œå¼€å¯äº†ä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚<br>å•ç‹¬è°ƒç”¨ MethodA æ—¶ï¼Œåœ¨ MethodA å†…åˆä¼šè°ƒç”¨ MethodB.</p>
<p>æ‰§è¡Œæ•ˆæœç›¸å½“äºï¼š</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">main&#123;</span><br><span class="line">    Connection con <span class="operator">=</span> null<span class="comment">;</span></span><br><span class="line">    try&#123;</span><br><span class="line">        con <span class="operator">=</span> getConnection()<span class="comment">;</span></span><br><span class="line">        methodA()<span class="comment">;</span></span><br><span class="line">        con.commit()<span class="comment">;</span></span><br><span class="line">    &#125; catch(RuntimeException ex) &#123;</span><br><span class="line">        con.rollback()<span class="comment">;</span></span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        closeCon()<span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨ MethodA æ—¶ï¼Œç¯å¢ƒä¸­æ²¡æœ‰äº‹åŠ¡ï¼Œæ‰€ä»¥å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡.å½“åœ¨ MethodA ä¸­è°ƒç”¨ MethodB æ—¶ï¼Œç¯å¢ƒä¸­å·²ç»æœ‰äº†ä¸€ä¸ªäº‹åŠ¡ï¼Œæ‰€ä»¥ methodB å°±åŠ å…¥å½“å‰äº‹åŠ¡ã€‚</p>
<ol start="2">
<li><code>PROPAGATION_SUPPORTS</code> å¦‚æœå­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œæ”¯æŒå½“å‰äº‹åŠ¡ã€‚å¦‚æœæ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™éäº‹åŠ¡çš„æ‰§è¡Œã€‚ä½†æ˜¯å¯¹äºäº‹åŠ¡åŒæ­¥çš„äº‹åŠ¡ç®¡ç†å™¨ï¼Œ<code>PROPAGATION_SUPPORTS</code> ä¸ä¸ä½¿ç”¨äº‹åŠ¡æœ‰å°‘è®¸ä¸åŒã€‚</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//äº‹åŠ¡å±æ€§ PROPAGATION_REQUIRED</span></span><br><span class="line"><span class="keyword">method</span><span class="constructor">A()</span>&#123;</span><br><span class="line">  <span class="keyword">method</span><span class="constructor">B()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//äº‹åŠ¡å±æ€§ PROPAGATION_SUPPORTS</span></span><br><span class="line"><span class="keyword">method</span><span class="constructor">B()</span>&#123;</span><br><span class="line">  â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å•çº¯çš„è°ƒç”¨ methodB æ—¶ï¼ŒmethodB æ–¹æ³•æ˜¯éäº‹åŠ¡çš„æ‰§è¡Œçš„ã€‚å½“è°ƒç”¨ methdA æ—¶,methodB åˆ™åŠ å…¥äº† methodA çš„äº‹åŠ¡ä¸­,äº‹åŠ¡åœ°æ‰§è¡Œã€‚</p>
<ol start="3">
<li><code>PROPAGATION_MANDATORY</code> å¦‚æœå·²ç»å­˜åœ¨ä¸€ä¸ªäº‹åŠ¡ï¼Œæ”¯æŒå½“å‰äº‹åŠ¡ã€‚å¦‚æœæ²¡æœ‰ä¸€ä¸ªæ´»åŠ¨çš„äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//äº‹åŠ¡å±æ€§ PROPAGATION_REQUIRED</span></span><br><span class="line"><span class="keyword">method</span><span class="constructor">A()</span>&#123;</span><br><span class="line">    <span class="keyword">method</span><span class="constructor">B()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//äº‹åŠ¡å±æ€§ PROPAGATION_MANDATORY</span></span><br><span class="line">    <span class="keyword">method</span><span class="constructor">B()</span>&#123;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“å•ç‹¬è°ƒç”¨ methodB æ—¶ï¼Œå› ä¸ºå½“å‰æ²¡æœ‰ä¸€ä¸ªæ´»åŠ¨çš„äº‹åŠ¡ï¼Œåˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ throw new IllegalTransactionStateException(â€œTransaction propagation â€˜mandatoryâ€™ but no existing transaction foundâ€);å½“è°ƒç”¨ methodA æ—¶ï¼ŒmethodB åˆ™åŠ å…¥åˆ° methodA çš„äº‹åŠ¡ä¸­ï¼Œäº‹åŠ¡åœ°æ‰§è¡Œã€‚</p>
<ol start="4">
<li><code>PROPAGATION_REQUIRES_NEW</code> æ€»æ˜¯å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚å¦‚æœä¸€ä¸ªäº‹åŠ¡å·²ç»å­˜åœ¨ï¼Œåˆ™å°†è¿™ä¸ªå­˜åœ¨çš„äº‹åŠ¡æŒ‚èµ·ã€‚</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//äº‹åŠ¡å±æ€§ PROPAGATION_REQUIRED</span></span><br><span class="line"><span class="keyword">method</span><span class="constructor">A()</span>&#123;</span><br><span class="line">    <span class="keyword">do</span><span class="constructor">SomeThingA()</span>;</span><br><span class="line">    <span class="keyword">method</span><span class="constructor">B()</span>;</span><br><span class="line">    <span class="keyword">do</span><span class="constructor">SomeThingB()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//äº‹åŠ¡å±æ€§ PROPAGATION_REQUIRES_NEW</span></span><br><span class="line"><span class="keyword">method</span><span class="constructor">B()</span>&#123;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨ A æ–¹æ³•ï¼š</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">main</span>()&#123;</span><br><span class="line">    <span class="built_in">methodA</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äº</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">main<span class="literal">()</span>&#123;</span><br><span class="line">    TransactionManager tm = null;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="comment">//è·å¾—ä¸€ä¸ªJTAäº‹åŠ¡ç®¡ç†å™¨</span></span><br><span class="line">        tm = get<span class="constructor">TransactionManager()</span>;</span><br><span class="line">        tm.<span class="keyword">begin</span><span class="literal">()</span>;<span class="comment">//å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡</span></span><br><span class="line">        Transaction ts1 = tm.get<span class="constructor">Transaction()</span>;</span><br><span class="line">        <span class="keyword">do</span><span class="constructor">SomeThing()</span>;</span><br><span class="line">        tm.suspend<span class="literal">()</span>;<span class="comment">//æŒ‚èµ·å½“å‰äº‹åŠ¡</span></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            tm.<span class="keyword">begin</span><span class="literal">()</span>;<span class="comment">//é‡æ–°å¼€å¯ç¬¬äºŒä¸ªäº‹åŠ¡</span></span><br><span class="line">            Transaction ts2 = tm.get<span class="constructor">Transaction()</span>;</span><br><span class="line">            <span class="keyword">method</span><span class="constructor">B()</span>;</span><br><span class="line">            ts2.commit<span class="literal">()</span>;<span class="comment">//æäº¤ç¬¬äºŒä¸ªäº‹åŠ¡</span></span><br><span class="line">        &#125; <span class="constructor">Catch(RunTimeException <span class="params">ex</span>)</span> &#123;</span><br><span class="line">            ts2.rollback<span class="literal">()</span>;<span class="comment">//å›æ»šç¬¬äºŒä¸ªäº‹åŠ¡</span></span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            <span class="comment">//é‡Šæ”¾èµ„æº</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//methodBæ‰§è¡Œå®Œåï¼Œæ¢å¤ç¬¬ä¸€ä¸ªäº‹åŠ¡</span></span><br><span class="line">        tm.resume(ts1);</span><br><span class="line">        <span class="keyword">do</span><span class="constructor">SomeThingB()</span>;</span><br><span class="line">        ts1.commit<span class="literal">()</span>;<span class="comment">//æäº¤ç¬¬ä¸€ä¸ªäº‹åŠ¡</span></span><br><span class="line">    &#125; catch(RunTimeException ex) &#123;</span><br><span class="line">        ts1.rollback<span class="literal">()</span>;<span class="comment">//å›æ»šç¬¬ä¸€ä¸ªäº‹åŠ¡</span></span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        <span class="comment">//é‡Šæ”¾èµ„æº</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨è¿™é‡Œï¼Œæˆ‘æŠŠ ts1 ç§°ä¸ºå¤–å±‚äº‹åŠ¡ï¼Œts2 ç§°ä¸ºå†…å±‚äº‹åŠ¡ã€‚ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹å‡ºï¼Œts2 ä¸ ts1 æ˜¯ä¸¤ä¸ªç‹¬ç«‹çš„äº‹åŠ¡ï¼Œäº’ä¸ç›¸å¹²ã€‚Ts2 æ˜¯å¦æˆåŠŸå¹¶ä¸ä¾èµ–äº ts1ã€‚å¦‚æœ methodA æ–¹æ³•åœ¨è°ƒç”¨ methodB æ–¹æ³•åçš„ doSomeThingB æ–¹æ³•å¤±è´¥äº†ï¼Œè€Œ methodB æ–¹æ³•æ‰€åšçš„ç»“æœä¾ç„¶è¢«æäº¤ã€‚è€Œé™¤äº† methodB ä¹‹å¤–çš„å…¶å®ƒä»£ç å¯¼è‡´çš„ç»“æœå´è¢«å›æ»šäº†ã€‚ä½¿ç”¨ PROPAGATION_REQUIRES_NEW,éœ€è¦ä½¿ç”¨ JtaTransactionManager ä½œä¸ºäº‹åŠ¡ç®¡ç†å™¨ã€‚</p>
<ol start="5">
<li><code>PROPAGATION_NOT_SUPPORTED</code> æ€»æ˜¯éäº‹åŠ¡åœ°æ‰§è¡Œï¼Œå¹¶æŒ‚èµ·ä»»ä½•å­˜åœ¨çš„äº‹åŠ¡ã€‚ä½¿ç”¨ PROPAGATION_NOT_SUPPORTED,ä¹Ÿéœ€è¦ä½¿ç”¨ JtaTransactionManager ä½œä¸ºäº‹åŠ¡ç®¡ç†å™¨ã€‚ï¼ˆä»£ç ç¤ºä¾‹åŒä¸Šï¼Œå¯åŒç†æ¨å‡ºï¼‰</li>
<li>PROPAGATION_NEVER æ€»æ˜¯éäº‹åŠ¡åœ°æ‰§è¡Œï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªæ´»åŠ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚</li>
<li>PROPAGATION_NESTED å¦‚æœä¸€ä¸ªæ´»åŠ¨çš„äº‹åŠ¡å­˜åœ¨ï¼Œåˆ™è¿è¡Œåœ¨ä¸€ä¸ªåµŒå¥—çš„äº‹åŠ¡ä¸­. å¦‚æœæ²¡æœ‰æ´»åŠ¨äº‹åŠ¡, åˆ™æŒ‰ TransactionDefinition.PROPAGATION_REQUIRED å±æ€§æ‰§è¡Œã€‚è¿™æ˜¯ä¸€ä¸ªåµŒå¥—äº‹åŠ¡,ä½¿ç”¨ JDBC 3.0 é©±åŠ¨æ—¶,ä»…ä»…æ”¯æŒ DataSourceTransactionManager ä½œä¸ºäº‹åŠ¡ç®¡ç†å™¨ã€‚éœ€è¦ JDBC é©±åŠ¨çš„ java.sql.Savepoint ç±»ã€‚æœ‰ä¸€äº› JTA çš„äº‹åŠ¡ç®¡ç†å™¨å®ç°å¯èƒ½ä¹Ÿæä¾›äº†åŒæ ·çš„åŠŸèƒ½ã€‚ä½¿ç”¨ PROPAGATION_NESTEDï¼Œè¿˜éœ€è¦æŠŠ PlatformTransactionManager çš„ nestedTransactionAllowed å±æ€§è®¾ä¸º true;è€Œ nestedTransactionAllowed å±æ€§å€¼é»˜è®¤ä¸º falseã€‚</li>
</ol>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//äº‹åŠ¡å±æ€§ PROPAGATION_REQUIRED</span></span><br><span class="line"><span class="keyword">method</span><span class="constructor">A()</span>&#123;</span><br><span class="line">    <span class="keyword">do</span><span class="constructor">SomeThingA()</span>;</span><br><span class="line">    <span class="keyword">method</span><span class="constructor">B()</span>;</span><br><span class="line">    <span class="keyword">do</span><span class="constructor">SomeThingB()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//äº‹åŠ¡å±æ€§ PROPAGATION_NESTED</span></span><br><span class="line"><span class="keyword">method</span><span class="constructor">B()</span>&#123;</span><br><span class="line">    â€¦â€¦</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå•ç‹¬è°ƒç”¨ methodB æ–¹æ³•ï¼Œåˆ™æŒ‰ REQUIRED å±æ€§æ‰§è¡Œã€‚å¦‚æœè°ƒç”¨ methodA æ–¹æ³•ï¼Œç›¸å½“äºä¸‹é¢çš„æ•ˆæœï¼š</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">main()&#123;</span><br><span class="line">    Connection con <span class="operator">=</span> null<span class="comment">;</span></span><br><span class="line">    Savepoint savepoint <span class="operator">=</span> null<span class="comment">;</span></span><br><span class="line">    try&#123;</span><br><span class="line">        con <span class="operator">=</span> getConnection()<span class="comment">;</span></span><br><span class="line">        con.setAutoCommit(false)<span class="comment">;</span></span><br><span class="line">        doSomeThingA()<span class="comment">;</span></span><br><span class="line">        savepoint <span class="operator">=</span> con2.setSavepoint()<span class="comment">;</span></span><br><span class="line">        try&#123;</span><br><span class="line">            methodB()<span class="comment">;</span></span><br><span class="line">        &#125; catch(RuntimeException ex) &#123;</span><br><span class="line">            con.rollback(savepoint)<span class="comment">;</span></span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            //é‡Šæ”¾èµ„æº</span><br><span class="line">        &#125;</span><br><span class="line">        doSomeThingB()<span class="comment">;</span></span><br><span class="line">        con.commit()<span class="comment">;</span></span><br><span class="line">    &#125; catch(RuntimeException ex) &#123;</span><br><span class="line">        con.rollback()<span class="comment">;</span></span><br><span class="line">    &#125; finally &#123;</span><br><span class="line">        //é‡Šæ”¾èµ„æº</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å½“ methodB æ–¹æ³•è°ƒç”¨ä¹‹å‰ï¼Œè°ƒç”¨ setSavepoint æ–¹æ³•ï¼Œä¿å­˜å½“å‰çš„çŠ¶æ€åˆ° savepointã€‚å¦‚æœ methodB æ–¹æ³•è°ƒç”¨å¤±è´¥ï¼Œåˆ™æ¢å¤åˆ°ä¹‹å‰ä¿å­˜çš„çŠ¶æ€ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™æ—¶çš„äº‹åŠ¡å¹¶æ²¡æœ‰è¿›è¡Œæäº¤ï¼Œå¦‚æœåç»­çš„ä»£ç (doSomeThingB()æ–¹æ³•)è°ƒç”¨å¤±è´¥ï¼Œåˆ™å›æ»šåŒ…æ‹¬ methodB æ–¹æ³•çš„æ‰€æœ‰æ“ä½œã€‚</p>
<p>åµŒå¥—äº‹åŠ¡ä¸€ä¸ªéå¸¸é‡è¦çš„æ¦‚å¿µå°±æ˜¯å†…å±‚äº‹åŠ¡ä¾èµ–äºå¤–å±‚äº‹åŠ¡ã€‚å¤–å±‚äº‹åŠ¡å¤±è´¥æ—¶ï¼Œä¼šå›æ»šå†…å±‚äº‹åŠ¡æ‰€åšçš„åŠ¨ä½œã€‚è€Œå†…å±‚äº‹åŠ¡æ“ä½œå¤±è´¥å¹¶ä¸ä¼šå¼•èµ·å¤–å±‚äº‹åŠ¡çš„å›æ»šã€‚</p>
<p>PROPAGATION_NESTED ä¸ PROPAGATION_REQUIRES_NEW çš„åŒºåˆ«:å®ƒä»¬éå¸¸ç±»ä¼¼,éƒ½åƒä¸€ä¸ªåµŒå¥—äº‹åŠ¡ï¼Œå¦‚æœä¸å­˜åœ¨ä¸€ä¸ªæ´»åŠ¨çš„äº‹åŠ¡ï¼Œéƒ½ä¼šå¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ã€‚ä½¿ç”¨ PROPAGATION_REQUIRES_NEW æ—¶ï¼Œå†…å±‚äº‹åŠ¡ä¸å¤–å±‚äº‹åŠ¡å°±åƒä¸¤ä¸ªç‹¬ç«‹çš„äº‹åŠ¡ä¸€æ ·ï¼Œä¸€æ—¦å†…å±‚äº‹åŠ¡è¿›è¡Œäº†æäº¤åï¼Œå¤–å±‚äº‹åŠ¡ä¸èƒ½å¯¹å…¶è¿›è¡Œå›æ»šã€‚ä¸¤ä¸ªäº‹åŠ¡äº’ä¸å½±å“ã€‚ä¸¤ä¸ªäº‹åŠ¡ä¸æ˜¯ä¸€ä¸ªçœŸæ­£çš„åµŒå¥—äº‹åŠ¡ã€‚åŒæ—¶å®ƒéœ€è¦ JTA äº‹åŠ¡ç®¡ç†å™¨çš„æ”¯æŒã€‚</p>
<p>ä½¿ç”¨ PROPAGATION_NESTED æ—¶ï¼Œå¤–å±‚äº‹åŠ¡çš„å›æ»šå¯ä»¥å¼•èµ·å†…å±‚äº‹åŠ¡çš„å›æ»šã€‚è€Œå†…å±‚äº‹åŠ¡çš„å¼‚å¸¸å¹¶ä¸ä¼šå¯¼è‡´å¤–å±‚äº‹åŠ¡çš„å›æ»šï¼Œå®ƒæ˜¯ä¸€ä¸ªçœŸæ­£çš„åµŒå¥—äº‹åŠ¡ã€‚DataSourceTransactionManager ä½¿ç”¨ savepoint æ”¯æŒ PROPAGATION_NESTED æ—¶ï¼Œéœ€è¦ JDBC 3.0 ä»¥ä¸Šé©±åŠ¨åŠ 1.4 ä»¥ä¸Šçš„ JDK ç‰ˆæœ¬æ”¯æŒã€‚å…¶å®ƒçš„ JTA TrasactionManager å®ç°å¯èƒ½æœ‰ä¸åŒçš„æ”¯æŒæ–¹å¼ã€‚</p>
<p>PROPAGATION_REQUIRES_NEW å¯åŠ¨ä¸€ä¸ªæ–°çš„, ä¸ä¾èµ–äºç¯å¢ƒçš„ â€œå†…éƒ¨â€ äº‹åŠ¡. è¿™ä¸ªäº‹åŠ¡å°†è¢«å®Œå…¨ commited æˆ– rolled back è€Œä¸ä¾èµ–äºå¤–éƒ¨äº‹åŠ¡, å®ƒæ‹¥æœ‰è‡ªå·±çš„éš”ç¦»èŒƒå›´, è‡ªå·±çš„é”, ç­‰ç­‰. å½“å†…éƒ¨äº‹åŠ¡å¼€å§‹æ‰§è¡Œæ—¶, å¤–éƒ¨äº‹åŠ¡å°†è¢«æŒ‚èµ·, å†…åŠ¡äº‹åŠ¡ç»“æŸæ—¶, å¤–éƒ¨äº‹åŠ¡å°†ç»§ç»­æ‰§è¡Œã€‚</p>
<p>å¦ä¸€æ–¹é¢, PROPAGATION_NESTED å¼€å§‹ä¸€ä¸ª â€œåµŒå¥—çš„â€ äº‹åŠ¡, å®ƒæ˜¯å·²ç»å­˜åœ¨äº‹åŠ¡çš„ä¸€ä¸ªçœŸæ­£çš„å­äº‹åŠ¡. æ½œå¥—äº‹åŠ¡å¼€å§‹æ‰§è¡Œæ—¶, å®ƒå°†å–å¾—ä¸€ä¸ª savepoint. å¦‚æœè¿™ä¸ªåµŒå¥—äº‹åŠ¡å¤±è´¥, æˆ‘ä»¬å°†å›æ»šåˆ°æ­¤ savepoint. æ½œå¥—äº‹åŠ¡æ˜¯å¤–éƒ¨äº‹åŠ¡çš„ä¸€éƒ¨åˆ†, åªæœ‰å¤–éƒ¨äº‹åŠ¡ç»“æŸåå®ƒæ‰ä¼šè¢«æäº¤ã€‚</p>
<p>ç”±æ­¤å¯è§, PROPAGATION_REQUIRES_NEW å’Œ PROPAGATION_NESTED çš„æœ€å¤§åŒºåˆ«åœ¨äº, PROPAGATION_REQUIRES_NEW å®Œå…¨æ˜¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡, è€Œ PROPAGATION_NESTED åˆ™æ˜¯å¤–éƒ¨äº‹åŠ¡çš„å­äº‹åŠ¡, å¦‚æœå¤–éƒ¨äº‹åŠ¡ commit, åµŒå¥—äº‹åŠ¡ä¹Ÿä¼šè¢« commit, è¿™ä¸ªè§„åˆ™åŒæ ·é€‚ç”¨äº roll back.</p>
<p>PROPAGATION_REQUIRED åº”è¯¥æ˜¯æˆ‘ä»¬é¦–å…ˆçš„äº‹åŠ¡ä¼ æ’­è¡Œä¸ºã€‚å®ƒèƒ½å¤Ÿæ»¡è¶³æˆ‘ä»¬å¤§å¤šæ•°çš„äº‹åŠ¡éœ€æ±‚ã€‚</p>
<h4 id="éš”ç¦»çº§åˆ«"><a href="#éš”ç¦»çº§åˆ«" class="headerlink" title="éš”ç¦»çº§åˆ«"></a>éš”ç¦»çº§åˆ«</h4><p>äº‹åŠ¡çš„ç¬¬äºŒä¸ªç»´åº¦å°±æ˜¯éš”ç¦»çº§åˆ«ï¼ˆisolation levelï¼‰ã€‚éš”ç¦»çº§åˆ«å®šä¹‰äº†ä¸€ä¸ªäº‹åŠ¡å¯èƒ½å—å…¶ä»–å¹¶å‘äº‹åŠ¡å½±å“çš„ç¨‹åº¦ã€‚</p>
<ol>
<li>å¹¶å‘äº‹åŠ¡å¼•èµ·çš„é—®é¢˜</li>
</ol>
<p>åœ¨å…¸å‹çš„åº”ç”¨ç¨‹åºä¸­ï¼Œå¤šä¸ªäº‹åŠ¡å¹¶å‘è¿è¡Œï¼Œç»å¸¸ä¼šæ“ä½œç›¸åŒçš„æ•°æ®æ¥å®Œæˆå„è‡ªçš„ä»»åŠ¡ã€‚å¹¶å‘è™½ç„¶æ˜¯å¿…é¡»çš„ï¼Œä½†å¯èƒ½ä¼šå¯¼è‡´ä¸€ä¸‹çš„é—®é¢˜ã€‚</p>
<blockquote>
<ul>
<li>è„è¯»ï¼ˆDirty readsï¼‰â€”â€”è„è¯»å‘ç”Ÿåœ¨ä¸€ä¸ªäº‹åŠ¡è¯»å–äº†å¦ä¸€ä¸ªäº‹åŠ¡æ”¹å†™ä½†å°šæœªæäº¤çš„æ•°æ®æ—¶ã€‚å¦‚æœæ”¹å†™åœ¨ç¨åè¢«å›æ»šäº†ï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªäº‹åŠ¡è·å–çš„æ•°æ®å°±æ˜¯æ— æ•ˆçš„ã€‚</li>
<li>ä¸å¯é‡å¤è¯»ï¼ˆNonrepeatable readï¼‰â€”â€”ä¸å¯é‡å¤è¯»å‘ç”Ÿåœ¨ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢ä¸¤æ¬¡æˆ–ä¸¤æ¬¡ä»¥ä¸Šï¼Œä½†æ˜¯æ¯æ¬¡éƒ½å¾—åˆ°ä¸åŒçš„æ•°æ®æ—¶ã€‚è¿™é€šå¸¸æ˜¯å› ä¸ºå¦ä¸€ä¸ªå¹¶å‘äº‹åŠ¡åœ¨ä¸¤æ¬¡æŸ¥è¯¢æœŸé—´è¿›è¡Œäº†æ›´æ–°ã€‚</li>
<li>å¹»è¯»ï¼ˆPhantom readï¼‰â€”â€”å¹»è¯»ä¸ä¸å¯é‡å¤è¯»ç±»ä¼¼ã€‚å®ƒå‘ç”Ÿåœ¨ä¸€ä¸ªäº‹åŠ¡ï¼ˆT1ï¼‰è¯»å–äº†å‡ è¡Œæ•°æ®ï¼Œæ¥ç€å¦ä¸€ä¸ªå¹¶å‘äº‹åŠ¡ï¼ˆT2ï¼‰æ’å…¥äº†ä¸€äº›æ•°æ®æ—¶ã€‚åœ¨éšåçš„æŸ¥è¯¢ä¸­ï¼Œç¬¬ä¸€ä¸ªäº‹åŠ¡ï¼ˆT1ï¼‰å°±ä¼šå‘ç°å¤šäº†ä¸€äº›åŸæœ¬ä¸å­˜åœ¨çš„è®°å½•ã€‚</li>
</ul>
</blockquote>
<p><strong>ä¸å¯é‡å¤è¯»ä¸å¹»è¯»çš„åŒºåˆ«</strong></p>
<p>ä¸å¯é‡å¤è¯»çš„é‡ç‚¹æ˜¯ä¿®æ”¹:<br>åŒæ ·çš„æ¡ä»¶, ä½ è¯»å–è¿‡çš„æ•°æ®, å†æ¬¡è¯»å–å‡ºæ¥å‘ç°å€¼ä¸ä¸€æ ·äº†<br>ä¾‹å¦‚ï¼šåœ¨äº‹åŠ¡ 1 ä¸­ï¼ŒMary è¯»å–äº†è‡ªå·±çš„å·¥èµ„ä¸º 1000,æ“ä½œå¹¶æ²¡æœ‰å®Œæˆ</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">con1</span> <span class="operator">=</span> getConnection()<span class="comment">;</span></span><br><span class="line">select salary from employee empId <span class="operator">=</span><span class="string">&quot;Mary&quot;</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨äº‹åŠ¡ 2 ä¸­ï¼Œè¿™æ—¶è´¢åŠ¡äººå‘˜ä¿®æ”¹äº† Mary çš„å·¥èµ„ä¸º 2000,å¹¶æäº¤äº†äº‹åŠ¡.</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">con2</span> <span class="operator">=</span> getConnection()<span class="comment">;</span></span><br><span class="line">update employee set salary <span class="operator">=</span> <span class="number">2000</span><span class="comment">;</span></span><br><span class="line">con2.commit()<span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>åœ¨äº‹åŠ¡ 1 ä¸­ï¼ŒMary å†æ¬¡è¯»å–è‡ªå·±çš„å·¥èµ„æ—¶ï¼Œå·¥èµ„å˜ä¸ºäº† 2000</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//con1</span></span><br><span class="line"><span class="keyword">select</span> salary <span class="keyword">from</span> employee empId =<span class="string">&quot;Mary&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­å‰åä¸¤æ¬¡è¯»å–çš„ç»“æœå¹¶ä¸ä¸€è‡´ï¼Œå¯¼è‡´äº†ä¸å¯é‡å¤è¯»ã€‚</p>
<p>å¹»è¯»çš„é‡ç‚¹åœ¨äºæ–°å¢æˆ–è€…åˆ é™¤ï¼š<br>åŒæ ·çš„æ¡ä»¶, ç¬¬ 1 æ¬¡å’Œç¬¬ 2 æ¬¡è¯»å‡ºæ¥çš„è®°å½•æ•°ä¸ä¸€æ ·<br>ä¾‹å¦‚ï¼šç›®å‰å·¥èµ„ä¸º 1000 çš„å‘˜å·¥æœ‰ 10 äººã€‚äº‹åŠ¡ 1,è¯»å–æ‰€æœ‰å·¥èµ„ä¸º 1000 çš„å‘˜å·¥ã€‚</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">con1</span> <span class="operator">=</span> getConnection()<span class="comment">;</span></span><br><span class="line">Select * from employee where salary <span class="operator">=</span><span class="number">1000</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>å…±è¯»å– 10 æ¡è®°å½•</p>
<p>è¿™æ—¶å¦ä¸€ä¸ªäº‹åŠ¡å‘ employee è¡¨æ’å…¥äº†ä¸€æ¡å‘˜å·¥è®°å½•ï¼Œå·¥èµ„ä¹Ÿä¸º 1000</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">con2 = getConnection();</span><br><span class="line"><span class="keyword">Insert</span> <span class="keyword">into</span> employee(empId,salary) <span class="keyword">values</span>(&quot;Lili&quot;,<span class="number">1000</span>);</span><br><span class="line">con2.<span class="keyword">commit</span>();</span><br></pre></td></tr></table></figure>

<p>äº‹åŠ¡ 1 å†æ¬¡è¯»å–æ‰€æœ‰å·¥èµ„ä¸º 1000 çš„å‘˜å·¥</p>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//con1</span></span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> employee <span class="keyword">where</span> salary =<span class="number">1000</span>;</span><br></pre></td></tr></table></figure>

<p>å…±è¯»å–åˆ°äº† 11 æ¡è®°å½•ï¼Œè¿™å°±äº§ç”Ÿäº†å¹»åƒè¯»ã€‚</p>
<p>ä»æ€»çš„ç»“æœæ¥çœ‹, ä¼¼ä¹ä¸å¯é‡å¤è¯»å’Œå¹»è¯»éƒ½è¡¨ç°ä¸ºä¸¤æ¬¡è¯»å–çš„ç»“æœä¸ä¸€è‡´ã€‚ä½†å¦‚æœä½ ä»æ§åˆ¶çš„è§’åº¦æ¥çœ‹, ä¸¤è€…çš„åŒºåˆ«å°±æ¯”è¾ƒå¤§ã€‚<br>å¯¹äºå‰è€…, åªéœ€è¦é”ä½æ»¡è¶³æ¡ä»¶çš„è®°å½•ã€‚<br>å¯¹äºåè€…, è¦é”ä½æ»¡è¶³æ¡ä»¶åŠå…¶ç›¸è¿‘çš„è®°å½•ã€‚</p>
<ol start="2">
<li>éš”ç¦»çº§åˆ«</li>
</ol>
<table>
<thead>
<tr>
<th>éš”ç¦»çº§åˆ«</th>
<th>å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td>ISOLATION_DEFAULT</td>
<td>ä½¿ç”¨åç«¯æ•°æ®åº“é»˜è®¤çš„éš”ç¦»çº§åˆ«</td>
</tr>
<tr>
<td>ISOLATION_READ_UNCOMMITTED</td>
<td>æœ€ä½çš„éš”ç¦»çº§åˆ«ï¼Œå…è®¸è¯»å–å°šæœªæäº¤çš„æ•°æ®å˜æ›´ï¼Œå¯èƒ½ä¼šå¯¼è‡´è„è¯»ã€å¹»è¯»æˆ–ä¸å¯é‡å¤è¯»</td>
</tr>
<tr>
<td>ISOLATION_READ_COMMITTED</td>
<td>å…è®¸è¯»å–å¹¶å‘äº‹åŠ¡å·²ç»æäº¤çš„æ•°æ®ï¼Œå¯ä»¥é˜»æ­¢è„è¯»ï¼Œä½†æ˜¯å¹»è¯»æˆ–ä¸å¯é‡å¤è¯»ä»æœ‰å¯èƒ½å‘ç”Ÿ</td>
</tr>
<tr>
<td>ISOLATION_REPEATABLE_READ</td>
<td>å¯¹åŒä¸€å­—æ®µçš„å¤šæ¬¡è¯»å–ç»“æœéƒ½æ˜¯ä¸€è‡´çš„ï¼Œé™¤éæ•°æ®æ˜¯è¢«æœ¬èº«äº‹åŠ¡è‡ªå·±æ‰€ä¿®æ”¹ï¼Œå¯ä»¥é˜»æ­¢è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œä½†å¹»è¯»ä»æœ‰å¯èƒ½å‘ç”Ÿ</td>
</tr>
<tr>
<td>ISOLATION_SERIALIZABLE</td>
<td>æœ€é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå®Œå…¨æœä» ACID çš„éš”ç¦»çº§åˆ«ï¼Œç¡®ä¿é˜»æ­¢è„è¯»ã€ä¸å¯é‡å¤è¯»ä»¥åŠå¹»è¯»ï¼Œä¹Ÿæ˜¯æœ€æ…¢çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Œå› ä¸ºå®ƒé€šå¸¸æ˜¯é€šè¿‡å®Œå…¨é”å®šäº‹åŠ¡ç›¸å…³çš„æ•°æ®åº“è¡¨æ¥å®ç°çš„</td>
</tr>
</tbody></table>
<h4 id="åªè¯»"><a href="#åªè¯»" class="headerlink" title="åªè¯»"></a>åªè¯»</h4><p>äº‹åŠ¡çš„ç¬¬ä¸‰ä¸ªç‰¹æ€§æ˜¯å®ƒæ˜¯å¦ä¸ºåªè¯»äº‹åŠ¡ã€‚å¦‚æœäº‹åŠ¡åªå¯¹åç«¯çš„æ•°æ®åº“è¿›è¡Œè¯¥æ“ä½œï¼Œæ•°æ®åº“å¯ä»¥åˆ©ç”¨äº‹åŠ¡çš„åªè¯»ç‰¹æ€§æ¥è¿›è¡Œä¸€äº›ç‰¹å®šçš„ä¼˜åŒ–ã€‚é€šè¿‡å°†äº‹åŠ¡è®¾ç½®ä¸ºåªè¯»ï¼Œä½ å°±å¯ä»¥ç»™æ•°æ®åº“ä¸€ä¸ªæœºä¼šï¼Œè®©å®ƒåº”ç”¨å®ƒè®¤ä¸ºåˆé€‚çš„ä¼˜åŒ–æªæ–½ã€‚</p>
<h4 id="äº‹åŠ¡è¶…æ—¶"><a href="#äº‹åŠ¡è¶…æ—¶" class="headerlink" title="äº‹åŠ¡è¶…æ—¶"></a>äº‹åŠ¡è¶…æ—¶</h4><p>ä¸ºäº†ä½¿åº”ç”¨ç¨‹åºå¾ˆå¥½åœ°è¿è¡Œï¼Œäº‹åŠ¡ä¸èƒ½è¿è¡Œå¤ªé•¿çš„æ—¶é—´ã€‚å› ä¸ºäº‹åŠ¡å¯èƒ½æ¶‰åŠå¯¹åç«¯æ•°æ®åº“çš„é”å®šï¼Œæ‰€ä»¥é•¿æ—¶é—´çš„äº‹åŠ¡ä¼šä¸å¿…è¦çš„å ç”¨æ•°æ®åº“èµ„æºã€‚äº‹åŠ¡è¶…æ—¶å°±æ˜¯äº‹åŠ¡çš„ä¸€ä¸ªå®šæ—¶å™¨ï¼Œåœ¨ç‰¹å®šæ—¶é—´å†…äº‹åŠ¡å¦‚æœæ²¡æœ‰æ‰§è¡Œå®Œæ¯•ï¼Œé‚£ä¹ˆå°±ä¼šè‡ªåŠ¨å›æ»šï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰å¾…å…¶ç»“æŸã€‚</p>
<h4 id="å›æ»šè§„åˆ™"><a href="#å›æ»šè§„åˆ™" class="headerlink" title="å›æ»šè§„åˆ™"></a>å›æ»šè§„åˆ™</h4><p>äº‹åŠ¡äº”è¾¹å½¢çš„æœ€åä¸€ä¸ªæ–¹é¢æ˜¯ä¸€ç»„è§„åˆ™ï¼Œè¿™äº›è§„åˆ™å®šä¹‰äº†å“ªäº›å¼‚å¸¸ä¼šå¯¼è‡´äº‹åŠ¡å›æ»šè€Œå“ªäº›ä¸ä¼šã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œäº‹åŠ¡åªæœ‰é‡åˆ°è¿è¡ŒæœŸå¼‚å¸¸æ—¶æ‰ä¼šå›æ»šï¼Œè€Œåœ¨é‡åˆ°æ£€æŸ¥å‹å¼‚å¸¸æ—¶ä¸ä¼šå›æ»šï¼ˆè¿™ä¸€è¡Œä¸ºä¸ EJB çš„å›æ»šè¡Œä¸ºæ˜¯ä¸€è‡´çš„ï¼‰<br>ä½†æ˜¯ä½ å¯ä»¥å£°æ˜äº‹åŠ¡åœ¨é‡åˆ°ç‰¹å®šçš„æ£€æŸ¥å‹å¼‚å¸¸æ—¶åƒé‡åˆ°è¿è¡ŒæœŸå¼‚å¸¸é‚£æ ·å›æ»šã€‚åŒæ ·ï¼Œä½ è¿˜å¯ä»¥å£°æ˜äº‹åŠ¡é‡åˆ°ç‰¹å®šçš„å¼‚å¸¸ä¸å›æ»šï¼Œå³ä½¿è¿™äº›å¼‚å¸¸æ˜¯è¿è¡ŒæœŸå¼‚å¸¸ã€‚</p>
<h3 id="TransactionStatus"><a href="#TransactionStatus" class="headerlink" title="TransactionStatus"></a>TransactionStatus</h3><p>ä¸Šé¢è®²åˆ°çš„è°ƒç”¨ <code>PlatformTransactionManager</code> æ¥å£çš„ <code>getTransaction()</code> çš„æ–¹æ³•å¾—åˆ°çš„æ˜¯ <code>TransactionStatus</code> æ¥å£çš„ä¸€ä¸ªå®ç°ï¼Œè¿™ä¸ªæ¥å£çš„å†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">TransactionStatus</span> <span class="keyword">extends</span> <span class="title class_">SavepointManager</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isNewTransaction</span><span class="params">()</span>; <span class="comment">// æ˜¯å¦æ˜¯æ–°çš„äº‹ç‰©</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">hasSavepoint</span><span class="params">()</span>; <span class="comment">// æ˜¯å¦æœ‰æ¢å¤ç‚¹</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">setRollbackOnly</span><span class="params">()</span>;  <span class="comment">// è®¾ç½®ä¸ºåªå›æ»š</span></span><br><span class="line">    <span class="type">boolean</span> <span class="title function_">isRollbackOnly</span><span class="params">()</span>; <span class="comment">// æ˜¯å¦ä¸ºåªå›æ»š</span></span><br><span class="line">    <span class="type">boolean</span> isCompleted; <span class="comment">// æ˜¯å¦å·²å®Œæˆ</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥å‘ç°è¿™ä¸ªæ¥å£æè¿°çš„æ˜¯ä¸€äº›å¤„ç†äº‹åŠ¡æä¾›ç®€å•çš„æ§åˆ¶äº‹åŠ¡æ‰§è¡Œå’ŒæŸ¥è¯¢äº‹åŠ¡çŠ¶æ€çš„æ–¹æ³•ï¼Œåœ¨å›æ»šæˆ–æäº¤çš„æ—¶å€™éœ€è¦åº”ç”¨å¯¹åº”çš„äº‹åŠ¡çŠ¶æ€ã€‚</p>
<h2 id="ç¼–ç¨‹å¼äº‹åŠ¡"><a href="#ç¼–ç¨‹å¼äº‹åŠ¡" class="headerlink" title="ç¼–ç¨‹å¼äº‹åŠ¡"></a>ç¼–ç¨‹å¼äº‹åŠ¡</h2><h3 id="ç¼–ç¨‹å¼å’Œå£°æ˜å¼äº‹åŠ¡çš„åŒºåˆ«"><a href="#ç¼–ç¨‹å¼å’Œå£°æ˜å¼äº‹åŠ¡çš„åŒºåˆ«" class="headerlink" title="ç¼–ç¨‹å¼å’Œå£°æ˜å¼äº‹åŠ¡çš„åŒºåˆ«"></a>ç¼–ç¨‹å¼å’Œå£°æ˜å¼äº‹åŠ¡çš„åŒºåˆ«</h3><p>Spring æä¾›äº†å¯¹ç¼–ç¨‹å¼äº‹åŠ¡å’Œå£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒã€‚ç¼–ç¨‹å¼äº‹åŠ¡å…è®¸ç”¨æˆ·åœ¨ä»£ç ä¸­ç²¾ç¡®å®šä¹‰äº‹åŠ¡çš„è¾¹ç•Œï¼Œè€Œå£°æ˜å¼äº‹åŠ¡ï¼ˆåŸºäº AOPï¼‰æœ‰åŠ©äºç”¨æˆ·å°†æ“ä½œä¸äº‹åŠ¡è§„åˆ™è¿›è¡Œè§£è€¦ã€‚<br>ç®€å•åœ°è¯´ï¼Œç¼–ç¨‹å¼äº‹åŠ¡ä¾µå…¥åˆ°äº†ä¸šåŠ¡ä»£ç é‡Œé¢ï¼Œä½†æ˜¯æä¾›äº†æ›´åŠ è¯¦ç»†çš„äº‹åŠ¡ç®¡ç†ï¼›è€Œå£°æ˜å¼äº‹åŠ¡ç”±äºåŸºäº AOPï¼Œæ‰€ä»¥æ—¢èƒ½èµ·åˆ°äº‹åŠ¡ç®¡ç†çš„ä½œç”¨ï¼Œåˆå¯ä»¥ä¸å½±å“ä¸šåŠ¡ä»£ç çš„å…·ä½“å®ç°ã€‚</p>
<p>Spring æä¾›ä¸¤ç§æ–¹å¼çš„ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ï¼Œåˆ†åˆ«æ˜¯ï¼šä½¿ç”¨ <code>TransactionTemplate</code> å’Œä½¿ç”¨ <code>PlatformTransactionManager</code>ã€‚</p>
<h3 id="ä½¿ç”¨-TransactionTemplate"><a href="#ä½¿ç”¨-TransactionTemplate" class="headerlink" title="ä½¿ç”¨ TransactionTemplate"></a>ä½¿ç”¨ TransactionTemplate</h3><p>é‡‡ç”¨ TransactionTemplate å’Œé‡‡ç”¨å…¶ä»– Spring æ¨¡æ¿ï¼Œå¦‚ JdbcTempalte å’Œ HibernateTemplate æ˜¯ä¸€æ ·çš„æ–¹æ³•ã€‚å®ƒä½¿ç”¨å›è°ƒæ–¹æ³•ï¼ŒæŠŠåº”ç”¨ç¨‹åºä»å¤„ç†å–å¾—å’Œé‡Šæ”¾èµ„æºä¸­è§£è„±å‡ºæ¥ã€‚å¦‚åŒå…¶ä»–æ¨¡æ¿ï¼ŒTransactionTemplate æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä»£ç ç‰‡æ®µï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">TransactionTemplate</span> <span class="variable">tt</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TransactionTemplate</span>(); <span class="comment">// æ–°å»ºä¸€ä¸ªTransactionTemplate</span></span><br><span class="line"><span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> tt.execute(</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">TransactionCallback</span>()&#123;</span><br><span class="line">        <span class="keyword">public</span> Object <span class="title function_">doTransaction</span><span class="params">(TransactionStatus status)</span>&#123;</span><br><span class="line">            updateOperation();</span><br><span class="line">            <span class="keyword">return</span> resultOfUpdateOperation();</span><br><span class="line">        &#125;</span><br><span class="line">&#125;); <span class="comment">// æ‰§è¡Œexecuteæ–¹æ³•è¿›è¡Œäº‹åŠ¡ç®¡ç†</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨ TransactionCallback()å¯ä»¥è¿”å›ä¸€ä¸ªå€¼ã€‚å¦‚æœä½¿ç”¨ TransactionCallbackWithoutResult åˆ™æ²¡æœ‰è¿”å›å€¼ã€‚</p>
<h3 id="ä½¿ç”¨-PlatformTransactionManager"><a href="#ä½¿ç”¨-PlatformTransactionManager" class="headerlink" title="ä½¿ç”¨ PlatformTransactionManager"></a>ä½¿ç”¨ PlatformTransactionManager</h3><p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">DataSourceTransactionManager</span> <span class="variable">dataSourceTransactionManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DataSourceTransactionManager</span>(); <span class="comment">//å®šä¹‰ä¸€ä¸ªæŸä¸ªæ¡†æ¶å¹³å°çš„TransactionManagerï¼Œå¦‚JDBCã€Hibernate</span></span><br><span class="line">dataSourceTransactionManager.setDataSource(<span class="built_in">this</span>.getJdbcTemplate().getDataSource()); <span class="comment">// è®¾ç½®æ•°æ®æº</span></span><br><span class="line"><span class="type">DefaultTransactionDefinition</span> <span class="variable">transDef</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultTransactionDefinition</span>(); <span class="comment">// å®šä¹‰äº‹åŠ¡å±æ€§</span></span><br><span class="line">transDef.setPropagationBehavior(DefaultTransactionDefinition.PROPAGATION_REQUIRED); <span class="comment">// è®¾ç½®ä¼ æ’­è¡Œä¸ºå±æ€§</span></span><br><span class="line"><span class="type">TransactionStatus</span> <span class="variable">status</span> <span class="operator">=</span> dataSourceTransactionManager.getTransaction(transDef); <span class="comment">// è·å¾—äº‹åŠ¡çŠ¶æ€</span></span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// æ•°æ®åº“æ“ä½œ</span></span><br><span class="line">    dataSourceTransactionManager.commit(status);<span class="comment">// æäº¤</span></span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    dataSourceTransactionManager.rollback(status);<span class="comment">// å›æ»š</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å£°æ˜å¼äº‹åŠ¡"><a href="#å£°æ˜å¼äº‹åŠ¡" class="headerlink" title="å£°æ˜å¼äº‹åŠ¡"></a>å£°æ˜å¼äº‹åŠ¡</h2><h3 id="é…ç½®æ–¹å¼"><a href="#é…ç½®æ–¹å¼" class="headerlink" title="é…ç½®æ–¹å¼"></a>é…ç½®æ–¹å¼</h3><p><em>æ³¨ï¼šä»¥ä¸‹é…ç½®ä»£ç å‚è€ƒè‡ª Spring äº‹åŠ¡é…ç½®çš„äº”ç§æ–¹å¼</em></p>
<p>æ ¹æ®ä»£ç†æœºåˆ¶çš„ä¸åŒï¼Œæ€»ç»“äº†äº”ç§ Spring äº‹åŠ¡çš„é…ç½®æ–¹å¼ï¼Œé…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</p>
<ol>
<li>æ¯ä¸ª Bean éƒ½æœ‰ä¸€ä¸ªä»£ç†</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:hibernate.cfg.xml&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configurationClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.hibernate.cfg.AnnotationConfiguration&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å®šä¹‰äº‹åŠ¡ç®¡ç†å™¨ï¼ˆå£°æ˜å¼çš„äº‹åŠ¡ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.HibernateTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®DAO --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoTarget&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.bluesky.spring.dao.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.transaction.interceptor.TransactionProxyFactoryBean&quot;</span>&gt;</span></span><br><span class="line">           <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;transactionManager&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;target&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoTarget&quot;</span> /&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;proxyInterfaces&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.bluesky.spring.dao.GeneratorDao&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡å±æ€§ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionAttributes&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;*&quot;</span>&gt;</span>PROPAGATION_REQUIRED<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>æ‰€æœ‰ Bean å…±äº«ä¸€ä¸ªä»£ç†åŸºç±»</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:hibernate.cfg.xml&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configurationClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.hibernate.cfg.AnnotationConfiguration&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å®šä¹‰äº‹åŠ¡ç®¡ç†å™¨ï¼ˆå£°æ˜å¼çš„äº‹åŠ¡ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.HibernateTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionBase&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;org.springframework.transaction.interceptor.TransactionProxyFactoryBean&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">lazy-init</span>=<span class="string">&quot;true&quot;</span> <span class="attr">abstract</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;transactionManager&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡å±æ€§ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionAttributes&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;*&quot;</span>&gt;</span>PROPAGATION_REQUIRED<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®DAO --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDaoTarget&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.bluesky.spring.dao.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">parent</span>=<span class="string">&quot;transactionBase&quot;</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;target&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;userDaoTarget&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>ä½¿ç”¨æ‹¦æˆªå™¨</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:hibernate.cfg.xml&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configurationClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.hibernate.cfg.AnnotationConfiguration&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å®šä¹‰äº‹åŠ¡ç®¡ç†å™¨ï¼ˆå£°æ˜å¼çš„äº‹åŠ¡ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.HibernateTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionInterceptor&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.transaction.interceptor.TransactionInterceptor&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;transactionManager&quot;</span> /&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®äº‹åŠ¡å±æ€§ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;transactionAttributes&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">&quot;*&quot;</span>&gt;</span>PROPAGATION_REQUIRED<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;beanNames&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>*Dao<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;interceptorNames&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">value</span>&gt;</span>transactionInterceptor<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- é…ç½®DAO --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.bluesky.spring.dao.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>ä½¿ç”¨ tx æ ‡ç­¾é…ç½®çš„æ‹¦æˆªå™¨</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.bluesky&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:hibernate.cfg.xml&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configurationClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.hibernate.cfg.AnnotationConfiguration&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å®šä¹‰äº‹åŠ¡ç®¡ç†å™¨ï¼ˆå£°æ˜å¼çš„äº‹åŠ¡ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.HibernateTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">propagation</span>=<span class="string">&quot;REQUIRED&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:pointcut</span> <span class="attr">id</span>=<span class="string">&quot;interceptorPointCuts&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">expression</span>=<span class="string">&quot;execution(* com.bluesky.spring.dao.*.*(..))&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">pointcut-ref</span>=<span class="string">&quot;interceptorPointCuts&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>å…¨æ³¨è§£</li>
</ol>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/beans/spring-beans-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/context/spring-context-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">           http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.bluesky&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sessionFactory&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.LocalSessionFactoryBean&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configLocation&quot;</span> <span class="attr">value</span>=<span class="string">&quot;classpath:hibernate.cfg.xml&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;configurationClass&quot;</span> <span class="attr">value</span>=<span class="string">&quot;org.hibernate.cfg.AnnotationConfiguration&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å®šä¹‰äº‹åŠ¡ç®¡ç†å™¨ï¼ˆå£°æ˜å¼çš„äº‹åŠ¡ï¼‰ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;org.springframework.orm.hibernate3.HibernateTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sessionFactory&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;sessionFactory&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶åœ¨ DAO ä¸Šéœ€åŠ ä¸Š@Transactional æ³¨è§£ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.bluesky.spring.dao;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.hibernate.SessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.orm.hibernate3.support.HibernateDaoSupport;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.bluesky.spring.domain.User;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Component(&quot;userDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">extends</span> <span class="title class_">HibernateDaoSupport</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">listUsers</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">this</span>.getSession().createQuery(<span class="string">&quot;from User&quot;</span>).list();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä¸€ä¸ªå£°æ˜å¼äº‹åŠ¡çš„å®ä¾‹"><a href="#ä¸€ä¸ªå£°æ˜å¼äº‹åŠ¡çš„å®ä¾‹" class="headerlink" title="ä¸€ä¸ªå£°æ˜å¼äº‹åŠ¡çš„å®ä¾‹"></a>ä¸€ä¸ªå£°æ˜å¼äº‹åŠ¡çš„å®ä¾‹</h3><p><em>æ³¨ï¼šè¯¥å®ä¾‹å‚è€ƒè‡ª Spring ä¸­çš„äº‹åŠ¡ç®¡ç†å®ä¾‹è¯¦è§£</em></p>
<p><strong>é¦–å…ˆæ˜¯æ•°æ®åº“è¡¨</strong></p>
<p>book(isbn, book_name, price)</p>
<p>account(username, balance)</p>
<p>book_stock(isbn, stock)</p>
<p><strong>ç„¶åæ˜¯ XML é…ç½®</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/context/spring-context-3.0.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">import</span> <span class="attr">resource</span>=<span class="string">&quot;applicationContext-db.xml&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span></span></span><br><span class="line"><span class="tag">        <span class="attr">base-package</span>=<span class="string">&quot;com.springinaction.transaction&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:annotation-driven</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;txManager&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>ä½¿ç”¨çš„ç±»</strong><br>BookShopDao</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springinaction.transaction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookShopDao</span> &#123;</span><br><span class="line">    <span class="comment">// æ ¹æ®ä¹¦å·è·å–ä¹¦çš„å•ä»·</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findBookPriceByIsbn</span><span class="params">(String isbn)</span>;</span><br><span class="line">    <span class="comment">// æ›´æ–°ä¹¦çš„åº“å­˜ï¼Œä½¿ä¹¦å·å¯¹åº”çš„åº“å­˜-1</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateBookStock</span><span class="params">(String isbn)</span>;</span><br><span class="line">    <span class="comment">// æ›´æ–°ç”¨æˆ·çš„è´¦æˆ·ä½™é¢ï¼šaccountçš„balance-price</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUserAccount</span><span class="params">(String username, <span class="type">int</span> price)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BookShopDaoImpl</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springinaction.transaction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Repository(&quot;bookShopDao&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookShopDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">BookShopDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate JdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">findBookPriceByIsbn</span><span class="params">(String isbn)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;SELECT price FROM book WHERE isbn = ?&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JdbcTemplate.queryForObject(sql, Integer.class, isbn);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateBookStock</span><span class="params">(String isbn)</span> &#123;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥ä¹¦çš„åº“å­˜æ˜¯å¦è¶³å¤Ÿï¼Œè‹¥ä¸å¤Ÿï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;SELECT stock FROM book_stock WHERE isbn = ?&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">stock</span> <span class="operator">=</span> JdbcTemplate.queryForObject(sql2, Integer.class, isbn);</span><br><span class="line">        <span class="keyword">if</span> (stock == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">BookStockException</span>(<span class="string">&quot;åº“å­˜ä¸è¶³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;UPDATE book_stock SET stock = stock - 1 WHERE isbn = ?&quot;</span>;</span><br><span class="line">        JdbcTemplate.update(sql, isbn);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUserAccount</span><span class="params">(String username, <span class="type">int</span> price)</span> &#123;</span><br><span class="line">        <span class="comment">//æ£€æŸ¥ä½™é¢æ˜¯å¦ä¸è¶³ï¼Œè‹¥ä¸è¶³ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">sql2</span> <span class="operator">=</span> <span class="string">&quot;SELECT balance FROM account WHERE username = ?&quot;</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">balance</span> <span class="operator">=</span> JdbcTemplate.queryForObject(sql2, Integer.class, username);</span><br><span class="line">        <span class="keyword">if</span> (balance &lt; price) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">UserAccountException</span>(<span class="string">&quot;ä½™é¢ä¸è¶³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;UPDATE account SET balance = balance - ? WHERE username = ?&quot;</span>;</span><br><span class="line">        JdbcTemplate.update(sql, price, username);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BookShopService</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springinaction.transaction;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">BookShopService</span> &#123;</span><br><span class="line">     <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">purchase</span><span class="params">(String username, String isbn)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BookShopServiceImpl</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springinaction.transaction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Isolation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Propagation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service(&quot;bookShopService&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookShopServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">BookShopService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookShopDao bookShopDao;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 1.æ·»åŠ äº‹åŠ¡æ³¨è§£</span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨propagation æŒ‡å®šäº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºï¼Œå³å½“å‰çš„äº‹åŠ¡æ–¹æ³•è¢«å¦å¤–ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è°ƒç”¨æ—¶å¦‚ä½•ä½¿ç”¨äº‹åŠ¡ã€‚</span></span><br><span class="line"><span class="comment">     * é»˜è®¤å–å€¼ä¸ºREQUIREDï¼Œå³ä½¿ç”¨è°ƒç”¨æ–¹æ³•çš„äº‹åŠ¡</span></span><br><span class="line"><span class="comment">     * REQUIRES_NEWï¼šä½¿ç”¨è‡ªå·±çš„äº‹åŠ¡ï¼Œè°ƒç”¨çš„äº‹åŠ¡æ–¹æ³•çš„äº‹åŠ¡è¢«æŒ‚èµ·ã€‚</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * 2.ä½¿ç”¨isolation æŒ‡å®šäº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Œæœ€å¸¸ç”¨çš„å–å€¼ä¸ºREAD_COMMITTED</span></span><br><span class="line"><span class="comment">     * 3.é»˜è®¤æƒ…å†µä¸‹ Spring çš„å£°æ˜å¼äº‹åŠ¡å¯¹æ‰€æœ‰çš„è¿è¡Œæ—¶å¼‚å¸¸è¿›è¡Œå›æ»šï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¯¹åº”çš„å±æ€§è¿›è¡Œè®¾ç½®ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œé»˜è®¤å€¼å³å¯ã€‚</span></span><br><span class="line"><span class="comment">     * 4.ä½¿ç”¨readOnly æŒ‡å®šäº‹åŠ¡æ˜¯å¦ä¸ºåªè¯»ã€‚ è¡¨ç¤ºè¿™ä¸ªäº‹åŠ¡åªè¯»å–æ•°æ®ä½†ä¸æ›´æ–°æ•°æ®ï¼Œè¿™æ ·å¯ä»¥å¸®åŠ©æ•°æ®åº“å¼•æ“ä¼˜åŒ–äº‹åŠ¡ã€‚è‹¥çœŸçš„æ˜¯ä¸€ä¸ªåªè¯»å–æ•°æ®åº“å€¼å¾—æ–¹æ³•ï¼Œåº”è®¾ç½®readOnly=true</span></span><br><span class="line"><span class="comment">     * 5.ä½¿ç”¨timeOut æŒ‡å®šå¼ºåˆ¶å›æ»šä¹‹å‰äº‹åŠ¡å¯ä»¥å ç”¨çš„æ—¶é—´ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Transactional(propagation=Propagation.REQUIRES_NEW,</span></span><br><span class="line"><span class="meta">            isolation=Isolation.READ_COMMITTED,</span></span><br><span class="line"><span class="meta">            noRollbackFor=&#123;UserAccountException.class&#125;,</span></span><br><span class="line"><span class="meta">            readOnly=true, timeout=3)</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">purchase</span><span class="params">(String username, String isbn)</span> &#123;</span><br><span class="line">        <span class="comment">//1.è·å–ä¹¦çš„å•ä»·</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">price</span> <span class="operator">=</span> bookShopDao.findBookPriceByIsbn(isbn);</span><br><span class="line">        <span class="comment">//2.æ›´æ–°ä¹¦çš„åº“å­˜</span></span><br><span class="line">        bookShopDao.updateBookStock(isbn);</span><br><span class="line">        <span class="comment">//3.æ›´æ–°ç”¨æˆ·ä½™é¢</span></span><br><span class="line">        bookShopDao.updateUserAccount(username, price);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Cashier</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springinaction.transaction;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">Cashier</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkout</span><span class="params">(String username, List&lt;String&gt;isbns)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CashierImplï¼šCashierImpl.checkout å’Œ bookShopService.purchase è”åˆæµ‹è¯•äº†äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springinaction.transaction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Service(&quot;cashier&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CashierImpl</span> <span class="keyword">implements</span> <span class="title class_">Cashier</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BookShopService bookShopService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">checkout</span><span class="params">(String username, List&lt;String&gt; isbns)</span> &#123;</span><br><span class="line">        <span class="keyword">for</span>(String isbn : isbns) &#123;</span><br><span class="line">            bookShopService.purchase(username, isbn);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>BookStockException</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springinaction.transaction;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BookStockException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookStockException</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookStockException</span><span class="params">(String arg0, Throwable arg1, <span class="type">boolean</span> arg2,</span></span><br><span class="line"><span class="params">            <span class="type">boolean</span> arg3)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arg0, arg1, arg2, arg3);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookStockException</span><span class="params">(String arg0, Throwable arg1)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arg0, arg1);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookStockException</span><span class="params">(String arg0)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arg0);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BookStockException</span><span class="params">(Throwable arg0)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arg0);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>UserAccountException</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springinaction.transaction;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserAccountException</span> <span class="keyword">extends</span> <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserAccountException</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>();</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserAccountException</span><span class="params">(String arg0, Throwable arg1, <span class="type">boolean</span> arg2,</span></span><br><span class="line"><span class="params">            <span class="type">boolean</span> arg3)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arg0, arg1, arg2, arg3);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserAccountException</span><span class="params">(String arg0, Throwable arg1)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arg0, arg1);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserAccountException</span><span class="params">(String arg0)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arg0);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserAccountException</span><span class="params">(Throwable arg0)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>(arg0);</span><br><span class="line">        <span class="comment">// TODO Auto-generated constructor stub</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ç±»</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.springinaction.transaction;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringTransitionTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">ApplicationContext</span> <span class="variable">ctx</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">BookShopDao</span> <span class="variable">bookShopDao</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">BookShopService</span> <span class="variable">bookShopService</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">Cashier</span> <span class="variable">cashier</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">    &#123;</span><br><span class="line">        ctx = <span class="keyword">new</span> <span class="title class_">ClassPathXmlApplicationContext</span>(<span class="string">&quot;config/transaction.xml&quot;</span>);</span><br><span class="line">        bookShopDao = ctx.getBean(BookShopDao.class);</span><br><span class="line">        bookShopService = ctx.getBean(BookShopService.class);</span><br><span class="line">        cashier = ctx.getBean(Cashier.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBookShopDaoFindPriceByIsbn</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(bookShopDao.findBookPriceByIsbn(<span class="string">&quot;1001&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBookShopDaoUpdateBookStock</span><span class="params">()</span>&#123;</span><br><span class="line">        bookShopDao.updateBookStock(<span class="string">&quot;1001&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBookShopDaoUpdateUserAccount</span><span class="params">()</span>&#123;</span><br><span class="line">        bookShopDao.updateUserAccount(<span class="string">&quot;AA&quot;</span>, <span class="number">100</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testBookShopService</span><span class="params">()</span>&#123;</span><br><span class="line">        bookShopService.purchase(<span class="string">&quot;AA&quot;</span>, <span class="string">&quot;1001&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testTransactionPropagation</span><span class="params">()</span>&#123;</span><br><span class="line">        cashier.checkout(<span class="string">&quot;AA&quot;</span>, Arrays.asList(<span class="string">&quot;1001&quot;</span>, <span class="string">&quot;1002&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/cf19fd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/cf19fd/" class="post-title-link" itemprop="url">Spring ä¹‹ JDBC</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-02-18 14:33:55" itemprop="dateCreated datePublished" datetime="2019-02-18T14:33:55+08:00">2019-02-18</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/Spring%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">Springæ•°æ®</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>20k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>19 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="Spring-ä¹‹-JDBC"><a href="#Spring-ä¹‹-JDBC" class="headerlink" title="Spring ä¹‹ JDBC"></a>Spring ä¹‹ JDBC</h1><p>JDBC æ˜¯ Java è¯­è¨€ä¸­ç”¨æ¥è§„èŒƒå®¢æˆ·ç«¯ç¨‹åºå¦‚ä½•è®¿é—®æ•°æ®åº“çš„åº”ç”¨ç¨‹åºæ¥å£ï¼Œæä¾›äº†å¢ã€åˆ ã€æ”¹ã€æŸ¥æ•°æ®åº“çš„æ–¹æ³•ã€‚</p>
<h2 id="JdbcTemplate-API"><a href="#JdbcTemplate-API" class="headerlink" title="JdbcTemplate API"></a>JdbcTemplate API</h2><p><code>spring-boot-starter-data-jdbc</code> å¼•å…¥äº† <code>spring-jdbc</code> ï¼Œå…¶ JDBC ç‰¹æ€§å°±æ˜¯åŸºäº <code>spring-jdbc</code>ã€‚</p>
<p>è€Œ <code>spring-jdbc</code> æœ€æ ¸å¿ƒçš„ API æ— ç–‘å°±æ˜¯ <code>JdbcTemplate</code>ï¼Œå¯ä»¥è¯´æ‰€æœ‰çš„ JDBC æ•°æ®è®¿é—®ï¼Œå‡ ä¹éƒ½æ˜¯å›´ç»•ç€è¿™ä¸ªç±»å»å·¥ä½œçš„ã€‚</p>
<p>Spring å¯¹æ•°æ®åº“çš„æ“ä½œåœ¨ Jdbc å±‚é¢åšäº†æ·±å±‚æ¬¡çš„å°è£…ï¼Œåˆ©ç”¨ä¾èµ–æ³¨å…¥ï¼ŒæŠŠæ•°æ®æºé…ç½®è£…é…åˆ° <code>JdbcTemplate</code> ä¸­ï¼Œå†ç”± <code>JdbcTemplate</code> è´Ÿè´£å…·ä½“çš„æ•°æ®è®¿é—®ã€‚</p>
<p><code>JdbcTemplate</code> ä¸»è¦æä¾›ä»¥ä¸‹å‡ ç±»æ–¹æ³•ï¼š</p>
<ul>
<li><code>execute</code> æ–¹æ³•ï¼šå¯ä»¥ç”¨äºæ‰§è¡Œä»»ä½• SQL è¯­å¥ï¼Œä¸€èˆ¬ç”¨äºæ‰§è¡Œ DDL è¯­å¥ï¼›</li>
<li><code>update</code> æ–¹æ³•åŠ <code>batchUpdate</code> æ–¹æ³•ï¼š<code>update</code> æ–¹æ³•ç”¨äºæ‰§è¡Œæ–°å¢ã€ä¿®æ”¹ã€åˆ é™¤ç­‰è¯­å¥ï¼›<code>batchUpdate</code> æ–¹æ³•ç”¨äºæ‰§è¡Œæ‰¹å¤„ç†ç›¸å…³è¯­å¥ï¼›</li>
<li><code>query</code> æ–¹æ³•åŠ <code>queryForXXX</code> æ–¹æ³•ï¼šç”¨äºæ‰§è¡ŒæŸ¥è¯¢ç›¸å…³è¯­å¥ï¼›</li>
<li><code>call</code> æ–¹æ³•ï¼šç”¨äºæ‰§è¡Œå­˜å‚¨è¿‡ç¨‹ã€å‡½æ•°ç›¸å…³è¯­å¥ã€‚</li>
</ul>
<p>ä¸ºäº†æ–¹ä¾¿æ¼”ç¤ºï¼Œä»¥ä¸‹å¢åˆ æ”¹æŸ¥æ“ä½œéƒ½å›´ç»•ä¸€ä¸ªåä¸º user çš„è¡¨ï¼ˆè¯¥è¡¨çš„ä¸»é”® id æ˜¯è‡ªå¢åºåˆ—ï¼‰è¿›è¡Œï¼Œè¯¥è¡¨çš„æ•°æ®å®ä½“å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// çœç•¥ getter/setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ•°æ®å®ä½“åªè¦æ˜¯ä¸€ä¸ªçº¯ç²¹çš„ Java Bean å³å¯ï¼Œæ— éœ€ä»»ä½•æ³¨è§£ä¿®é¥°ã€‚</p>
<h3 id="execute-æ–¹æ³•"><a href="#execute-æ–¹æ³•" class="headerlink" title="execute æ–¹æ³•"></a>execute æ–¹æ³•</h3><p>ä½¿ç”¨ execute æ‰§è¡Œ DDL è¯­å¥ï¼Œåˆ›å»ºä¸€ä¸ªåä¸º test çš„æ•°æ®åº“ï¼Œå¹¶åœ¨æ­¤æ•°æ®åº“ä¸‹æ–°å»ºä¸€ä¸ªåä¸º user çš„è¡¨ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">recreateTable</span><span class="params">()</span> &#123;</span><br><span class="line">    jdbcTemplate.execute(<span class="string">&quot;DROP DATABASE IF EXISTS test&quot;</span>);</span><br><span class="line">    jdbcTemplate.execute(<span class="string">&quot;CREATE DATABASE test&quot;</span>);</span><br><span class="line">    jdbcTemplate.execute(<span class="string">&quot;USE test&quot;</span>);</span><br><span class="line">    jdbcTemplate.execute(<span class="string">&quot;DROP TABLE if EXISTS user&quot;</span>);</span><br><span class="line">    jdbcTemplate.execute(<span class="string">&quot;DROP TABLE if EXISTS user&quot;</span>);</span><br><span class="line">    <span class="comment">// @formatter:off</span></span><br><span class="line">    <span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">    sb.append(<span class="string">&quot;CREATE TABLE user (id int (10) unsigned NOT NULL AUTO_INCREMENT,\n&quot;</span>)</span><br><span class="line">        .append(<span class="string">&quot;name varchar (64) NOT NULL DEFAULT &#x27;&#x27;,\n&quot;</span>)</span><br><span class="line">        .append(<span class="string">&quot;age tinyint (3) NOT NULL DEFAULT 0,\n&quot;</span>)</span><br><span class="line">        .append(<span class="string">&quot;PRIMARY KEY (ID));\n&quot;</span>);</span><br><span class="line">    <span class="comment">// @formatter:on</span></span><br><span class="line">    jdbcTemplate.execute(sb.toString());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="update-æ–¹æ³•"><a href="#update-æ–¹æ³•" class="headerlink" title="update æ–¹æ³•"></a>update æ–¹æ³•</h3><p>æ–°å¢æ•°æ®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(String name, Integer age)</span> &#123;</span><br><span class="line">    jdbcTemplate.update(<span class="string">&quot;INSERT INTO user(name, age) VALUES(?, ?)&quot;</span>, name, age);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ é™¤æ•°æ®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    jdbcTemplate.update(<span class="string">&quot;DELETE FROM user WHERE name = ?&quot;</span>, name);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹æ•°æ®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(User user)</span> &#123;</span><br><span class="line">    jdbcTemplate.update(<span class="string">&quot;UPDATE USER SET name=?, age=? WHERE id=?&quot;</span>, user.getName(), user.getAge(), user.getId());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‰¹å¤„ç†</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">batchInsert</span><span class="params">(List&lt;User&gt; users)</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO user(name, age) VALUES(?, ?)&quot;</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;Object[]&gt; params = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    users.forEach(item -&gt; &#123;</span><br><span class="line">        params.add(<span class="keyword">new</span> <span class="title class_">Object</span>[] &#123;item.getName(), item.getAge()&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    jdbcTemplate.batchUpdate(sql, params);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="query-æ–¹æ³•"><a href="#query-æ–¹æ³•" class="headerlink" title="query æ–¹æ³•"></a>query æ–¹æ³•</h3><p>æŸ¥å•ä¸ªå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> User <span class="title function_">queryByName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate</span><br><span class="line">            .queryForObject(<span class="string">&quot;SELECT * FROM user WHERE name = ?&quot;</span>, <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;&gt;(User.class), name);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (EmptyResultDataAccessException e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŸ¥å¤šä¸ªå¯¹è±¡</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> List&lt;User&gt; <span class="title function_">list</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> jdbcTemplate.query(<span class="string">&quot;select * from USER&quot;</span>, <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>(User.class));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è·å–æŸä¸ªè®°å½•æŸåˆ—æˆ–è€… countã€avgã€sum ç­‰å‡½æ•°è¿”å›å”¯ä¸€å€¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Integer <span class="title function_">count</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate.queryForObject(<span class="string">&quot;SELECT COUNT(*) FROM user&quot;</span>, Integer.class);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (EmptyResultDataAccessException e) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="JDBC-å®ä¾‹"><a href="#JDBC-å®ä¾‹" class="headerlink" title="JDBC å®ä¾‹"></a>JDBC å®ä¾‹</h2><p>JDBC çš„å·¥ä½œæ­¥éª¤å¤§è‡´å¦‚ä¸‹ï¼š</p>
<ol>
<li>åˆ›å»ºå®ä½“ç±»ã€‚</li>
<li>å£°æ˜æ•°æ®åº“è¯»å†™æ¥å£çš„ DAO æ¥å£ã€‚å®šä¹‰ DAO çš„å¥½å¤„åœ¨äºå¯¹äºæ•°æ®å±‚ä¸Šå±‚çš„ä¸šåŠ¡ï¼Œè°ƒç”¨ DAO æ—¶ä»…å…³æ³¨å¯¹å¤–æš´éœ²çš„è¯»å†™æ–¹æ³•ï¼Œè€Œä¸è€ƒè™‘åº•å±‚çš„å…·ä½“æŒä¹…åŒ–æ–¹å¼ã€‚è¿™æ ·ï¼Œä¾¿äºæ›¿æ¢æŒä¹…åŒ–æ–¹å¼ã€‚</li>
<li>åˆ›å»ºä¸€ä¸ª DAO æ¥å£çš„å®ç°ç±»ï¼Œä½¿ç”¨ Spring çš„ JDBC æ¨¡æ¿å»å®ç°æ¥å£ã€‚</li>
<li>æœ€åï¼Œå®šä¹‰ä¸€ä¸ª DAO æ¥å£çš„å®ç°ç±»çš„ JavaBeanï¼Œå¹¶å°†æ•°æ®æºæ³¨å…¥è¿›å»ã€‚</li>
</ol>
<p>å‡è®¾ï¼Œæˆ‘ä»¬è¦é€šè¿‡ Spring + JDBC è®¿é—®ä¸€å¼  Mysql æ•°æ®è¡¨ <code>user</code>ï¼Œ<code>user</code> è¡¨çš„æ•°æ®ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- åˆ›å»ºç”¨æˆ·è¡¨</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `<span class="keyword">user</span>` (</span><br><span class="line">    `id`      <span class="type">BIGINT</span>(<span class="number">20</span>) UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ID&#x27;</span>,</span><br><span class="line">    `name`    <span class="type">VARCHAR</span>(<span class="number">255</span>)        <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;ç”¨æˆ·å&#x27;</span>,</span><br><span class="line">    `age`     <span class="type">INT</span>(<span class="number">3</span>)              <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;å¹´é¾„&#x27;</span>,</span><br><span class="line">    `address` <span class="type">VARCHAR</span>(<span class="number">255</span>)        <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;åœ°å€&#x27;</span>,</span><br><span class="line">    `email`   <span class="type">VARCHAR</span>(<span class="number">255</span>)        <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;é‚®ä»¶&#x27;</span>,</span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">    <span class="keyword">UNIQUE</span> (`name`)</span><br><span class="line">) COMMENT <span class="operator">=</span> <span class="string">&#x27;ç”¨æˆ·è¡¨&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="keyword">user</span>` (`name`, `age`, `address`, `email`)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;å¼ ä¸‰&#x27;</span>, <span class="number">18</span>, <span class="string">&#x27;åŒ—äº¬&#x27;</span>, <span class="string">&#x27;xxx@163.com&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> `<span class="keyword">user</span>` (`name`, `age`, `address`, `email`)</span><br><span class="line"><span class="keyword">VALUES</span> (<span class="string">&#x27;æå››&#x27;</span>, <span class="number">19</span>, <span class="string">&#x27;ä¸Šæµ·&#x27;</span>, <span class="string">&#x27;xxx@163.com&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="å®šä¹‰å®ä½“"><a href="#å®šä¹‰å®ä½“" class="headerlink" title="å®šä¹‰å®ä½“"></a>å®šä¹‰å®ä½“</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.ToString;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String address;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®šä¹‰-DAO-æ¥å£"><a href="#å®šä¹‰-DAO-æ¥å£" class="headerlink" title="å®šä¹‰ DAO æ¥å£"></a>å®šä¹‰ DAO æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * user è¡¨ Dao æ¥å£</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &lt;a href=&quot;mailto:forbreak@163.com&quot;&gt;Zhang Peng&lt;/a&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2019-11-18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// DML</span></span><br><span class="line">    <span class="comment">// -------------------------------------------------------------------</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">batchInsert</span><span class="params">(List&lt;User&gt; users)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteByName</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line">    Integer <span class="title function_">count</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; <span class="title function_">list</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    User <span class="title function_">queryByName</span><span class="params">(String name)</span>;</span><br><span class="line"></span><br><span class="line">    JdbcTemplate <span class="title function_">getJdbcTemplate</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// DDL</span></span><br><span class="line">    <span class="comment">// -------------------------------------------------------------------</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">truncate</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">recreateTable</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å®šä¹‰-DAO-å®ç°ç±»"><a href="#å®šä¹‰-DAO-å®ç°ç±»" class="headerlink" title="å®šä¹‰ DAO å®ç°ç±»"></a>å®šä¹‰ DAO å®ç°ç±»</h3><p>é€šè¿‡ <code>JdbcTemplate</code> æ‰§è¡Œå¯¹åº”æ•°æ®æºç¬¦åˆè¯­æ³•çš„ SQLï¼Œå³å¯å®Œæˆå„ç§æ•°æ®åº“è®¿é—®ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> io.github.dunwu.springboot.core.data.jdbc;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.dao.EmptyResultDataAccessException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.BeanPropertyRowMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * user è¡¨ Dao æ¥å£å®ç°ç±»</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> &lt;a href=&quot;mailto:forbreak@163.com&quot;&gt;Zhang Peng&lt;/a&gt;</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 2019-11-18</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title class_">UserDao</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">UserDaoImpl</span><span class="params">(JdbcTemplate jdbcTemplate)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.jdbcTemplate = jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        jdbcTemplate.update(<span class="string">&quot;INSERT INTO user(name, age, address, email) VALUES(?, ?, ?, ?)&quot;</span>,</span><br><span class="line">            user.getName(), user.getAge(), user.getAddress(), user.getEmail());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">batchInsert</span><span class="params">(List&lt;User&gt; users)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;INSERT INTO user(name, age, address, email) VALUES(?, ?, ?, ?)&quot;</span>;</span><br><span class="line"></span><br><span class="line">        List&lt;Object[]&gt; params = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        users.forEach(user -&gt; &#123;</span><br><span class="line">            params.add(<span class="keyword">new</span> <span class="title class_">Object</span>[] &#123; user.getName(), user.getAge(), user.getAddress(), user.getEmail() &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        jdbcTemplate.batchUpdate(sql, params);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteByName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        jdbcTemplate.update(<span class="string">&quot;DELETE FROM user WHERE name = ?&quot;</span>, name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteAll</span><span class="params">()</span> &#123;</span><br><span class="line">        jdbcTemplate.execute(<span class="string">&quot;DELETE FROM user&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        jdbcTemplate.update(<span class="string">&quot;UPDATE user SET name=?, age=?, address=?, email=? WHERE id=?&quot;</span>,</span><br><span class="line">            user.getName(), user.getAge(), user.getAddress(), user.getEmail(), user.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">count</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> jdbcTemplate.queryForObject(<span class="string">&quot;SELECT COUNT(*) FROM user&quot;</span>, Integer.class);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (EmptyResultDataAccessException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;User&gt; <span class="title function_">list</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate.query(<span class="string">&quot;SELECT * FROM user&quot;</span>, <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;&gt;(User.class));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> User <span class="title function_">queryByName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> jdbcTemplate.queryForObject(<span class="string">&quot;SELECT * FROM user WHERE name = ?&quot;</span>,</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">BeanPropertyRowMapper</span>&lt;&gt;(User.class), name);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (EmptyResultDataAccessException e) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> JdbcTemplate <span class="title function_">getJdbcTemplate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">truncate</span><span class="params">()</span> &#123;</span><br><span class="line">        jdbcTemplate.execute(<span class="string">&quot;TRUNCATE TABLE user&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">recreateTable</span><span class="params">()</span> &#123;</span><br><span class="line">        jdbcTemplate.execute(<span class="string">&quot;DROP TABLE IF EXISTS user&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">sqlStatement</span> <span class="operator">=</span></span><br><span class="line">            <span class="string">&quot;CREATE TABLE IF NOT EXISTS user (\n&quot;</span></span><br><span class="line">                + <span class="string">&quot;    id      BIGINT(10) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT &#x27;Id&#x27;,\n&quot;</span></span><br><span class="line">                + <span class="string">&quot;    name    VARCHAR(255)         NOT NULL DEFAULT &#x27;&#x27; COMMENT &#x27;ç”¨æˆ·å&#x27;,\n&quot;</span></span><br><span class="line">                + <span class="string">&quot;    age     INT(3)              NOT NULL DEFAULT 0 COMMENT &#x27;å¹´é¾„&#x27;,\n&quot;</span></span><br><span class="line">                + <span class="string">&quot;    address VARCHAR(255)         NOT NULL DEFAULT &#x27;&#x27; COMMENT &#x27;åœ°å€&#x27;,\n&quot;</span></span><br><span class="line">                + <span class="string">&quot;    email   VARCHAR(255)         NOT NULL DEFAULT &#x27;&#x27; COMMENT &#x27;é‚®ä»¶&#x27;,\n&quot;</span></span><br><span class="line">                + <span class="string">&quot;    PRIMARY KEY (id)\n&quot;</span></span><br><span class="line">                + <span class="string">&quot;) COMMENT = &#x27;ç”¨æˆ·è¡¨&#x27;;&quot;</span>;</span><br><span class="line">        jdbcTemplate.execute(sqlStatement);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•ç±»"><a href="#æµ‹è¯•ç±»" class="headerlink" title="æµ‹è¯•ç±»"></a>æµ‹è¯•ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.BeforeEach;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.annotation.Rollback;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.assertj.core.api.Assertions.assertThat;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Rollback</span></span><br><span class="line"><span class="meta">@SpringBootTest(classes = &#123; SpringBootDataJdbcApplication.class &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DataJdbcMysqlDataSourceTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserDao userDAO;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@BeforeEach</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span> &#123;</span><br><span class="line">        userDAO.truncate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">()</span> &#123;</span><br><span class="line">        userDAO.insert(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">18</span>, <span class="string">&quot;åŒ—äº¬&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line">        <span class="type">User</span> <span class="variable">linda</span> <span class="operator">=</span> userDAO.queryByName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">        assertThat(linda).isNotNull();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">batchInsert</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;User&gt; users = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">18</span>, <span class="string">&quot;åŒ—äº¬&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;æå››&quot;</span>, <span class="number">19</span>, <span class="string">&quot;ä¸Šæµ·&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;ç‹äº”&quot;</span>, <span class="number">18</span>, <span class="string">&quot;å—äº¬&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;èµµå…­&quot;</span>, <span class="number">20</span>, <span class="string">&quot;æ­¦æ±‰&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line"></span><br><span class="line">        userDAO.batchInsert(users);</span><br><span class="line">        <span class="type">int</span> <span class="variable">count</span> <span class="operator">=</span> userDAO.count();</span><br><span class="line">        assertThat(count).isEqualTo(<span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">        List&lt;User&gt; list = userDAO.list();</span><br><span class="line">        assertThat(list).isNotEmpty().hasSize(<span class="number">4</span>);</span><br><span class="line">        list.forEach(user -&gt; &#123;</span><br><span class="line">            log.info(user.toString());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">delete</span><span class="params">()</span> &#123;</span><br><span class="line">        List&lt;User&gt; users = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">18</span>, <span class="string">&quot;åŒ—äº¬&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;æå››&quot;</span>, <span class="number">19</span>, <span class="string">&quot;ä¸Šæµ·&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;ç‹äº”&quot;</span>, <span class="number">18</span>, <span class="string">&quot;å—äº¬&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line">        users.add(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;èµµå…­&quot;</span>, <span class="number">20</span>, <span class="string">&quot;æ­¦æ±‰&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line">        userDAO.batchInsert(users);</span><br><span class="line"></span><br><span class="line">        userDAO.deleteByName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userDAO.queryByName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">        assertThat(user).isNull();</span><br><span class="line"></span><br><span class="line">        userDAO.deleteAll();</span><br><span class="line">        List&lt;User&gt; list = userDAO.list();</span><br><span class="line">        assertThat(list).isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">()</span> &#123;</span><br><span class="line">        userDAO.insert(<span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;å¼ ä¸‰&quot;</span>, <span class="number">18</span>, <span class="string">&quot;åŒ—äº¬&quot;</span>, <span class="string">&quot;user1@163.com&quot;</span>));</span><br><span class="line">        <span class="type">User</span> <span class="variable">oldUser</span> <span class="operator">=</span> userDAO.queryByName(<span class="string">&quot;å¼ ä¸‰&quot;</span>);</span><br><span class="line">        oldUser.setName(<span class="string">&quot;å¼ ä¸‰ä¸°&quot;</span>);</span><br><span class="line">        userDAO.update(oldUser);</span><br><span class="line">        <span class="type">User</span> <span class="variable">newUser</span> <span class="operator">=</span> userDAO.queryByName(<span class="string">&quot;å¼ ä¸‰ä¸°&quot;</span>);</span><br><span class="line">        assertThat(newUser).isNotNull();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Spring-Boot-JDBC"><a href="#Spring-Boot-JDBC" class="headerlink" title="Spring Boot JDBC"></a>Spring Boot JDBC</h2><blockquote>
<p>å®Œæ•´ç¤ºä¾‹ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-tutorial/tree/master/codes/data/spring-boot-data-jdbc">spring-boot-data-jdbc</a></p>
</blockquote>
<h3 id="å¼•å…¥-Spring-Boot-ä¾èµ–"><a href="#å¼•å…¥-Spring-Boot-ä¾èµ–" class="headerlink" title="å¼•å…¥ Spring Boot ä¾èµ–"></a>å¼•å…¥ Spring Boot ä¾èµ–</h3><p>ä½ å¯ä»¥é€šè¿‡ Spring Boot å®˜æ–¹çš„åˆå§‹åŒ–å™¨ï¼ˆ<a target="_blank" rel="noopener" href="https://start.spring.io/">Spring Initializr</a>ï¼‰é€‰æ‹©éœ€è¦çš„ç»„ä»¶æ¥åˆ›å»ºä¸€ä¸ª Spring Boot å·¥ç¨‹ã€‚æˆ–è€…ï¼Œç›´æ¥åœ¨ pom.xml ä¸­å¼•å…¥æ‰€éœ€è¦çš„ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="é…ç½®æ•°æ®æº"><a href="#é…ç½®æ•°æ®æº" class="headerlink" title="é…ç½®æ•°æ®æº"></a>é…ç½®æ•°æ®æº</h3><p>å¼•å…¥ä¾èµ–åï¼Œéœ€è¦åœ¨ <code>application.properties</code> æˆ– <code>application.yml</code> æ–‡ä»¶ä¸­æŒ‡å®šæ•°æ®æºé…ç½®ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªæœ€åŸºæœ¬çš„æ•°æ®æºé…ç½®ç¤ºä¾‹ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.datasource.url</span> = <span class="string">jdbc:mysql://localhost:3306/spring_tutorial?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf8</span></span><br><span class="line"><span class="attr">spring.datasource.driver-class-name</span> = <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="attr">spring.datasource.username</span> = <span class="string">root</span></span><br><span class="line"><span class="attr">spring.datasource.password</span> = <span class="string">root</span></span><br></pre></td></tr></table></figure>

<p>éœ€è¦æ ¹æ®å®é™…æƒ…å†µï¼Œæ›¿æ¢ <code>url</code>ã€<code>username</code>ã€<code>password</code>ã€‚</p>
<h3 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Slf4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.CommandLineRunner;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.jdbc.core.JdbcTemplate;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SpringBootDataJdbcApplication</span> <span class="keyword">implements</span> <span class="title class_">CommandLineRunner</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> JdbcTemplate jdbcTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">SpringBootDataJdbcApplication</span><span class="params">(JdbcTemplate jdbcTemplate)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.jdbcTemplate = jdbcTemplate;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(SpringBootDataJdbcApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">(String... args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">DataSource</span> <span class="variable">dataSource</span> <span class="operator">=</span> jdbcTemplate.getDataSource();</span><br><span class="line"></span><br><span class="line">        Connection connection;</span><br><span class="line">        <span class="keyword">if</span> (dataSource != <span class="literal">null</span>) &#123;</span><br><span class="line">            connection = dataSource.getConnection();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log.error(<span class="string">&quot;è¿æ¥æ•°æ®æºå¤±è´¥ï¼&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (connection != <span class="literal">null</span>) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;æ•°æ®æº Url: &#123;&#125;&quot;</span>, connection.getMetaData().getURL());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            log.error(<span class="string">&quot;è¿æ¥æ•°æ®æºå¤±è´¥ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œ <code>main</code> æ–¹æ³•åï¼Œæ§åˆ¶å°ä¼šè¾“å‡ºä»¥ä¸‹å†…å®¹ï¼Œè¡¨ç¤ºæ•°æ®æºè¿æ¥æˆåŠŸï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">20</span>:<span class="number">50</span>:<span class="number">18.449</span> <span class="selector-attr">[main]</span> <span class="selector-attr">[INFO ]</span> <span class="selector-tag">i</span><span class="selector-class">.g</span><span class="selector-class">.d</span><span class="selector-class">.s</span><span class="selector-class">.d</span><span class="selector-class">.SpringBootDataJdbcApplication</span><span class="selector-class">.run</span> - æ•°æ®æº Url: jdbc:mysql:<span class="comment">//localhost:3306/spring_tutorial?serverTimezone=UTC&amp;useUnicode=true&amp;characterEncoding=utf8</span></span><br></pre></td></tr></table></figure>

<h2 id="Spring-JDBC"><a href="#Spring-JDBC" class="headerlink" title="Spring JDBC"></a>Spring JDBC</h2><blockquote>
<p>å®Œæ•´ç¤ºä¾‹ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-tutorial/tree/master/codes/data/spring-data-jdbc">spring-data-jdbc</a></p>
</blockquote>
<p>Spring å°†æ•°æ®è®¿é—®çš„æ ·æ¿å¼ä»£ç æå–åˆ°æ¨¡æ¿ç±»ä¸­ã€‚Spring æä¾›äº† 3 ä¸ª JDBC æ¨¡æ¿ç±»ï¼š</p>
<ul>
<li><code>JdbcTemplate</code>ï¼šæœ€åŸºæœ¬çš„ Spring JDBC æ¨¡æ¿ï¼Œè¿™ä¸ªæ¨¡æ¿æ”¯æŒæœ€ç®€å•çš„ JDBC æ•°æ®åº“è®¿é—®åŠŸèƒ½ä»¥åŠç®€å•çš„ç´¢å¼•å‚æ•°æŸ¥è¯¢ã€‚</li>
<li><code>SimpleJdbcTemplate</code>ï¼šæ”¹æ¨¡æ¿ç±»åˆ©ç”¨ Java 5 çš„ä¸€äº›ç‰¹æ€§ï¼Œå¦‚è‡ªåŠ¨è£…ç®±ã€æ³›å‹ä»¥åŠå¯å˜å‚æ•°åˆ—è¡¨æ¥ç®€åŒ– JDBC æ¨¡æ¿çš„ä½¿ç”¨ã€‚</li>
<li><code>NamedParameterJdbcTemplate</code>ï¼šä½¿ç”¨è¯¥æ¨¡æ¿ç±»æ‰§è¡ŒæŸ¥è¯¢æ—¶ï¼Œå¯ä»¥å°†æŸ¥è¯¢å€¼ä»¥å‘½åå‚æ•°çš„å½¢å¼ç»‘å®šåˆ° SQL ä¸­ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç®€å•çš„ç´¢å¼•å‚æ•°ã€‚</li>
</ul>
<h3 id="å¼•å…¥-Spring-ä¾èµ–"><a href="#å¼•å…¥-Spring-ä¾èµ–" class="headerlink" title="å¼•å…¥ Spring ä¾èµ–"></a>å¼•å…¥ Spring ä¾èµ–</h3><p>åœ¨ pom.xml ä¸­å¼•å…¥æ‰€éœ€è¦çš„ä¾èµ–ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context-support<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="åŸºäº-JDBC-é©±åŠ¨çš„æ•°æ®æºé…ç½®"><a href="#åŸºäº-JDBC-é©±åŠ¨çš„æ•°æ®æºé…ç½®" class="headerlink" title="åŸºäº JDBC é©±åŠ¨çš„æ•°æ®æºé…ç½®"></a>åŸºäº JDBC é©±åŠ¨çš„æ•°æ®æºé…ç½®</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ª mysql çš„ JDBC æ•°æ®æºé…ç½®å®ä¾‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:jdbc</span>=<span class="string">&quot;http://www.springframework.org/schema/jdbc&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/jdbc</span></span></span><br><span class="line"><span class="string"><span class="tag">            http://www.springframework.org/schema/jdbc/spring-jdbc.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼•å…¥é…ç½®æ–‡ä»¶ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:properties/mysql.properties&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- ä½¿ç”¨JDBCé©±åŠ¨çš„æ•°æ®æº --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- (1)åœ¨æ¯ä¸ªè¿æ¥è¯·æ±‚æ—¶éƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°å»ºçš„è¿æ¥ã€‚æ€§èƒ½ä¸é«˜ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource1&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- (2)åœ¨æ¯ä¸ªè¿æ¥è¯·æ±‚æ—¶éƒ½ä¼šè¿”å›åŒä¸€ä¸ªè¿æ¥ã€‚ä¸é€‚ç”¨äºå¤šçº¿ç¨‹ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource2&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.SingleConnectionDataSource&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- JDBCæ¨¡æ¿ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;jdbcTemplate&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.core.JdbcTemplate&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;userDao&quot;</span> <span class="attr">class</span>=<span class="string">&quot;io.github.dunwu.springboot.data.jdbc.UserDaoImpl&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">&quot;jdbcTemplate&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- åˆå§‹åŒ–æ•°æ®è¡¨ç»“æ„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jdbc:initialize-database</span> <span class="attr">data-source</span>=<span class="string">&quot;dataSource1&quot;</span> <span class="attr">ignore-failures</span>=<span class="string">&quot;ALL&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbc:script</span> <span class="attr">location</span>=<span class="string">&quot;classpath:sql/schema.sql&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jdbc:script</span> <span class="attr">location</span>=<span class="string">&quot;classpath:sql/data.sql&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">jdbc:initialize-database</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.junit.After;</span><br><span class="line"><span class="keyword">import</span> org.junit.Before;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"><span class="keyword">import</span> org.junit.runner.RunWith;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.ContextConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.test.context.junit4.SpringJUnit4ClassRunner;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings(&quot;all&quot;)</span></span><br><span class="line"><span class="meta">@RunWith(SpringJUnit4ClassRunner.class)</span></span><br><span class="line"><span class="meta">@ContextConfiguration(locations = &#123; &quot;classpath:data/spring-mysql.xml&quot; &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MysqlJdbcTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ApplicationContext ctx;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">before</span><span class="params">()</span> &#123;</span><br><span class="line">        ctx = JdbcDemo.getMysqlApplicationContext();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testExecJdbcOper</span><span class="params">()</span> <span class="keyword">throws</span> SQLException, IOException &#123;</span><br><span class="line">        <span class="type">UserDao</span> <span class="variable">userDao</span> <span class="operator">=</span> (UserDaoImpl) ctx.getBean(<span class="string">&quot;userDao&quot;</span>);</span><br><span class="line">        JdbcDemo.execJdbcOper(userDao);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">after</span><span class="params">()</span> &#123;</span><br><span class="line">        ((ClassPathXmlApplicationContext) ctx).close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="SpringBoot-JDBC-é…ç½®"><a href="#SpringBoot-JDBC-é…ç½®" class="headerlink" title="SpringBoot JDBC é…ç½®"></a>SpringBoot JDBC é…ç½®</h2><h3 id="JdbcTemplateAutoConfiguration-ç±»"><a href="#JdbcTemplateAutoConfiguration-ç±»" class="headerlink" title="JdbcTemplateAutoConfiguration ç±»"></a>JdbcTemplateAutoConfiguration ç±»</h3><p><code>JdbcTemplateAutoConfiguration</code> æ˜¯ <code>JdbcTemplate</code> è‡ªåŠ¨é…ç½®ç±»ï¼Œå®ƒè´Ÿè´£å®ä¾‹åŒ– <code>JdbcTemplate</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="meta">@ConditionalOnClass(&#123; DataSource.class, JdbcTemplate.class &#125;)</span></span><br><span class="line"><span class="meta">@ConditionalOnSingleCandidate(DataSource.class)</span></span><br><span class="line"><span class="meta">@AutoConfigureAfter(DataSourceAutoConfiguration.class)</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(JdbcProperties.class)</span></span><br><span class="line"><span class="meta">@Import(&#123; JdbcTemplateConfiguration.class, NamedParameterJdbcTemplateConfiguration.class &#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JdbcTemplateAutoConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>JdbcTemplateAutoConfiguration</code> ç±»çš„æºç è§£è¯»ï¼š</p>
<ul>
<li><code>@AutoConfigureAfter(DataSourceAutoConfiguration.class)</code> è¡¨æ˜ <code>JdbcTemplateAutoConfiguration</code> å¿…é¡»åœ¨ <code>DataSourceAutoConfiguration</code> æ‰§è¡Œå®Œä¹‹åæ‰å¼€å§‹å·¥ä½œï¼Œè¿™æ„å‘³ç€ï¼š<code>JdbcTemplate</code> çš„åˆå§‹åŒ–å¿…é¡»åœ¨ <code>DataSource</code> åˆå§‹åŒ–ä¹‹åã€‚</li>
<li><code>JdbcProperties</code> æ˜¯ <code>JdbcTemplateAutoConfiguration</code> çš„é…ç½®é€‰é¡¹ç±»ï¼Œå…è®¸ä½¿ç”¨è€…é€šè¿‡è®¾ç½®é€‰é¡¹æ§åˆ¶ <code>JdbcTemplate</code> åˆå§‹åŒ–è¡Œä¸ºã€‚</li>
<li><code>@Import(&#123; JdbcTemplateConfiguration.class, NamedParameterJdbcTemplateConfiguration.class &#125;)</code> è¡¨æ˜å¼•å…¥ <code>JdbcTemplateConfiguration</code>ã€<code>NamedParameterJdbcTemplateConfiguration</code> ä¸¤ä¸ªé…ç½®ç±»ï¼Œå…·ä½“çš„å®ä¾‹åŒ– <code>JdbcTemplate</code> çš„å·¥ä½œä¹Ÿæ˜¯æ”¾åœ¨è¿™ä¸¤ä¸ªé…ç½®ä¸­å®Œæˆã€‚</li>
</ul>
<h3 id="JdbcTemplateConfiguration-ç±»"><a href="#JdbcTemplateConfiguration-ç±»" class="headerlink" title="JdbcTemplateConfiguration ç±»"></a>JdbcTemplateConfiguration ç±»</h3><p><code>JdbcTemplateConfiguration</code> æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(JdbcOperations.class)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">JdbcTemplateConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="meta">@Primary</span></span><br><span class="line">	JdbcTemplate <span class="title function_">jdbcTemplate</span><span class="params">(DataSource dataSource, JdbcProperties properties)</span> &#123;</span><br><span class="line">		<span class="type">JdbcTemplate</span> <span class="variable">jdbcTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JdbcTemplate</span>(dataSource);</span><br><span class="line">		JdbcProperties.<span class="type">Template</span> <span class="variable">template</span> <span class="operator">=</span> properties.getTemplate();</span><br><span class="line">		jdbcTemplate.setFetchSize(template.getFetchSize());</span><br><span class="line">		jdbcTemplate.setMaxRows(template.getMaxRows());</span><br><span class="line">		<span class="keyword">if</span> (template.getQueryTimeout() != <span class="literal">null</span>) &#123;</span><br><span class="line">			jdbcTemplate.setQueryTimeout((<span class="type">int</span>) template.getQueryTimeout().getSeconds());</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> jdbcTemplate;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>JdbcTemplateConfiguration</code> æºç è§£è¯»ï¼š<code>JdbcTemplateConfiguration</code> ä¸­æ ¹æ® <code>DataSource</code> å’Œ <code>JdbcProperties</code> å®ä¾‹åŒ–äº†ä¸€ä¸ª <code>JdbcTemplate</code>ã€‚</p>
<h3 id="NamedParameterJdbcTemplateConfiguration-ç±»"><a href="#NamedParameterJdbcTemplateConfiguration-ç±»" class="headerlink" title="NamedParameterJdbcTemplateConfiguration ç±»"></a>NamedParameterJdbcTemplateConfiguration ç±»</h3><p><code>NamedParameterJdbcTemplateConfiguration</code> æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration(proxyBeanMethods = false)</span></span><br><span class="line"><span class="meta">@ConditionalOnSingleCandidate(JdbcTemplate.class)</span></span><br><span class="line"><span class="meta">@ConditionalOnMissingBean(NamedParameterJdbcOperations.class)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NamedParameterJdbcTemplateConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="meta">@Primary</span></span><br><span class="line">	NamedParameterJdbcTemplate <span class="title function_">namedParameterJdbcTemplate</span><span class="params">(JdbcTemplate jdbcTemplate)</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">NamedParameterJdbcTemplate</span>(jdbcTemplate);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>NamedParameterJdbcTemplateConfiguration</code> æºç è§£è¯»ï¼š<code>NamedParameterJdbcTemplateConfiguration</code> ä¸­æ ¹æ® <code>JdbcTemplate</code> å®ä¾‹åŒ–äº†ä¸€ä¸ª <code>NamedParameterJdbcTemplate</code>ã€‚</p>
<h2 id="spring-data-jdbc"><a href="#spring-data-jdbc" class="headerlink" title="spring-data-jdbc"></a>spring-data-jdbc</h2><p>Spring Data é¡¹ç›®åŒ…å«äº†å¯¹ JDBC çš„å­˜å‚¨åº“æ”¯æŒï¼Œå¹¶å°†è‡ªåŠ¨ä¸º <code>CrudRepository</code> ä¸Šçš„æ–¹æ³•ç”Ÿæˆ SQLã€‚å¯¹äºæ›´é«˜çº§çš„æŸ¥è¯¢ï¼Œæä¾›äº† <code>@Query</code> æ³¨è§£ã€‚</p>
<p>å½“ classpath ä¸Šå­˜åœ¨å¿…è¦çš„ä¾èµ–é¡¹æ—¶ï¼ŒSpring Boot å°†è‡ªåŠ¨é…ç½® Spring Data çš„ JDBC å­˜å‚¨åº“ã€‚å®ƒä»¬å¯ä»¥é€šè¿‡ <code>spring-boot-starter-data-jdbc</code> çš„å•ä¸€ä¾èµ–é¡¹æ·»åŠ åˆ°é¡¹ç›®ä¸­ã€‚å¦‚æœ‰å¿…è¦ï¼Œå¯ä»¥é€šè¿‡å°† <code>@EnableJdbcRepositories</code> æ‰¹æ³¨æˆ– <code>JdbcConfiguration</code> å­ç±»æ·»åŠ åˆ°åº”ç”¨ç¨‹åºæ¥æ§åˆ¶ Spring Data JDBC çš„é…ç½®ã€‚</p>
<blockquote>
<p>æ›´å¤š Spring Data JDBC ç»†èŠ‚ï¼Œå¯ä»¥å‚è€ƒ <a target="_blank" rel="noopener" href="http://spring.io/projects/spring-data-jdbc">Spring Data JDBC å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
</blockquote>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://spring.io/">Spring å®˜ç½‘</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-framework/docs/current/spring-framework-reference/index.html">Spring Framework å®˜æ–¹æ–‡æ¡£</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/html/data.html">Spring Boot å®˜æ–¹æ–‡æ¡£</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/0fb992/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/0fb992/" class="post-title-link" itemprop="url">SpringBoot ä¹‹å±æ€§åŠ è½½è¯¦è§£</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-10 11:55:54" itemprop="dateCreated datePublished" datetime="2019-01-10T11:55:54+08:00">2019-01-10</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/Spring%E6%A0%B8%E5%BF%83/" itemprop="url" rel="index"><span itemprop="name">Springæ ¸å¿ƒ</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>6.7k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>6 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SpringBoot-ä¹‹å±æ€§åŠ è½½è¯¦è§£"><a href="#SpringBoot-ä¹‹å±æ€§åŠ è½½è¯¦è§£" class="headerlink" title="SpringBoot ä¹‹å±æ€§åŠ è½½è¯¦è§£"></a>SpringBoot ä¹‹å±æ€§åŠ è½½è¯¦è§£</h1><h2 id="åŠ è½½-property-é¡ºåº"><a href="#åŠ è½½-property-é¡ºåº" class="headerlink" title="åŠ è½½ property é¡ºåº"></a>åŠ è½½ property é¡ºåº</h2><p>Spring Boot åŠ è½½ property é¡ºåºå¦‚ä¸‹ï¼š</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#using-boot-devtools-globalsettings">Devtools å…¨å±€é…ç½®</a> (å½“ devtools è¢«æ¿€æ´» <code>~/.spring-boot-devtools.properties</code>).</li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/test/context/TestPropertySource.html">æµ‹è¯•ç¯å¢ƒä¸­çš„ <code>@TestPropertySource</code> æ³¨è§£é…ç½®</a></li>
<li>æµ‹è¯•ç¯å¢ƒä¸­çš„å±æ€§ <code>properties</code>ï¼š<a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/test/context/SpringBootTest.html"><code>@SpringBootTest</code></a> å’Œ <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-testing-spring-boot-applications-testing-autoconfigured-tests">æµ‹è¯•æ³¨è§£</a>.</li>
<li>å‘½ä»¤è¡Œå‚æ•°</li>
<li><code>SPRING_APPLICATION_JSON</code> å±æ€§</li>
<li><code>ServletConfig</code> åˆå§‹åŒ–å‚æ•°</li>
<li><code>ServletContext</code> åˆå§‹åŒ–å‚æ•°</li>
<li>JNDI attributes from é€šè¿‡ <code>java:comp/env</code> é…ç½®çš„ JNDI å±æ€§</li>
<li>Java ç³»ç»Ÿå±æ€§ (<code>System.getProperties()</code>)</li>
<li>æ“ä½œç³»ç»Ÿç¯å¢ƒæ¯”é‚£é‡Œ</li>
<li><code>RandomValuePropertySource</code> åŠ è½½ <code>random.*</code> å½¢å¼çš„å±æ€§</li>
<li>jar åŒ…å¤–çš„ <code>application-&#123;profile&#125;.properties</code> æˆ– <code>application-&#123;profile&#125;.yml</code> é…ç½®</li>
<li>jar åŒ…å†…çš„ <code>application-&#123;profile&#125;.properties</code> æˆ– <code>application-&#123;profile&#125;.yml</code> é…ç½®</li>
<li>jar åŒ…å¤–çš„ <code>application.properties</code> æˆ– <code>application.yml</code> é…ç½®</li>
<li>jar åŒ…å†…çš„ <code>application.properties</code> æˆ– <code>application.yml</code> é…ç½®</li>
<li><code>@PropertySource</code> ç»‘å®šçš„é…ç½®</li>
<li>é»˜è®¤å±æ€§ (é€šè¿‡ <code>SpringApplication.setDefaultProperties</code> æŒ‡å®š)</li>
</ol>
<h2 id="éšæœºå±æ€§"><a href="#éšæœºå±æ€§" class="headerlink" title="éšæœºå±æ€§"></a>éšæœºå±æ€§</h2><p><code>RandomValuePropertySource</code> ç±»ç”¨äºé…ç½®éšæœºå€¼ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">my.secret</span>=<span class="string">$&#123;random.value&#125;</span></span><br><span class="line"><span class="attr">my.number</span>=<span class="string">$&#123;random.int&#125;</span></span><br><span class="line"><span class="attr">my.bignumber</span>=<span class="string">$&#123;random.long&#125;</span></span><br><span class="line"><span class="attr">my.uuid</span>=<span class="string">$&#123;random.uuid&#125;</span></span><br><span class="line"><span class="attr">my.number.less.than.ten</span>=<span class="string">$&#123;random.int(10)&#125;</span></span><br><span class="line"><span class="attr">my.number.in.range</span>=<span class="string">$&#123;random.int[1024,65536]&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="å‘½ä»¤è¡Œå±æ€§"><a href="#å‘½ä»¤è¡Œå±æ€§" class="headerlink" title="å‘½ä»¤è¡Œå±æ€§"></a>å‘½ä»¤è¡Œå±æ€§</h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ <code>SpringApplication</code> ä¼šè·å– <code>--</code> å‚æ•°ï¼ˆä¾‹å¦‚ <code>--server.port=9000</code> ï¼‰ï¼Œå¹¶å°†è¿™ä¸ª <code>property</code> æ·»åŠ åˆ° Spring çš„ <code>Environment</code> ä¸­ã€‚</p>
<p>å¦‚æœä¸æƒ³åŠ è½½å‘½ä»¤è¡Œå±æ€§ï¼Œå¯ä»¥é€šè¿‡ <code>SpringApplication.setAddCommandLineProperties(false)</code> ç¦ç”¨ã€‚</p>
<h2 id="Application-å±æ€§æ–‡ä»¶"><a href="#Application-å±æ€§æ–‡ä»¶" class="headerlink" title="Application å±æ€§æ–‡ä»¶"></a>Application å±æ€§æ–‡ä»¶</h2><p><code>SpringApplication</code> ä¼šè‡ªåŠ¨åŠ è½½ä»¥ä¸‹è·¯å¾„ä¸‹çš„ <code>application.properties</code> é…ç½®æ–‡ä»¶ï¼Œå°†å…¶ä¸­çš„å±æ€§è¯»åˆ° Spring çš„ <code>Environment</code> ä¸­ã€‚</p>
<ol>
<li>å½“å‰ç›®å½•çš„ <code>/config</code> å­ç›®å½•</li>
<li>å½“å‰ç›®å½•</li>
<li>classpath è·¯å¾„ä¸‹çš„ <code>/config</code> package</li>
<li>classpath æ ¹è·¯å¾„</li>
</ol>
<blockquote>
<p>æ³¨ï¼š</p>
<p>ä»¥ä¸Šåˆ—è¡¨çš„é…ç½®æ–‡ä»¶ä¼šæ ¹æ®é¡ºåºï¼Œååºçš„é…ç½®ä¼šè¦†ç›–å‰åºçš„é…ç½®ã€‚</p>
<p>ä½ å¯ä»¥é€‰æ‹© <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config-yaml">YAML(yml)</a> é…ç½®æ–‡ä»¶æ›¿æ¢ properties é…ç½®æ–‡ä»¶ã€‚</p>
</blockquote>
<p>å¦‚æœä¸å–œæ¬¢ <code>application.properties</code> ä½œä¸ºé…ç½®æ–‡ä»¶åï¼Œå¯ä»¥ä½¿ç”¨ <code>spring.config.name</code> ç¯å¢ƒå˜é‡æ›¿æ¢ï¼š</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">java </span>-<span class="keyword">jar </span>myproject.<span class="keyword">jar </span>--spring.config.name=myproject</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥ä½¿ç”¨ <code>spring.config.location</code> ç¯å¢ƒå˜é‡æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">$</span> <span class="string">java -jar myproject.jar --spring.config.location=classpath:/default.properties,classpath:/override.properties</span></span><br></pre></td></tr></table></figure>

<h2 id="Profile-ç‰¹å®šå±æ€§"><a href="#Profile-ç‰¹å®šå±æ€§" class="headerlink" title="Profile ç‰¹å®šå±æ€§"></a>Profile ç‰¹å®šå±æ€§</h2><p>å¦‚æœå®šä¹‰ <code>application-&#123;profile&#125;.properties</code> å½¢å¼çš„é…ç½®æ–‡ä»¶ï¼Œå°†è¢«è§†ä¸º <code>profile</code> ç¯å¢ƒä¸‹çš„ç‰¹å®šé…ç½®ã€‚</p>
<p>å¯ä»¥é€šè¿‡ <code>spring.profiles.active</code> å‚æ•°æ¥æ¿€æ´» profileï¼Œå¦‚æœæ²¡æœ‰æ¿€æ´»çš„ profile,é»˜è®¤ä¼šåŠ è½½ <code>application-default.properties</code> ä¸­çš„é…ç½®ã€‚</p>
<h2 id="å±æ€§ä¸­çš„å ä½ç¬¦"><a href="#å±æ€§ä¸­çš„å ä½ç¬¦" class="headerlink" title="å±æ€§ä¸­çš„å ä½ç¬¦"></a>å±æ€§ä¸­çš„å ä½ç¬¦</h2><p><code>application.properties</code> ä¸­çš„å€¼ä¼šè¢« <code>Environment</code> è¿‡æ»¤ï¼Œæ‰€ä»¥ï¼Œå¯ä»¥å¼•ç”¨ä¹‹å‰å®šä¹‰çš„å±æ€§ã€‚</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">app.name</span>=MyApp</span><br><span class="line"><span class="attr">app.description</span>=<span class="variable">$&#123;app.name&#125;</span> is a Spring Boot application</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨ï¼šä½ å¯ä»¥ä½¿ç”¨æ­¤æŠ€æœ¯æ¥åˆ›å»º Spring Boot å±æ€§å˜é‡ã€‚è¯·å‚è€ƒï¼š <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-use-short-command-line-arguments">Section 77.4, â€œUse â€˜Shortâ€™ Command Line Arguments</a></p>
</blockquote>
<h2 id="YAML-å±æ€§"><a href="#YAML-å±æ€§" class="headerlink" title="YAML å±æ€§"></a>YAML å±æ€§</h2><p>Spring æ¡†æ¶æœ‰ä¸¤ä¸ªç±»æ”¯æŒåŠ è½½ YAML æ–‡ä»¶ã€‚</p>
<ul>
<li><code>YamlPropertiesFactoryBean</code> å°† YAML æ–‡ä»¶çš„é…ç½®åŠ è½½ä¸º <code>Properties</code> ã€‚</li>
<li><code>YamlMapFactoryBean</code> å°† YAML æ–‡ä»¶çš„é…ç½®åŠ è½½ä¸º <code>Map</code> ã€‚</li>
</ul>
<p>ç¤ºä¾‹ 1</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">environments:</span></span><br><span class="line">	<span class="attr">dev:</span></span><br><span class="line">		<span class="attr">url:</span> <span class="string">http://dev.example.com</span></span><br><span class="line">		<span class="attr">name:</span> <span class="string">Developer</span> <span class="string">Setup</span></span><br><span class="line">	<span class="attr">prod:</span></span><br><span class="line">		<span class="attr">url:</span> <span class="string">http://another.example.com</span></span><br><span class="line">		<span class="attr">name:</span> <span class="string">My</span> <span class="string">Cool</span> <span class="string">App</span></span><br></pre></td></tr></table></figure>

<p>ç­‰ä»·äºï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">environments.dev.url</span>=<span class="string">http://dev.example.com</span></span><br><span class="line"><span class="attr">environments.dev.name</span>=<span class="string">Developer Setup</span></span><br><span class="line"><span class="attr">environments.prod.url</span>=<span class="string">http://another.example.com</span></span><br><span class="line"><span class="attr">environments.prod.name</span>=<span class="string">My Cool App</span></span><br></pre></td></tr></table></figure>

<p>YAML æ”¯æŒåˆ—è¡¨å½¢å¼ï¼Œç­‰ä»·äº property ä¸­çš„ <code>[index]</code> ï¼š</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">my:</span></span><br><span class="line"><span class="attr">servers:</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">dev.example.com</span></span><br><span class="line">	<span class="bullet">-</span> <span class="string">another.example.com</span></span><br></pre></td></tr></table></figure>

<p>ç­‰ä»·äº</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">my.servers[0]</span>=<span class="string">dev.example.com</span></span><br><span class="line"><span class="attr">my.servers[1]</span>=<span class="string">another.example.com</span></span><br></pre></td></tr></table></figure>

<h3 id="è®¿é—®å±æ€§"><a href="#è®¿é—®å±æ€§" class="headerlink" title="è®¿é—®å±æ€§"></a>è®¿é—®å±æ€§</h3><p><code>YamlPropertySourceLoader</code> ç±»ä¼šå°† YAML é…ç½®è½¬åŒ–ä¸º Spring <code>Environment</code> ç±»ä¸­çš„ <code>PropertySource</code> ã€‚ç„¶åï¼Œä½ å¯ä»¥å¦‚åŒ properties æ–‡ä»¶ä¸­çš„å±æ€§ä¸€æ ·ï¼Œä½¿ç”¨ <code>@Value</code> æ³¨è§£æ¥è®¿é—® YAML ä¸­é…ç½®çš„å±æ€§ã€‚</p>
<h3 id="å¤š-profile-é…ç½®"><a href="#å¤š-profile-é…ç½®" class="headerlink" title="å¤š profile é…ç½®"></a>å¤š profile é…ç½®</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">address:</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.100</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">development</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">address:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span> <span class="string">production</span> <span class="string">&amp;</span> <span class="string">eu-central</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">address:</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.120</span></span><br></pre></td></tr></table></figure>

<h3 id="YAML-çš„ç¼ºç‚¹"><a href="#YAML-çš„ç¼ºç‚¹" class="headerlink" title="YAML çš„ç¼ºç‚¹"></a>YAML çš„ç¼ºç‚¹</h3><p>æ³¨ï¼šYAML æ³¨è§£ä¸­çš„å±æ€§ä¸èƒ½é€šè¿‡ <code>@PropertySource</code> æ³¨è§£æ¥è®¿é—®ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨äº†ä¸€äº›è‡ªå®šä¹‰å±æ€§æ–‡ä»¶ï¼Œå»ºè®®ä¸è¦ç”¨ YAMLã€‚</p>
<h2 id="å±æ€§å‰ç¼€"><a href="#å±æ€§å‰ç¼€" class="headerlink" title="å±æ€§å‰ç¼€"></a>å±æ€§å‰ç¼€</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.net.InetAddress;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Collections;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix=&quot;acme&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AcmeProperties</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="type">boolean</span> enabled;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> InetAddress remoteAddress;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Security</span> <span class="variable">security</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Security</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEnabled</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setEnabled</span><span class="params">(<span class="type">boolean</span> enabled)</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> InetAddress <span class="title function_">getRemoteAddress</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRemoteAddress</span><span class="params">(InetAddress remoteAddress)</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Security <span class="title function_">getSecurity</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Security</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">private</span> String username;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">private</span> String password;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">private</span> List&lt;String&gt; roles = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;(Collections.singleton(<span class="string">&quot;USER&quot;</span>));</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> String <span class="title function_">getUsername</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setUsername</span><span class="params">(String username)</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> String <span class="title function_">getPassword</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setPassword</span><span class="params">(String password)</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> List&lt;String&gt; <span class="title function_">getRoles</span><span class="params">()</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setRoles</span><span class="params">(List&lt;String&gt; roles)</span> &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç›¸å½“äºæ”¯æŒé…ç½®ä»¥ä¸‹å±æ€§ï¼š</p>
<ul>
<li><code>acme.enabled</code></li>
<li><code>acme.remote-address</code></li>
<li><code>acme.security.username</code></li>
<li><code>acme.security.password</code></li>
<li><code>acme.security.roles</code></li>
</ul>
<p>ç„¶åï¼Œä½ éœ€è¦ä½¿ç”¨ <code>@EnableConfigurationProperties</code> æ³¨è§£å°†å±æ€§ç±»æ³¨å…¥é…ç½®ç±»ä¸­ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableConfigurationProperties(AcmeProperties.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyConfiguration</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å±æ€§æ¾æ•£ç»‘å®šè§„åˆ™"><a href="#å±æ€§æ¾æ•£ç»‘å®šè§„åˆ™" class="headerlink" title="å±æ€§æ¾æ•£ç»‘å®šè§„åˆ™"></a>å±æ€§æ¾æ•£ç»‘å®šè§„åˆ™</h2><p>Spring Boot å±æ€§åç»‘å®šæ¯”è¾ƒæ¾æ•£ã€‚</p>
<p>ä»¥ä¸‹å±æ€§ key éƒ½æ˜¯ç­‰ä»·çš„ï¼š</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Note</th>
</tr>
</thead>
<tbody><tr>
<td><code>acme.my-project.person.first-name</code></td>
<td><code>-</code> åˆ†éš”</td>
</tr>
<tr>
<td><code>acme.myProject.person.firstName</code></td>
<td>é©¼å³°å‘½å</td>
</tr>
<tr>
<td><code>acme.my_project.person.first_name</code></td>
<td><code>_</code> åˆ†éš”</td>
</tr>
<tr>
<td><code>ACME_MYPROJECT_PERSON_FIRSTNAME</code></td>
<td>å¤§å†™å­—æ¯</td>
</tr>
</tbody></table>
<h2 id="å±æ€§è½¬æ¢"><a href="#å±æ€§è½¬æ¢" class="headerlink" title="å±æ€§è½¬æ¢"></a>å±æ€§è½¬æ¢</h2><p>å¦‚æœéœ€è¦ç±»å‹è½¬æ¢ï¼Œä½ å¯ä»¥æä¾›ä¸€ä¸ª <code>ConversionService</code> bean (ä¸€ä¸ªåå« <code>conversionService</code> çš„ bean) æˆ–è‡ªå®šä¹‰å±æ€§é…ç½® (ä¸€ä¸ª <code>CustomEditorConfigurer</code> bean) æˆ–è‡ªå®šä¹‰çš„ <code>Converters</code> (è¢« <code>@ConfigurationPropertiesBinding</code> æ³¨è§£ä¿®é¥°çš„ bena)ã€‚</p>
<h3 id="æ—¶é—´å•ä½è½¬æ¢"><a href="#æ—¶é—´å•ä½è½¬æ¢" class="headerlink" title="æ—¶é—´å•ä½è½¬æ¢"></a>æ—¶é—´å•ä½è½¬æ¢</h3><p>Spring ä½¿ç”¨ <code>java.time.Duration</code> ç±»ä»£è¡¨æ—¶é—´å¤§å°ï¼Œä»¥ä¸‹åœºæ™¯é€‚ç”¨ï¼š</p>
<ul>
<li>é™¤éæŒ‡å®š <code>@DurationUnit</code> ï¼Œå¦åˆ™ä¸€ä¸ª long ä»£è¡¨çš„æ—¶é—´ä¸ºæ¯«ç§’ã€‚</li>
<li>ISO-8601 æ ‡å‡†æ ¼å¼ï¼ˆ <a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api//java/time/Duration.html#parse-java.lang.CharSequence-"><code>java.time.Duration</code></a> çš„å®ç°å°±æ˜¯å‚ç…§æ­¤æ ‡å‡†ï¼‰</li>
<li>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ”¯æŒçš„å•ä½ï¼š<ul>
<li><code>ns</code> - çº³ç§’</li>
<li><code>us</code> - å¾®ç§’</li>
<li><code>ms</code> - æ¯«ç§’</li>
<li><code>s</code> - ç§’</li>
<li><code>m</code> - åˆ†</li>
<li><code>h</code> - æ—¶</li>
<li><code>d</code> - å¤©</li>
</ul>
</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(&quot;app.system&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppSystemProperties</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@DurationUnit(ChronoUnit.SECONDS)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">Duration</span> <span class="variable">sessionTimeout</span> <span class="operator">=</span> Duration.ofSeconds(<span class="number">30</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="type">Duration</span> <span class="variable">readTimeout</span> <span class="operator">=</span> Duration.ofMillis(<span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Duration <span class="title function_">getSessionTimeout</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.sessionTimeout;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSessionTimeout</span><span class="params">(Duration sessionTimeout)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.sessionTimeout = sessionTimeout;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> Duration <span class="title function_">getReadTimeout</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.readTimeout;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setReadTimeout</span><span class="params">(Duration readTimeout)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.readTimeout = readTimeout;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ•°æ®å¤§å°è½¬æ¢"><a href="#æ•°æ®å¤§å°è½¬æ¢" class="headerlink" title="æ•°æ®å¤§å°è½¬æ¢"></a>æ•°æ®å¤§å°è½¬æ¢</h3><p>Spring ä½¿ç”¨ <code>DataSize</code> ç±»ä»£è¡¨æ•°æ®å¤§å°ï¼Œä»¥ä¸‹åœºæ™¯é€‚ç”¨ï¼š</p>
<ul>
<li>long å€¼ï¼ˆé»˜è®¤è§†ä¸º byteï¼‰</li>
<li>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä»¥ä¸‹æ”¯æŒçš„å•ä½ï¼š<ul>
<li><code>B</code></li>
<li><code>KB</code></li>
<li><code>MB</code></li>
<li><code>GB</code></li>
<li><code>TB</code></li>
</ul>
</li>
</ul>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(&quot;app.io&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AppIoProperties</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@DataSizeUnit(DataUnit.MEGABYTES)</span></span><br><span class="line">	<span class="keyword">private</span> <span class="type">DataSize</span> <span class="variable">bufferSize</span> <span class="operator">=</span> DataSize.ofMegabytes(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="type">DataSize</span> <span class="variable">sizeThreshold</span> <span class="operator">=</span> DataSize.ofBytes(<span class="number">512</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> DataSize <span class="title function_">getBufferSize</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.bufferSize;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setBufferSize</span><span class="params">(DataSize bufferSize)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.bufferSize = bufferSize;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> DataSize <span class="title function_">getSizeThreshold</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">this</span>.sizeThreshold;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setSizeThreshold</span><span class="params">(DataSize sizeThreshold)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.sizeThreshold = sizeThreshold;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ ¡éªŒå±æ€§"><a href="#æ ¡éªŒå±æ€§" class="headerlink" title="æ ¡éªŒå±æ€§"></a>æ ¡éªŒå±æ€§</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ConfigurationProperties(prefix=&quot;acme&quot;)</span></span><br><span class="line"><span class="meta">@Validated</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AcmeProperties</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@NotNull</span></span><br><span class="line">	<span class="keyword">private</span> InetAddress remoteAddress;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Valid</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Security</span> <span class="variable">security</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Security</span>();</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ... getters and setters</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Security</span> &#123;</span><br><span class="line"></span><br><span class="line">		<span class="meta">@NotEmpty</span></span><br><span class="line">		<span class="keyword">public</span> String username;</span><br><span class="line"></span><br><span class="line">		<span class="comment">// ... getters and setters</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªåä¸º <code>configurationPropertiesValidator</code> çš„æ ¡éªŒå™¨ Beanã€‚è·å–è¿™ä¸ª <code>@Bean</code> çš„æ–¹æ³•å¿…é¡»å£°æ˜ä¸º <code>static</code>ã€‚</p>
<h2 id="ç¤ºä¾‹æºç "><a href="#ç¤ºä¾‹æºç " class="headerlink" title="ç¤ºä¾‹æºç "></a>ç¤ºä¾‹æºç </h2><blockquote>
<p>ç¤ºä¾‹æºç ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-boot-tutorial/tree/master/codes/spring-boot-property">spring-boot-property</a></p>
</blockquote>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-external-config">Spring Boot å®˜æ–¹æ–‡æ¡£ä¹‹ boot-features-external-config</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/ad0516/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/ad0516/" class="post-title-link" itemprop="url">SpringBoot ä¹‹åº”ç”¨ EasyUI</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2019-01-08 17:19:34" itemprop="dateCreated datePublished" datetime="2019-01-08T17:19:34+08:00">2019-01-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/SpringWeb/" itemprop="url" rel="index"><span itemprop="name">SpringWeb</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>11k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>10 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SpringBoot-ä¹‹åº”ç”¨-EasyUI"><a href="#SpringBoot-ä¹‹åº”ç”¨-EasyUI" class="headerlink" title="SpringBoot ä¹‹åº”ç”¨ EasyUI"></a>SpringBoot ä¹‹åº”ç”¨ EasyUI</h1><blockquote>
<p>EasyUI æ˜¯ä¸€ä¸ªç®€å•çš„ç”¨æˆ·ç•Œé¢ç»„ä»¶çš„é›†åˆã€‚ç”±äº EasyUI å·²ç»å°è£…å¥½å¤§éƒ¨åˆ† UI åŸºæœ¬åŠŸèƒ½ï¼Œèƒ½å¸®ç”¨æˆ·å‡å°‘å¤§é‡çš„ js å’Œ css ä»£ç ã€‚æ‰€ä»¥ï¼ŒEasyUI éå¸¸é€‚åˆç”¨äºå¼€å‘ç®€å•çš„ç³»ç»Ÿæˆ–åŸå‹ç³»ç»Ÿã€‚</p>
<p>æœ¬æ–‡ç¤ºä¾‹ä½¿ç”¨æŠ€æœ¯ç‚¹ï¼š</p>
<ul>
<li>Spring Bootï¼šä¸»è¦ä½¿ç”¨äº† spring-boot-starter-webã€spring-boot-starter-data-jpa</li>
<li>EasyUIï¼šæŒ‰éœ€åŠ è½½ï¼Œå¹¶æ²¡æœ‰å¼•å…¥æ‰€æœ‰çš„ EasyUI ç‰¹æ€§</li>
<li>æ•°æ®åº“ï¼šä¸ºäº†æµ‹è¯•æ–¹ä¾¿ï¼Œä½¿ç”¨ H2</li>
</ul>
</blockquote>
<p><img src="http://www.jeasyui.cn/images/easyui.png" alt="img"></p>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><h3 id="ä»€ä¹ˆæ˜¯-EasyUIï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯-EasyUIï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯ EasyUIï¼Ÿ"></a>ä»€ä¹ˆæ˜¯ EasyUIï¼Ÿ</h3><ul>
<li>easyui æ˜¯åŸºäº jQueryã€Angular.ã€Vue å’Œ React çš„ç”¨æˆ·ç•Œé¢ç»„ä»¶çš„é›†åˆã€‚</li>
<li>easyui æä¾›äº†æ„å»ºç°ä»£äº¤äº’å¼ javascript åº”ç”¨ç¨‹åºçš„åŸºæœ¬åŠŸèƒ½ã€‚</li>
<li>ä½¿ç”¨ easyuiï¼Œæ‚¨ä¸éœ€è¦ç¼–å†™è®¸å¤š javascript ä»£ç ï¼Œé€šå¸¸é€šè¿‡ç¼–å†™ä¸€äº› HTML æ ‡è®°æ¥å®šä¹‰ç”¨æˆ·ç•Œé¢ã€‚</li>
<li>å®Œæ•´çš„ HTML5 ç½‘é¡µæ¡†æ¶ã€‚</li>
<li>ä½¿ç”¨ easyui å¼€å‘ä½ çš„äº§å“æ—¶å¯ä»¥å¤§é‡èŠ‚çœä½ çš„æ—¶é—´å’Œè§„æ¨¡ã€‚</li>
<li>easyui ä½¿ç”¨éå¸¸ç®€å•ä½†åŠŸèƒ½éå¸¸å¼ºå¤§ã€‚</li>
</ul>
<h2 id="Spring-Boot-æ•´åˆ-EasyUI"><a href="#Spring-Boot-æ•´åˆ-EasyUI" class="headerlink" title="Spring Boot æ•´åˆ EasyUI"></a>Spring Boot æ•´åˆ EasyUI</h2><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>application.properties ä¿®æ”¹ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.mvc.view.prefix</span> = <span class="string">/views/</span></span><br><span class="line"><span class="attr">spring.mvc.view.suffix</span> = <span class="string">.html</span></span><br></pre></td></tr></table></figure>

<h3 id="å¼•å…¥-easyui"><a href="#å¼•å…¥-easyui" class="headerlink" title="å¼•å…¥ easyui"></a>å¼•å…¥ easyui</h3><p>EasyUI ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="http://www.jeasyui.cn/download.html">http://www.jeasyui.cn/download.html</a></p>
<p>åœ¨ <code>src/main/resources/static</code> ç›®å½•ä¸‹å¼•å…¥ easyuiã€‚</p>
<p>ç„¶ååœ¨ html ä¸­å¼•ç”¨ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">&quot;../lib/easyui/themes/bootstrap/easyui.css&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">&quot;../lib/easyui/themes/icon.css&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">&quot;../lib/easyui/themes/color.css&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;../lib/easyui/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">&quot;../lib/easyui/jquery.easyui.min.js&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">&quot;../lib/easyui/locale/easyui-lang-zh_CN.js&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- çœç•¥ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¼•å…¥ easyui åï¼Œéœ€è¦ä½¿ç”¨å“ªç§ç»„ä»¶ï¼Œå¯ä»¥æŸ¥çœ‹ç›¸å…³æ–‡æ¡£æˆ– APIï¼Œååˆ†ç®€å•ï¼Œæ­¤å¤„ä¸ä¸€ä¸€èµ˜è¿°ã€‚</p>
<h2 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h2><h3 id="å¼•å…¥-maven-ä¾èµ–"><a href="#å¼•å…¥-maven-ä¾èµ–" class="headerlink" title="å¼•å…¥ maven ä¾èµ–"></a>å¼•å…¥ maven ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-jpa<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-tomcat<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.h2database<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>h2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-JPA"><a href="#ä½¿ç”¨-JPA" class="headerlink" title="ä½¿ç”¨ JPA"></a>ä½¿ç”¨ JPA</h3><p>ä¸ºäº†ä½¿ç”¨ JPA æŠ€æœ¯è®¿é—®æ•°æ®ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ Entity å’Œ Repository</p>
<p>å®šä¹‰ä¸€ä¸ª Entityï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue(strategy = GenerationType.AUTO)</span></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String firstName;</span><br><span class="line">    <span class="keyword">private</span> String lastName;</span><br><span class="line">    <span class="keyword">private</span> String phone;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="title function_">User</span><span class="params">()</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String firstName, String lastName, String phone, String email)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.firstName = firstName;</span><br><span class="line">        <span class="built_in">this</span>.lastName = lastName;</span><br><span class="line">        <span class="built_in">this</span>.phone = phone;</span><br><span class="line">        <span class="built_in">this</span>.email = email;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç•¥ getter/setter</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®šä¹‰ä¸€ä¸ª Repositoryï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="symbol">UserRepository</span> <span class="symbol">extends</span> <span class="symbol">CrudRepository</span>&lt;<span class="symbol">User</span>, <span class="symbol">Long</span>&gt; &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;User&gt; findByLastName(String lastName);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-Web"><a href="#ä½¿ç”¨-Web" class="headerlink" title="ä½¿ç”¨ Web"></a>ä½¿ç”¨ Web</h3><p>é¦–é¡µ Controllerï¼Œå°† web è¯·æ±‚å®šå‘åˆ°æŒ‡å®šé¡µé¢ï¼ˆä¸‹é¢çš„ä¾‹å­å®šå‘åˆ° index.htmlï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">IndexController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &#123;&quot;&quot;, &quot;/&quot;, &quot;index&quot;&#125;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">index</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;index&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤å¤–ï¼Œéœ€è¦å®šä¹‰ä¸€ä¸ª Controllerï¼Œæä¾›åå°çš„ API æ¥å£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserRepository customerRepository;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user&quot;, method = RequestMethod.GET)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">user</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;user&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user/list&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseDTO&lt;User&gt; <span class="title function_">list</span><span class="params">()</span> &#123;</span><br><span class="line">        Iterable&lt;User&gt; all = customerRepository.findAll();</span><br><span class="line">        List&lt;User&gt; list = IteratorUtils.toList(all.iterator());</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseDTO</span>&lt;&gt;(<span class="literal">true</span>, list.size(), list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user/add&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseDTO&lt;User&gt; <span class="title function_">add</span><span class="params">(User user)</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">result</span> <span class="operator">=</span> customerRepository.save(user);</span><br><span class="line">        List&lt;User&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(result);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseDTO</span>&lt;&gt;(<span class="literal">true</span>, <span class="number">1</span>, list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user/save&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseDTO&lt;User&gt; <span class="title function_">save</span><span class="params">(<span class="meta">@RequestParam(&quot;id&quot;)</span> Long id, User user)</span> &#123;</span><br><span class="line">        user.setId(id);</span><br><span class="line">        customerRepository.save(user);</span><br><span class="line">        List&lt;User&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        list.add(user);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseDTO</span>&lt;&gt;(<span class="literal">true</span>, <span class="number">1</span>, list);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ResponseBody</span></span><br><span class="line">    <span class="meta">@RequestMapping(value = &quot;/user/delete&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> ResponseDTO <span class="title function_">delete</span><span class="params">(<span class="meta">@RequestParam(&quot;id&quot;)</span> Long id)</span> &#123;</span><br><span class="line">        customerRepository.deleteById(id);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ResponseDTO</span>&lt;&gt;(<span class="literal">true</span>, <span class="literal">null</span>, <span class="literal">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨-EasyUI"><a href="#ä½¿ç”¨-EasyUI" class="headerlink" title="ä½¿ç”¨ EasyUI"></a>ä½¿ç”¨ EasyUI</h3><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨å‰é¢å®šä¹‰çš„åå°æ¥å£ï¼Œä»…éœ€è¦åœ¨ EasyUI API ä¸­æŒ‡å®š <code>url</code> å³å¯ã€‚</p>
<p>è¯·ç•™æ„ä¸‹é¢ç¤ºä¾‹ä¸­çš„ url å­—æ®µï¼Œå’Œå®é™…æ¥å£æ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Complex Layout - jQuery EasyUI Demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">&quot;../lib/easyui/themes/bootstrap/easyui.css&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">&quot;../lib/easyui/themes/icon.css&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span></span></span><br><span class="line"><span class="tag">      <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">href</span>=<span class="string">&quot;../lib/easyui/themes/color.css&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;../lib/easyui/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">&quot;../lib/easyui/jquery.easyui.min.js&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">      <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">&quot;../lib/easyui/locale/easyui-lang-zh_CN.js&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-family</span>: microsoft yahei;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;width:100%&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h2</span>&gt;</span>åŸºæœ¬çš„ CRUD åº”ç”¨<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>æ•°æ®æ¥æºäºåå°ç³»ç»Ÿ<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">table</span></span></span><br><span class="line"><span class="tag">        <span class="attr">id</span>=<span class="string">&quot;dg&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">title</span>=<span class="string">&quot;Custom List&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;easyui-datagrid&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">url</span>=<span class="string">&quot;/user/list&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">toolbar</span>=<span class="string">&quot;#toolbar&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">pagination</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">rownumbers</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">fitColumns</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">singleSelect</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">field</span>=<span class="string">&quot;id&quot;</span> <span class="attr">width</span>=<span class="string">&quot;50&quot;</span>&gt;</span>ID<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">field</span>=<span class="string">&quot;firstName&quot;</span> <span class="attr">width</span>=<span class="string">&quot;50&quot;</span>&gt;</span>First Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">field</span>=<span class="string">&quot;lastName&quot;</span> <span class="attr">width</span>=<span class="string">&quot;50&quot;</span>&gt;</span>Last Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">field</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">width</span>=<span class="string">&quot;50&quot;</span>&gt;</span>Phone<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span> <span class="attr">field</span>=<span class="string">&quot;email&quot;</span> <span class="attr">width</span>=<span class="string">&quot;50&quot;</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;toolbar&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">          <span class="attr">href</span>=<span class="string">&quot;javascript:void(0)&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;easyui-linkbutton&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">iconCls</span>=<span class="string">&quot;icon-add&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">plain</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">onclick</span>=<span class="string">&quot;newUser()&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>æ·»åŠ &lt;/a</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">          <span class="attr">href</span>=<span class="string">&quot;javascript:void(0)&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;easyui-linkbutton&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">iconCls</span>=<span class="string">&quot;icon-edit&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">plain</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">onclick</span>=<span class="string">&quot;editUser()&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>ä¿®æ”¹&lt;/a</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">          <span class="attr">href</span>=<span class="string">&quot;javascript:void(0)&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;easyui-linkbutton&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">iconCls</span>=<span class="string">&quot;icon-remove&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">plain</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">onclick</span>=<span class="string">&quot;destroyUser()&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>åˆ é™¤&lt;/a</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">        <span class="attr">id</span>=<span class="string">&quot;dlg&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;easyui-dialog&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width:400px&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-options</span>=<span class="string">&quot;closed:true,modal:true,border:&#x27;thin&#x27;,buttons:&#x27;#dlg-buttons&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span></span></span><br><span class="line"><span class="tag">          <span class="attr">id</span>=<span class="string">&quot;fm&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">method</span>=<span class="string">&quot;post&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">novalidate</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;margin:0;padding:20px 50px&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">h3</span>&gt;</span>User Information<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom:10px&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">name</span>=<span class="string">&quot;firstName&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;easyui-textbox&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">required</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">label</span>=<span class="string">&quot;First Name:&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">style</span>=<span class="string">&quot;width:100%&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom:10px&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">name</span>=<span class="string">&quot;lastName&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;easyui-textbox&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">required</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">label</span>=<span class="string">&quot;Last Name:&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">style</span>=<span class="string">&quot;width:100%&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom:10px&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">name</span>=<span class="string">&quot;phone&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;easyui-textbox&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">required</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">label</span>=<span class="string">&quot;Phone:&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">style</span>=<span class="string">&quot;width:100%&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom:10px&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">name</span>=<span class="string">&quot;email&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;easyui-textbox&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">required</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">validType</span>=<span class="string">&quot;email&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">label</span>=<span class="string">&quot;Email:&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">style</span>=<span class="string">&quot;width:100%&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;dlg-buttons&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">          <span class="attr">href</span>=<span class="string">&quot;javascript:void(0)&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;easyui-linkbutton c6&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">iconCls</span>=<span class="string">&quot;icon-ok&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">onclick</span>=<span class="string">&quot;saveUser()&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width:90px&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>Save&lt;/a</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">          <span class="attr">href</span>=<span class="string">&quot;javascript:void(0)&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;easyui-linkbutton&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">iconCls</span>=<span class="string">&quot;icon-cancel&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">onclick</span>=<span class="string">&quot;javascript:$(&#x27;#dlg&#x27;).dialog(&#x27;close&#x27;)&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width:90px&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>Cancel&lt;/a</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> url</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">newUser</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&#x27;#dlg&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">dialog</span>(<span class="string">&#x27;open&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">dialog</span>(<span class="string">&#x27;center&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">dialog</span>(<span class="string">&#x27;setTitle&#x27;</span>, <span class="string">&#x27;New User&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&#x27;#fm&#x27;</span>).<span class="title function_">form</span>(<span class="string">&#x27;clear&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        url = <span class="string">&#x27;/user/add&#x27;</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">editUser</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> row = $(<span class="string">&#x27;#dg&#x27;</span>).<span class="title function_">datagrid</span>(<span class="string">&#x27;getSelected&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (row) &#123;</span></span><br><span class="line"><span class="language-javascript">          $(<span class="string">&#x27;#dlg&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">dialog</span>(<span class="string">&#x27;open&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">dialog</span>(<span class="string">&#x27;center&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">dialog</span>(<span class="string">&#x27;setTitle&#x27;</span>, <span class="string">&#x27;Edit User&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">          $(<span class="string">&#x27;#fm&#x27;</span>).<span class="title function_">form</span>(<span class="string">&#x27;load&#x27;</span>, row)</span></span><br><span class="line"><span class="language-javascript">          url = <span class="string">&#x27;/user/save&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">saveUser</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        $(<span class="string">&#x27;#fm&#x27;</span>).<span class="title function_">form</span>(<span class="string">&#x27;submit&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">url</span>: url,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">onSubmit</span>: <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> $(<span class="variable language_">this</span>).<span class="title function_">form</span>(<span class="string">&#x27;validate&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">success</span>: <span class="keyword">function</span>(<span class="params">result</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> result = <span class="built_in">eval</span>(<span class="string">&#x27;(&#x27;</span> + result + <span class="string">&#x27;)&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (result.<span class="property">errorMsg</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              $.messager.<span class="title function_">show</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">title</span>: <span class="string">&#x27;Error&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">msg</span>: result.<span class="property">errorMsg</span></span></span><br><span class="line"><span class="language-javascript">              &#125;)</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              $(<span class="string">&#x27;#dlg&#x27;</span>).<span class="title function_">dialog</span>(<span class="string">&#x27;close&#x27;</span>) <span class="comment">// close the dialog</span></span></span><br><span class="line"><span class="language-javascript">              $(<span class="string">&#x27;#dg&#x27;</span>).<span class="title function_">datagrid</span>(<span class="string">&#x27;reload&#x27;</span>) <span class="comment">// reload the user data</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">function</span> <span class="title function_">destroyUser</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> row = $(<span class="string">&#x27;#dg&#x27;</span>).<span class="title function_">datagrid</span>(<span class="string">&#x27;getSelected&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (row) &#123;</span></span><br><span class="line"><span class="language-javascript">          $.messager.<span class="title function_">confirm</span>(</span></span><br><span class="line"><span class="language-javascript">            <span class="string">&#x27;Confirm&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">&#x27;Are you sure you want to destroy this user?&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">function</span>(<span class="params">r</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">if</span> (r) &#123;</span></span><br><span class="line"><span class="language-javascript">                $.<span class="title function_">post</span>(</span></span><br><span class="line"><span class="language-javascript">                  <span class="string">&#x27;/user/delete&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                  &#123; <span class="attr">id</span>: row.<span class="property">id</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">                  <span class="keyword">function</span>(<span class="params">result</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (result.<span class="property">success</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                      $(<span class="string">&#x27;#dg&#x27;</span>).<span class="title function_">datagrid</span>(<span class="string">&#x27;reload&#x27;</span>) <span class="comment">// reload the user data</span></span></span><br><span class="line"><span class="language-javascript">                    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                      $.messager.<span class="title function_">show</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// show error message</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">title</span>: <span class="string">&#x27;Error&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                        <span class="attr">msg</span>: result.<span class="property">errorMsg</span></span></span><br><span class="line"><span class="language-javascript">                      &#125;)</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                  &#125;,</span></span><br><span class="line"><span class="language-javascript">                  <span class="string">&#x27;json&#x27;</span></span></span><br><span class="line"><span class="language-javascript">                )</span></span><br><span class="line"><span class="language-javascript">              &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          )</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="å®Œæ•´ç¤ºä¾‹"><a href="#å®Œæ•´ç¤ºä¾‹" class="headerlink" title="å®Œæ•´ç¤ºä¾‹"></a>å®Œæ•´ç¤ºä¾‹</h2><p>è¯·å‚è€ƒ <a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-boot-tutorial/tree/master/codes/spring-boot-web-ui/spring-boot-web-ui-easyui">æºç </a></p>
<p>è¿è¡Œæ–¹å¼ï¼š</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mvn clean <span class="keyword">package</span> -DskipTests=<span class="keyword">true</span></span><br><span class="line">java -jar <span class="keyword">target</span>/</span><br></pre></td></tr></table></figure>

<p>åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š<a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080/</a></p>
<h2 id="å¼•ç”¨å’Œå¼•ç”³"><a href="#å¼•ç”¨å’Œå¼•ç”³" class="headerlink" title="å¼•ç”¨å’Œå¼•ç”³"></a>å¼•ç”¨å’Œå¼•ç”³</h2><ul>
<li><a target="_blank" rel="noopener" href="http://www.jeasyui.com/">EasyUI å®˜ç½‘</a></li>
<li><a target="_blank" rel="noopener" href="http://www.jeasyui.cn/">EasyUI ä¸­æ–‡ç½‘</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/676725/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/676725/" class="post-title-link" itemprop="url">SpringBoot ä¹‹é›†æˆ Json</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-12-30 22:24:16" itemprop="dateCreated datePublished" datetime="2018-12-30T22:24:16+08:00">2018-12-30</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/SpringIO/" itemprop="url" rel="index"><span itemprop="name">SpringIO</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>8.7k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>8 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SpringBoot-ä¹‹é›†æˆ-Json"><a href="#SpringBoot-ä¹‹é›†æˆ-Json" class="headerlink" title="SpringBoot ä¹‹é›†æˆ Json"></a>SpringBoot ä¹‹é›†æˆ Json</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><h3 id="Spring-Boot-æ”¯æŒçš„-Json-åº“"><a href="#Spring-Boot-æ”¯æŒçš„-Json-åº“" class="headerlink" title="Spring Boot æ”¯æŒçš„ Json åº“"></a>Spring Boot æ”¯æŒçš„ Json åº“</h3><p>Spring Boot æ”¯æŒä¸‰ç§ Json åº“ï¼š</p>
<ul>
<li>Gson</li>
<li>Jackson</li>
<li>JSON-B</li>
</ul>
<p><strong>Jackson æ˜¯ Spring Boot å®˜æ–¹æ¨èçš„é»˜è®¤åº“ã€‚</strong></p>
<p>Spring Boot æä¾›äº† Jackson çš„è‡ªåŠ¨é…ç½®ï¼ŒJackson æ˜¯ <code>spring-boot-starter-json</code> çš„ä¸€éƒ¨åˆ†ã€‚å½“ Jackson åœ¨ç±»è·¯å¾„ä¸Šæ—¶ï¼Œä¼šè‡ªåŠ¨é…ç½® ObjectMapper beanã€‚</p>
<p>Spring Boot æä¾›äº† Gson çš„è‡ªåŠ¨é…ç½®ã€‚å½“ Gson åœ¨ classpath ä¸Šæ—¶ï¼Œä¼šè‡ªåŠ¨é…ç½® Gson beanã€‚æä¾›äº†å‡ ä¸ª <code>spring.gson.*</code> é…ç½®å±æ€§æ¥è‡ªå®šä¹‰é…ç½®ã€‚ä¸ºäº†è·å¾—æ›´å¤šæ§åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ª <code>GsonBuilderCustomizer</code> beanã€‚</p>
<p>Spring Boot æä¾›äº† JSON-B çš„è‡ªåŠ¨é…ç½®ã€‚å½“ JSON-B API åœ¨ classpath ä¸Šæ—¶ï¼Œå°†è‡ªåŠ¨é…ç½® Jsonb beanã€‚é¦–é€‰çš„ JSON-B å®ç°æ˜¯ Apache Johnzonï¼Œå®ƒæä¾›äº†ä¾èµ–å…³ç³»ç®¡ç†ã€‚</p>
<h3 id="Spring-Web-ä¸­çš„åºåˆ—åŒ–ã€ååºåˆ—åŒ–"><a href="#Spring-Web-ä¸­çš„åºåˆ—åŒ–ã€ååºåˆ—åŒ–" class="headerlink" title="Spring Web ä¸­çš„åºåˆ—åŒ–ã€ååºåˆ—åŒ–"></a>Spring Web ä¸­çš„åºåˆ—åŒ–ã€ååºåˆ—åŒ–</h3><p>ä»¥ä¸‹æ³¨è§£éƒ½æ˜¯ <code>spring-web</code> ä¸­æä¾›çš„æ”¯æŒã€‚</p>
<h4 id="ResponseBody"><a href="#ResponseBody" class="headerlink" title="@ResponseBody"></a><code>@ResponseBody</code></h4><p><code>@Responsebody</code> æ³¨è§£ç”¨äºå°† Controller çš„æ–¹æ³•è¿”å›çš„å¯¹è±¡ï¼Œé€šè¿‡é€‚å½“çš„ <code>HttpMessageConverter</code> è½¬æ¢ä¸ºæŒ‡å®šæ ¼å¼åï¼Œå†™å…¥åˆ° HTTP Response å¯¹è±¡çš„ body æ•°æ®åŒºã€‚ä¸€èˆ¬åœ¨å¼‚æ­¥è·å–æ•°æ®æ—¶ä½¿ç”¨ã€‚é€šå¸¸æ˜¯åœ¨ä½¿ç”¨ <code>@RequestMapping</code> åï¼Œè¿”å›å€¼é€šå¸¸è§£æä¸ºè·³è½¬è·¯å¾„ï¼ŒåŠ ä¸Š @Responsebody åè¿”å›ç»“æœä¸ä¼šè¢«è§£æä¸ºè·³è½¬è·¯å¾„ï¼Œè€Œæ˜¯ç›´æ¥å†™å…¥ HTTP å“åº”æ­£æ–‡ä¸­ã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="meta">@RequestMapping(name = &quot;/getInfo&quot;, method = RequestMethod.GET)</span></span><br><span class="line"><span class="keyword">public</span> InfoDTO <span class="title function_">getInfo</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">InfoDTO</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="RequestBody"><a href="#RequestBody" class="headerlink" title="@RequestBody"></a><code>@RequestBody</code></h4><p>@RequestBody æ³¨è§£ç”¨äºè¯»å– HTTP Request è¯·æ±‚çš„ body éƒ¨åˆ†æ•°æ®ï¼Œä½¿ç”¨ç³»ç»Ÿé»˜è®¤é…ç½®çš„ <code>HttpMessageConverter</code> è¿›è¡Œè§£æï¼Œç„¶åæŠŠç›¸åº”çš„æ•°æ®ç»‘å®šåˆ°è¦è¿”å›çš„å¯¹è±¡ä¸Šï¼›å†æŠŠ <code>HttpMessageConverter</code> è¿”å›çš„å¯¹è±¡æ•°æ®ç»‘å®šåˆ° controller ä¸­æ–¹æ³•çš„å‚æ•°ä¸Šã€‚</p>
<p>request çš„ body éƒ¨åˆ†çš„æ•°æ®ç¼–ç æ ¼å¼ç”± header éƒ¨åˆ†çš„ <code>Content-Type</code> æŒ‡å®šã€‚</p>
<p>ç¤ºä¾‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping(name = &quot;/postInfo&quot;, method = RequestMethod.POST)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postInfo</span><span class="params">(<span class="meta">@RequestBody</span> InfoDTO infoDTO)</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="RestController"><a href="#RestController" class="headerlink" title="@RestController"></a><code>@RestController</code></h4><p>Spring 4 ä»¥å‰ï¼š</p>
<p>å¦‚æœéœ€è¦è¿”å›åˆ°æŒ‡å®šé¡µé¢ï¼Œåˆ™éœ€è¦ç”¨ <code>@Controller</code> é…åˆè§†å›¾è§£æå™¨ <code>InternalResourceViewResolver</code> ã€‚</p>
<p>å¦‚æœéœ€è¦è¿”å› JSONï¼ŒXML æˆ–è‡ªå®šä¹‰ mediaType å†…å®¹åˆ°é¡µé¢ï¼Œåˆ™éœ€è¦åœ¨å¯¹åº”çš„æ–¹æ³•ä¸ŠåŠ ä¸Š <code>@ResponseBody</code> æ³¨è§£ã€‚</p>
<p>Spring 4 ä»¥åï¼Œæ–°å¢äº† <code>@RestController</code> æ³¨è§£ï¼š</p>
<p>å®ƒç›¸å½“äº <code>@Controller</code> + <code>@RequestBody</code> ã€‚</p>
<p>å¦‚æœä½¿ç”¨ <code>@RestController</code> æ³¨è§£ Controllerï¼Œåˆ™ Controller ä¸­çš„æ–¹æ³•æ— æ³•è¿”å› jsp é¡µé¢ï¼Œæˆ–è€… htmlï¼Œé…ç½®çš„è§†å›¾è§£æå™¨ <code>InternalResourceViewResolver</code> å°†ä¸èµ·ä½œç”¨ï¼Œç›´æ¥è¿”å›å†…å®¹ã€‚</p>
<h2 id="æŒ‡å®šç±»çš„-Json-åºåˆ—åŒ–ã€ååºåˆ—åŒ–"><a href="#æŒ‡å®šç±»çš„-Json-åºåˆ—åŒ–ã€ååºåˆ—åŒ–" class="headerlink" title="æŒ‡å®šç±»çš„ Json åºåˆ—åŒ–ã€ååºåˆ—åŒ–"></a>æŒ‡å®šç±»çš„ Json åºåˆ—åŒ–ã€ååºåˆ—åŒ–</h2><p>å¦‚æœä½¿ç”¨ Jackson åºåˆ—åŒ–å’Œååºåˆ—åŒ– JSON æ•°æ®ï¼Œæ‚¨å¯èƒ½éœ€è¦ç¼–å†™è‡ªå·±çš„ <code>JsonSerializer</code> å’Œ <code>JsonDeserializer</code> ç±»ã€‚è‡ªå®šä¹‰åºåˆ—åŒ–ç¨‹åºé€šå¸¸é€šè¿‡æ¨¡å—å‘ Jackson æ³¨å†Œï¼Œä½† Spring Boot æä¾›äº†å¦ä¸€ç§ <code>@JsonComponent</code> æ³¨é‡Šï¼Œå¯ä»¥æ›´å®¹æ˜“åœ°ç›´æ¥æ³¨å†Œ Spring Beansã€‚</p>
<p>æ‚¨å¯ä»¥ç›´æ¥åœ¨ <code>JsonSerializer</code> æˆ– <code>JsonDeserializer</code> å®ç°ä¸Šä½¿ç”¨ <code>@JsonComponent</code> æ³¨é‡Šã€‚æ‚¨è¿˜å¯ä»¥åœ¨åŒ…å«åºåˆ—åŒ–ç¨‹åº&#x2F;ååºåˆ—åŒ–ç¨‹åºä½œä¸ºå†…éƒ¨ç±»çš„ç±»ä¸Šä½¿ç”¨å®ƒï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.core.*;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.*;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.jackson.*;</span><br><span class="line"></span><br><span class="line"><span class="meta">@JsonComponent</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Example</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Serializer</span> <span class="keyword">extends</span> <span class="title class_">JsonSerializer</span>&lt;SomeObject&gt; &#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Deserializer</span> <span class="keyword">extends</span> <span class="title class_">JsonDeserializer</span>&lt;SomeObject&gt; &#123;</span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>ApplicationContext</code> ä¸­çš„æ‰€æœ‰ <code>@JsonComponent</code> bean éƒ½ä¼šè‡ªåŠ¨æ³¨å†Œåˆ° Jacksonã€‚å› ä¸º <code>@JsonComponent</code> æ˜¯ä½¿ç”¨ <code>@Component</code> è¿›è¡Œå…ƒæ³¨é‡Šçš„ï¼Œæ‰€ä»¥é€šå¸¸çš„ç»„ä»¶æ‰«æè§„åˆ™é€‚ç”¨ã€‚</p>
<p>Spring Boot è¿˜æä¾›äº† <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.1.RELEASE/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jackson/JsonObjectSerializer.java"><code>JsonObjectSerializer</code></a> å’Œ <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.1.RELEASE/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/jackson/JsonObjectDeserializer.java"><code>JsonObjectDeserializer</code></a> åŸºç±»ï¼Œå®ƒä»¬åœ¨åºåˆ—åŒ–å¯¹è±¡æ—¶æä¾›äº†æ ‡å‡† Jackson ç‰ˆæœ¬çš„æœ‰ç”¨æ›¿ä»£æ–¹æ³•ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… Javadoc ä¸­çš„ <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/jackson/JsonObjectSerializer.html"><code>JsonObjectSerializer</code></a> å’Œ <a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/jackson/JsonObjectDeserializer.html"><code>JsonObjectDeserializer</code></a>ã€‚</p>
<h2 id="JsonTest"><a href="#JsonTest" class="headerlink" title="@JsonTest"></a>@JsonTest</h2><p>ä½¿ç”¨ <code>@JsonTest</code> å¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ Spring Boot ä¸­æµ‹è¯•åºåˆ—åŒ–ã€ååºåˆ—åŒ–ã€‚</p>
<p>ä½¿ç”¨ <code>@JsonTest</code> ç›¸å½“äºä½¿ç”¨ä»¥ä¸‹è‡ªåŠ¨é…ç½®ï¼š</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">org<span class="selector-class">.springframework</span><span class="selector-class">.boot</span><span class="selector-class">.autoconfigure</span><span class="selector-class">.cache</span><span class="selector-class">.CacheAutoConfiguration</span> org<span class="selector-class">.springframework</span><span class="selector-class">.boot</span><span class="selector-class">.autoconfigure</span><span class="selector-class">.gson</span><span class="selector-class">.GsonAutoConfiguration</span> org<span class="selector-class">.springframework</span><span class="selector-class">.boot</span><span class="selector-class">.autoconfigure</span><span class="selector-class">.jackson</span><span class="selector-class">.JacksonAutoConfiguration</span> org<span class="selector-class">.springframework</span><span class="selector-class">.boot</span><span class="selector-class">.autoconfigure</span><span class="selector-class">.jsonb</span><span class="selector-class">.JsonbAutoConfiguration</span> org<span class="selector-class">.springframework</span><span class="selector-class">.boot</span><span class="selector-class">.test</span><span class="selector-class">.autoconfigure</span><span class="selector-class">.json</span>.JsonTestersAutoConfiguration</span><br></pre></td></tr></table></figure>

<p><code>@JsonTest</code> ä½¿ç”¨ç¤ºä¾‹ï¼š</p>
<p>æƒ³è¯•è¯•å®Œæ•´ç¤ºä¾‹ï¼Œå¯ä»¥å‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-boot-tutorial/tree/master/codes/spring-boot-web-fastjson">æºç </a></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@JsonTest</span></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SimpleJsonTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="built_in">this</span>.getClass());</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> JacksonTester&lt;InfoDTO&gt; json;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testSerialize</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">sdf</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>);</span><br><span class="line">        <span class="type">InfoDTO</span> <span class="variable">infoDTO</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">InfoDTO</span>(<span class="string">&quot;JSONæµ‹è¯•åº”ç”¨&quot;</span>, <span class="string">&quot;1.0.0&quot;</span>, sdf.parse(<span class="string">&quot;2019-01-01 12:00:00&quot;</span>));</span><br><span class="line">        JsonContent&lt;InfoDTO&gt; jsonContent = json.write(infoDTO);</span><br><span class="line">        log.info(<span class="string">&quot;json content: &#123;&#125;&quot;</span>, jsonContent.getJson());</span><br><span class="line">        <span class="comment">// æˆ–è€…ä½¿ç”¨åŸºäºJSON pathçš„æ ¡éªŒ</span></span><br><span class="line">        assertThat(jsonContent).hasJsonPathStringValue(<span class="string">&quot;@.appName&quot;</span>);</span><br><span class="line">        assertThat(jsonContent).extractingJsonPathStringValue(<span class="string">&quot;@.appName&quot;</span>).isEqualTo(<span class="string">&quot;JSONæµ‹è¯•åº”ç”¨&quot;</span>);</span><br><span class="line">        assertThat(jsonContent).hasJsonPathStringValue(<span class="string">&quot;@.version&quot;</span>);</span><br><span class="line">        assertThat(jsonContent).extractingJsonPathStringValue(<span class="string">&quot;@.version&quot;</span>).isEqualTo(<span class="string">&quot;1.0.0&quot;</span>);</span><br><span class="line">        assertThat(jsonContent).hasJsonPathStringValue(<span class="string">&quot;@.date&quot;</span>);</span><br><span class="line">        assertThat(jsonContent).extractingJsonPathStringValue(<span class="string">&quot;@.date&quot;</span>).isEqualTo(<span class="string">&quot;2019-01-01 12:00:00&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testDeserialize</span><span class="params">()</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">content</span> <span class="operator">=</span> <span class="string">&quot;&#123;\&quot;appName\&quot;:\&quot;JSONæµ‹è¯•åº”ç”¨\&quot;,\&quot;version\&quot;:\&quot;1.0.0\&quot;,\&quot;date\&quot;:\&quot;2019-01-01\&quot;&#125;&quot;</span>;</span><br><span class="line">        <span class="type">InfoDTO</span> <span class="variable">actual</span> <span class="operator">=</span> json.parseObject(content);</span><br><span class="line">        assertThat(actual.getAppName()).isEqualTo(<span class="string">&quot;JSONæµ‹è¯•åº”ç”¨&quot;</span>);</span><br><span class="line">        assertThat(actual.getVersion()).isEqualTo(<span class="string">&quot;1.0.0&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Spring-Boot-ä¸­çš„-json-é…ç½®"><a href="#Spring-Boot-ä¸­çš„-json-é…ç½®" class="headerlink" title="Spring Boot ä¸­çš„ json é…ç½®"></a>Spring Boot ä¸­çš„ json é…ç½®</h2><h3 id="Jackson-é…ç½®"><a href="#Jackson-é…ç½®" class="headerlink" title="Jackson é…ç½®"></a>Jackson é…ç½®</h3><p>å½“ Spring Boot çš„ json åº“ä¸º jackson æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®å±æ€§ï¼ˆå¯¹åº” <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.1.RELEASE/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jackson/JacksonProperties.java"><code>JacksonProperties</code></a> ç±»ï¼‰ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.jackson.date-format</span>= <span class="string"># Date format string or a fully-qualified date format class name. For instance, `yyyy-MM-dd HH:mm:ss`.</span></span><br><span class="line"><span class="attr">spring.jackson.default-property-inclusion</span>= <span class="string"># Controls the inclusion of properties during serialization. Configured with one of the values in Jackson&#x27;s JsonInclude.Include enumeration.</span></span><br><span class="line"><span class="attr">spring.jackson.deserialization.*</span>= <span class="string"># Jackson on/off features that affect the way Java objects are deserialized.</span></span><br><span class="line"><span class="attr">spring.jackson.generator.*</span>= <span class="string"># Jackson on/off features for generators.</span></span><br><span class="line"><span class="attr">spring.jackson.joda-date-time-format</span>= <span class="string"># Joda date time format string. If not configured, &quot;date-format&quot; is used as a fallback if it is configured with a format string.</span></span><br><span class="line"><span class="attr">spring.jackson.locale</span>= <span class="string"># Locale used for formatting.</span></span><br><span class="line"><span class="attr">spring.jackson.mapper.*</span>= <span class="string"># Jackson general purpose on/off features.</span></span><br><span class="line"><span class="attr">spring.jackson.parser.*</span>= <span class="string"># Jackson on/off features for parsers.</span></span><br><span class="line"><span class="attr">spring.jackson.property-naming-strategy</span>= <span class="string"># One of the constants on Jackson&#x27;s PropertyNamingStrategy. Can also be a fully-qualified class name of a PropertyNamingStrategy subclass.</span></span><br><span class="line"><span class="attr">spring.jackson.serialization.*</span>= <span class="string"># Jackson on/off features that affect the way Java objects are serialized.</span></span><br><span class="line"><span class="attr">spring.jackson.time-zone</span>= <span class="string">#  Time zone used when formatting dates. For instance, &quot;America/Los_Angeles&quot; or &quot;GMT+10&quot;.</span></span><br><span class="line"><span class="attr">spring.jackson.visibility.*</span>= <span class="string"># Jackson visibility thresholds that can be used to limit which methods (and fields) are auto-detected.</span></span><br></pre></td></tr></table></figure>

<h3 id="GSON-é…ç½®"><a href="#GSON-é…ç½®" class="headerlink" title="GSON é…ç½®"></a>GSON é…ç½®</h3><p>å½“ Spring Boot çš„ json åº“ä¸º gson æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®å±æ€§ï¼ˆå¯¹åº” <a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.1.RELEASE/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/gson/GsonProperties.java"><code>GsonProperties</code></a> ç±»ï¼‰ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.gson.date-format</span>= <span class="string"># Format to use when serializing Date objects.</span></span><br><span class="line"><span class="attr">spring.gson.disable-html-escaping</span>= <span class="string"># Whether to disable the escaping of HTML characters such as &#x27;&lt;&#x27;, &#x27;&gt;&#x27;, etc.</span></span><br><span class="line"><span class="attr">spring.gson.disable-inner-class-serialization</span>= <span class="string"># Whether to exclude inner classes during serialization.</span></span><br><span class="line"><span class="attr">spring.gson.enable-complex-map-key-serialization</span>= <span class="string"># Whether to enable serialization of complex map keys (i.e. non-primitives).</span></span><br><span class="line"><span class="attr">spring.gson.exclude-fields-without-expose-annotation</span>= <span class="string"># Whether to exclude all fields from consideration for serialization or deserialization that do not have the &quot;Expose&quot; annotation.</span></span><br><span class="line"><span class="attr">spring.gson.field-naming-policy</span>= <span class="string"># Naming policy that should be applied to an object&#x27;s field during serialization and deserialization.</span></span><br><span class="line"><span class="attr">spring.gson.generate-non-executable-json</span>= <span class="string"># Whether to generate non executable JSON by prefixing the output with some special text.</span></span><br><span class="line"><span class="attr">spring.gson.lenient</span>= <span class="string"># Whether to be lenient about parsing JSON that doesn&#x27;t conform to RFC 4627.</span></span><br><span class="line"><span class="attr">spring.gson.long-serialization-policy</span>= <span class="string"># Serialization policy for Long and long types.</span></span><br><span class="line"><span class="attr">spring.gson.pretty-printing</span>= <span class="string"># Whether to output serialized JSON that fits in a page for pretty printing.</span></span><br><span class="line"><span class="attr">spring.gson.serialize-nulls</span>= <span class="string"># Whether to serialize null fields.</span></span><br></pre></td></tr></table></figure>

<h2 id="Spring-Boot-ä¸­ä½¿ç”¨-Fastjson"><a href="#Spring-Boot-ä¸­ä½¿ç”¨-Fastjson" class="headerlink" title="Spring Boot ä¸­ä½¿ç”¨ Fastjson"></a>Spring Boot ä¸­ä½¿ç”¨ Fastjson</h2><p>å›½å†…å¾ˆå¤šçš„ Java ç¨‹åºå‘˜æ›´å–œæ¬¢ä½¿ç”¨é˜¿é‡Œçš„ fastjson ä½œä¸º json libã€‚é‚£ä¹ˆï¼Œå¦‚ä½•åœ¨ Spring Boot ä¸­å°†å…¶æ›¿æ¢é»˜è®¤çš„ jackson åº“å‘¢ï¼Ÿ</p>
<p>ä½ éœ€è¦åšå¦‚ä¸‹å¤„ç†ï¼š</p>
<p>ï¼ˆ1ï¼‰å¼•å…¥ fastjson jar åŒ…ï¼š</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.54<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>ï¼ˆ2ï¼‰å®ç° WebMvcConfigurer æ¥å£ï¼Œè‡ªå®šä¹‰ <code>configureMessageConverters</code> æ¥å£ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">log</span> <span class="operator">=</span> LoggerFactory.getLogger(<span class="built_in">this</span>.getClass());</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è‡ªå®šä¹‰æ¶ˆæ¯è½¬æ¢å™¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> converters</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">configureMessageConverters</span><span class="params">(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters)</span> &#123;</span><br><span class="line">        <span class="comment">// æ¸…é™¤é»˜è®¤ Json è½¬æ¢å™¨</span></span><br><span class="line">        converters.removeIf(converter -&gt; converter <span class="keyword">instanceof</span> MappingJackson2HttpMessageConverter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é…ç½® FastJson</span></span><br><span class="line">        <span class="type">FastJsonConfig</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FastJsonConfig</span>();</span><br><span class="line">        config.setSerializerFeatures(SerializerFeature.QuoteFieldNames, SerializerFeature.WriteEnumUsingToString,</span><br><span class="line">            SerializerFeature.WriteMapNullValue, SerializerFeature.WriteDateUseDateFormat,</span><br><span class="line">            SerializerFeature.DisableCircularReferenceDetect);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ·»åŠ  FastJsonHttpMessageConverter</span></span><br><span class="line">        <span class="type">FastJsonHttpMessageConverter</span> <span class="variable">fastJsonHttpMessageConverter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FastJsonHttpMessageConverter</span>();</span><br><span class="line">        fastJsonHttpMessageConverter.setFastJsonConfig(config);</span><br><span class="line">        List&lt;MediaType&gt; fastMediaTypes = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        fastMediaTypes.add(MediaType.APPLICATION_JSON_UTF8);</span><br><span class="line">        fastJsonHttpMessageConverter.setSupportedMediaTypes(fastMediaTypes);</span><br><span class="line">        converters.add(fastJsonHttpMessageConverter);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ·»åŠ  StringHttpMessageConverterï¼Œè§£å†³ä¸­æ–‡ä¹±ç é—®é¢˜</span></span><br><span class="line">        <span class="type">StringHttpMessageConverter</span> <span class="variable">stringHttpMessageConverter</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringHttpMessageConverter</span>(Charset.forName(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        converters.add(stringHttpMessageConverter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç¤ºä¾‹æºç "><a href="#ç¤ºä¾‹æºç " class="headerlink" title="ç¤ºä¾‹æºç "></a>ç¤ºä¾‹æºç </h2><p>å®Œæ•´ç¤ºä¾‹ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-boot-tutorial/tree/master/codes/spring-boot-web-fastjson">æºç </a></p>
<h2 id="å¼•ç”³å’Œå¼•ç”¨"><a href="#å¼•ç”³å’Œå¼•ç”¨" class="headerlink" title="å¼•ç”³å’Œå¼•ç”¨"></a>å¼•ç”³å’Œå¼•ç”¨</h2><p><strong>å¼•ç”³</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-boot-tutorial">Spring Boot æ•™ç¨‹</a></li>
</ul>
<p><strong>å¼•ç”¨</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-json">Spring Boot å®˜æ–¹æ–‡æ¡£ä¹‹ boot-features-json</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/fac14c/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/fac14c/" class="post-title-link" itemprop="url">SpringBoot ä¹‹é›†æˆ Elasticsearch</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-12-25 14:06:36" itemprop="dateCreated datePublished" datetime="2018-12-25T14:06:36+08:00">2018-12-25</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/Spring%E6%95%B0%E6%8D%AE/" itemprop="url" rel="index"><span itemprop="name">Springæ•°æ®</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>2.1k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>2 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SpringBoot-ä¹‹é›†æˆ-Elasticsearch"><a href="#SpringBoot-ä¹‹é›†æˆ-Elasticsearch" class="headerlink" title="SpringBoot ä¹‹é›†æˆ Elasticsearch"></a>SpringBoot ä¹‹é›†æˆ Elasticsearch</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p><a target="_blank" rel="noopener" href="https://www.elastic.co/products/elasticsearch">Elasticsearch</a> æ˜¯ä¸€ä¸ªå¼€æºçš„ã€åˆ†å¸ƒå¼çš„æœç´¢å’Œåˆ†æå¼•æ“ã€‚</p>
<h3 id="é€šè¿‡-REST-å®¢æˆ·ç«¯è¿æ¥-Elasticsearch"><a href="#é€šè¿‡-REST-å®¢æˆ·ç«¯è¿æ¥-Elasticsearch" class="headerlink" title="é€šè¿‡ REST å®¢æˆ·ç«¯è¿æ¥ Elasticsearch"></a>é€šè¿‡ REST å®¢æˆ·ç«¯è¿æ¥ Elasticsearch</h3><p>å¦‚æœåœ¨ classpath è·¯å¾„ä¸‹å­˜åœ¨ <code>org.elasticsearch.client:elasticsearch-rest-client</code> jar åŒ…ï¼ŒSpring Boot ä¼šè‡ªåŠ¨é…ç½®å¹¶æ³¨å†Œä¸€ä¸ª <code>RestClient</code> Beanï¼Œå®ƒçš„é»˜è®¤è®¿é—®è·¯å¾„ä¸ºï¼š<code>localhost:9200</code>ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨å¦‚ä¸‹æ–¹å¼è¿›è¡Œå®šåˆ¶ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.elasticsearch.rest.uris</span>=<span class="string">http://search.example.com:9200</span></span><br><span class="line"><span class="attr">spring.elasticsearch.rest.username</span>=<span class="string">user</span></span><br><span class="line"><span class="attr">spring.elasticsearch.rest.password</span>=<span class="string">secret</span></span><br></pre></td></tr></table></figure>

<p>æ‚¨è¿˜å¯ä»¥æ³¨å†Œå®ç°ä»»æ„æ•°é‡çš„ <code>RestClientBuilderCustomizer</code> beanï¼Œä»¥è¿›è¡Œæ›´é«˜çº§çš„å®šåˆ¶ã€‚è¦å®Œå…¨æ§åˆ¶æ³¨å†Œï¼Œè¯·å®šä¹‰ <code>RestClient</code> beanã€‚</p>
<p>å¦‚æœ classpath è·¯å¾„æœ‰ <code>org.elasticsearch.clientï¼šelasticsearch-rest-high-level-client</code> jar åŒ…ï¼ŒSpring Boot å°†è‡ªåŠ¨é…ç½®ä¸€ä¸ª <code>RestHighLevelClient</code>ï¼Œå®ƒåŒ…è£…ä»»ä½•ç°æœ‰çš„ <code>RestClient</code> beanï¼Œé‡ç”¨å…¶ HTTP é…ç½®ã€‚</p>
<h3 id="é€šè¿‡-Jest-è¿æ¥-Elasticsearch"><a href="#é€šè¿‡-Jest-è¿æ¥-Elasticsearch" class="headerlink" title="é€šè¿‡ Jest è¿æ¥ Elasticsearch"></a>é€šè¿‡ Jest è¿æ¥ Elasticsearch</h3><p>å¦‚æœ classpath ä¸Šæœ‰ Jestï¼Œä½ å¯ä»¥æ³¨å…¥ä¸€ä¸ªè‡ªåŠ¨é…ç½®çš„ <code>JestClient</code>ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ <code>localhost:9200</code>ã€‚æ‚¨å¯ä»¥è¿›ä¸€æ­¥è°ƒæ•´å®¢æˆ·ç«¯çš„é…ç½®æ–¹å¼ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring.elasticsearch.jest.uris</span>=<span class="string">http://search.example.com:9200</span></span><br><span class="line"><span class="attr">spring.elasticsearch.jest.read-timeout</span>=<span class="string">10000</span></span><br><span class="line"><span class="attr">spring.elasticsearch.jest.username</span>=<span class="string">user</span></span><br><span class="line"><span class="attr">spring.elasticsearch.jest.password</span>=<span class="string">secret</span></span><br></pre></td></tr></table></figure>

<p>æ‚¨è¿˜å¯ä»¥æ³¨å†Œå®ç°ä»»æ„æ•°é‡çš„ <code>HttpClientConfigBuilderCustomizer</code> beanï¼Œä»¥è¿›è¡Œæ›´é«˜çº§çš„å®šåˆ¶ã€‚ä»¥ä¸‹ç¤ºä¾‹è°ƒæ•´ä¸ºå…¶ä»– HTTP è®¾ç½®ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">HttpSettingsCustomizer</span> <span class="keyword">implements</span> <span class="title class_">HttpClientConfigBuilderCustomizer</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">customize</span><span class="params">(HttpClientConfig.Builder builder)</span> &#123;</span><br><span class="line">		builder.maxTotalConnection(<span class="number">100</span>).defaultMaxTotalConnectionPerRoute(<span class="number">5</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¦å®Œå…¨æ§åˆ¶æ³¨å†Œï¼Œè¯·å®šä¹‰ <code>JestClient</code> beanã€‚</p>
<h3 id="é€šè¿‡-Spring-Data-è®¿é—®-Elasticsearch"><a href="#é€šè¿‡-Spring-Data-è®¿é—®-Elasticsearch" class="headerlink" title="é€šè¿‡ Spring Data è®¿é—® Elasticsearch"></a>é€šè¿‡ Spring Data è®¿é—® Elasticsearch</h3><p>è¦è¿æ¥åˆ° Elasticsearchï¼Œæ‚¨å¿…é¡»æä¾›ä¸€ä¸ªæˆ–å¤šä¸ªé›†ç¾¤èŠ‚ç‚¹çš„åœ°å€ã€‚å¯ä»¥é€šè¿‡å°† <code>spring.data.elasticsearch.cluster-nodes</code> å±æ€§è®¾ç½®ä¸ºä»¥é€—å·åˆ†éš”çš„ <code>host:port</code> åˆ—è¡¨æ¥æŒ‡å®šåœ°å€ã€‚ä½¿ç”¨æ­¤é…ç½®ï¼Œå¯ä»¥åƒä»»ä½•å…¶ä»– Spring bean ä¸€æ ·æ³¨å…¥ <code>ElasticsearchTemplate</code> æˆ– <code>TransportClient</code>ï¼Œå¦‚ä»¥ä¸‹ç¤ºä¾‹æ‰€ç¤ºï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">spring.data.elasticsearch.cluster-nodes=localhost:<span class="number">9300</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyBean</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> ElasticsearchTemplate template;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">MyBean</span><span class="params">(ElasticsearchTemplate template)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.template = template;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœä½ æ·»åŠ äº†è‡ªå®šä¹‰çš„ <code>ElasticsearchTemplate</code> æˆ– <code>TransportClient</code> <code>@Bean</code> ï¼Œå°±ä¼šæ›¿æ¢é»˜è®¤çš„é…ç½®ã€‚</p>
<h3 id="Elasticsearch-Repositories"><a href="#Elasticsearch-Repositories" class="headerlink" title="Elasticsearch Repositories"></a>Elasticsearch Repositories</h3><p>Spring Data åŒ…å«å¯¹ Elasticsearch çš„ repository æ”¯æŒã€‚åŸºæœ¬åŸåˆ™æ˜¯æ ¹æ®æ–¹æ³•åç§°è‡ªåŠ¨ä¸ºæ‚¨æ„å»ºæŸ¥è¯¢ã€‚</p>
<p>äº‹å®ä¸Šï¼ŒSpring Data JPA å’Œ Spring Data Elasticsearch å…±äº«ç›¸åŒçš„é€šç”¨åŸºç¡€æ¶æ„ã€‚</p>
<h2 id="æºç "><a href="#æºç " class="headerlink" title="æºç "></a>æºç </h2><p>å®Œæ•´ç¤ºä¾‹ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-boot-tutorial/tree/master/codes/spring-boot-data-elasticsearch">æºç </a></p>
<p>ä½¿ç”¨æ–¹æ³•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mvn clean package</span><br><span class="line"><span class="built_in">cd</span> target</span><br><span class="line">java -jar spring-boot-data-elasticsearch.jar</span><br></pre></td></tr></table></figure>

<h2 id="å¼•ç”³å’Œå¼•ç”¨"><a href="#å¼•ç”³å’Œå¼•ç”¨" class="headerlink" title="å¼•ç”³å’Œå¼•ç”¨"></a>å¼•ç”³å’Œå¼•ç”¨</h2><p><strong>å¼•ç”³</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-boot-tutorial">Spring Boot æ•™ç¨‹</a></li>
</ul>
<p><strong>å‚è€ƒ</strong></p>
<ul>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-elasticsearch">Spring Boot å®˜æ–¹æ–‡æ¡£ä¹‹ boot-features-elasticsearch</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-data-elasticsearch">Spring Data Elasticsearch Github</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-data/elasticsearch/docs/current/reference/html/">Spring Data Elasticsearch å®˜æ–¹æ–‡æ¡£</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://jiahero7.github.io/pages/bac2ce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/JiaHero7.github.io/uploads/avatar.gif">
      <meta itemprop="name" content="é’æ‚Ÿ â—¾ Dunwu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Dunwu Blog">
      <meta itemprop="description" content="é’æ‚Ÿçš„ä¸ªäººåšå®¢">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Dunwu Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/JiaHero7.github.io/pages/bac2ce/" class="post-title-link" itemprop="url">SpringBoot ä¹‹ banner å®šåˆ¶</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">å‘è¡¨äº</span>

      <time title="åˆ›å»ºæ—¶é—´ï¼š2018-12-21 23:22:44" itemprop="dateCreated datePublished" datetime="2018-12-21T23:22:44+08:00">2018-12-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">æ›´æ–°äº</span>
      <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-12-23 12:01:44" itemprop="dateModified" datetime="2022-12-23T12:01:44+08:00">2022-12-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">åˆ†ç±»äº</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/" itemprop="url" rel="index"><span itemprop="name">Java</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/" itemprop="url" rel="index"><span itemprop="name">æ¡†æ¶</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/" itemprop="url" rel="index"><span itemprop="name">Spring</span></a>
        </span>
          ï¼Œ
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/JiaHero7.github.io/categories/Java/%E6%A1%86%E6%9E%B6/Spring/Spring%E5%85%B6%E4%BB%96/" itemprop="url" rel="index"><span itemprop="name">Springå…¶ä»–</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="æœ¬æ–‡å­—æ•°">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">æœ¬æ–‡å­—æ•°ï¼š</span>
      <span>2.6k</span>
    </span>
    <span class="post-meta-item" title="é˜…è¯»æ—¶é•¿">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">é˜…è¯»æ—¶é•¿ &asymp;</span>
      <span>2 åˆ†é’Ÿ</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="SpringBoot-ä¹‹-banner-å®šåˆ¶"><a href="#SpringBoot-ä¹‹-banner-å®šåˆ¶" class="headerlink" title="SpringBoot ä¹‹ banner å®šåˆ¶"></a>SpringBoot ä¹‹ banner å®šåˆ¶</h1><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Spring Boot å¯åŠ¨æ—¶é»˜è®¤ä¼šæ˜¾ç¤ºä»¥ä¸‹ LOGOï¼š</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  .   ____          _            __ _ _</span><br><span class="line"> /\\ / ___&#x27;_ __ _ _(_)_ __  __ _ \ \ \ \</span><br><span class="line">( ( )\___ |<span class="string"> &#x27;_ </span>|<span class="string"> &#x27;_</span>|<span class="string"> </span>|<span class="string"> &#x27;_ \/ _` </span>|<span class="string"> \ \ \ \</span></span><br><span class="line"><span class="string"> \\/  ___)</span>|<span class="string"> </span>|<span class="string">_)</span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>|<span class="string"> </span>||<span class="string"> (_</span>|<span class="string"> </span>|<span class="string">  ) ) ) )</span></span><br><span class="line"><span class="string">  &#x27;  </span>|<span class="string">____</span>|<span class="string"> .__</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_</span>|<span class="string">_</span>|<span class="string"> </span>|<span class="string">_\__, </span>|<span class="string"> / / / /</span></span><br><span class="line"><span class="string"> =========</span>|<span class="string">_</span>|<span class="string">==============</span>|<span class="string">___/=/_/_/_/</span></span><br><span class="line"><span class="string"> :: Spring Boot ::        (v2.1.1.RELEASE)</span></span><br></pre></td></tr></table></figure>

<p>å®é™…ä¸Šï¼ŒSpring Boot æ”¯æŒè‡ªå®šä¹‰ logo çš„åŠŸèƒ½ã€‚</p>
<p>è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•å®ç°çš„ã€‚</p>
<p>åªè¦ä½ åœ¨ <code>resources</code> ç›®å½•ä¸‹æ”¾ç½®åä¸º <code>banner.txt</code>ã€<code>banner.gif</code> ã€<code>banner.jpg</code> æˆ– <code>banner.png</code> çš„æ–‡ä»¶ï¼ŒSpring Boot ä¼šè‡ªåŠ¨åŠ è½½ï¼Œå°†å…¶ä½œä¸ºå¯åŠ¨æ—¶æ‰“å°çš„ logoã€‚</p>
<ul>
<li>å¯¹äºæ–‡æœ¬æ–‡ä»¶ï¼ŒSpring Boot ä¼šå°†å…¶ç›´æ¥è¾“å‡ºã€‚</li>
<li>å¯¹äºå›¾åƒæ–‡ä»¶ï¼ˆ <code>banner.gif</code> ã€<code>banner.jpg</code> æˆ– <code>banner.png</code> ï¼‰ï¼ŒSpring Boot ä¼šå°†å›¾åƒè½¬ä¸º ASCII å­—ç¬¦ï¼Œç„¶åè¾“å‡ºã€‚</li>
</ul>
<h2 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h2><p>banner.txt æ–‡ä»¶ä¸­è¿˜å¯ä»¥ä½¿ç”¨å˜é‡æ¥è®¾ç½®å­—ä½“ã€é¢œè‰²ã€ç‰ˆæœ¬å·ã€‚</p>
<table>
<thead>
<tr>
<th align="left">å˜é‡</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>$&#123;application.version&#125;</code></td>
<td><code>MANIFEST.MF</code> ä¸­å®šä¹‰çš„ç‰ˆæœ¬ã€‚å¦‚ï¼š<code>1.0</code></td>
</tr>
<tr>
<td align="left"><code>$&#123;application.formatted-version&#125;</code></td>
<td><code>MANIFEST.MF</code> ä¸­å®šä¹‰çš„ç‰ˆæœ¬ï¼Œå¹¶æ·»åŠ ä¸€ä¸ª <code>v</code> å‰ç¼€ã€‚å¦‚ï¼š<code>v1.0</code></td>
</tr>
<tr>
<td align="left"><code>$&#123;spring-boot.version&#125;</code></td>
<td>Spring Boot ç‰ˆæœ¬ã€‚å¦‚ï¼š<code>2.1.1.RELEASE</code>.</td>
</tr>
<tr>
<td align="left"><code>$&#123;spring-boot.formatted-version&#125;</code></td>
<td>Spring Boot ç‰ˆæœ¬ï¼Œå¹¶æ·»åŠ ä¸€ä¸ª <code>v</code> å‰ç¼€ã€‚å¦‚ï¼š<code>v2.1.1.RELEASE</code></td>
</tr>
<tr>
<td align="left"><code>$&#123;Ansi.NAME&#125;</code> (or <code>$&#123;AnsiColor.NAME&#125;</code>, <code>$&#123;AnsiBackground.NAME&#125;</code>, <code>$&#123;AnsiStyle.NAME&#125;</code>)</td>
<td>ANSI é¢œè‰²ã€å­—ä½“ã€‚æ›´å¤šç»†èŠ‚ï¼Œå‚è€ƒï¼š<a target="_blank" rel="noopener" href="https://github.com/spring-projects/spring-boot/tree/v2.1.1.RELEASE/spring-boot-project/spring-boot/src/main/java/org/springframework/boot/ansi/AnsiPropertySource.java"><code>AnsiPropertySource</code></a>ã€‚</td>
</tr>
<tr>
<td align="left"><code>$&#123;application.title&#125;</code></td>
<td><code>MANIFEST.MF</code> ä¸­å®šä¹‰çš„åº”ç”¨åã€‚</td>
</tr>
</tbody></table>
<p>ç¤ºä¾‹ï¼š</p>
<p>åœ¨ Spring Boot é¡¹ç›®ä¸­çš„ <code>resources</code> ç›®å½•ä¸‹æ·»åŠ ä¸€ä¸ªåä¸º banner.txt çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$&#123;AnsiColor.BRIGHT_YELLOW&#125;$&#123;AnsiStyle.BOLD&#125;</span><br><span class="line"> ________  ___  ___  ________   ___       __   ___  ___</span><br><span class="line">|<span class="string">\</span>   ___ <span class="string">\|\</span>  <span class="string">\|\</span>  <span class="string">\|\</span>   ___  <span class="string">\|\</span>  <span class="string">\</span>     |<span class="string">\</span>  <span class="string">\|\</span>  <span class="string">\|\</span>  <span class="string">\</span></span><br><span class="line"><span class="string">\</span> <span class="string">\</span>  <span class="string">\_|\</span> <span class="string">\</span> <span class="string">\</span>  <span class="string">\\\</span>  <span class="string">\</span> <span class="string">\</span>  <span class="string">\\</span> <span class="string">\</span>  <span class="string">\</span> <span class="string">\</span>  <span class="string">\</span>    <span class="string">\</span> <span class="string">\</span>  <span class="string">\</span> <span class="string">\</span>  <span class="string">\\\</span>  <span class="string">\</span></span><br><span class="line"> <span class="string">\</span> <span class="string">\</span>  <span class="string">\</span> <span class="string">\\</span> <span class="string">\</span> <span class="string">\</span>  <span class="string">\\\</span>  <span class="string">\</span> <span class="string">\</span>  <span class="string">\\</span> <span class="string">\</span>  <span class="string">\</span> <span class="string">\</span>  <span class="string">\</span>  __<span class="string">\</span> <span class="string">\</span>  <span class="string">\</span> <span class="string">\</span>  <span class="string">\\\</span>  <span class="string">\</span></span><br><span class="line">  <span class="string">\</span> <span class="string">\</span>  <span class="string">\_\\</span> <span class="string">\</span> <span class="string">\</span>  <span class="string">\\\</span>  <span class="string">\</span> <span class="string">\</span>  <span class="string">\\</span> <span class="string">\</span>  <span class="string">\</span> <span class="string">\</span>  <span class="string">\|\__\_\</span>  <span class="string">\</span> <span class="string">\</span>  <span class="string">\\\</span>  <span class="string">\</span></span><br><span class="line">   <span class="string">\</span> <span class="string">\_______\</span> <span class="string">\_______\</span> <span class="string">\__\\</span> <span class="string">\__\</span> <span class="string">\____________\</span> <span class="string">\_______\</span></span><br><span class="line">    <span class="string">\|_______|\|_______|\|__|</span> <span class="string">\|__|\|____________|\|_______|</span></span><br><span class="line">$&#123;AnsiBackground.WHITE&#125;$&#123;AnsiColor.RED&#125;$&#123;AnsiStyle.UNDERLINE&#125;</span><br><span class="line">:: Spring Boot ::             (v$&#123;spring-boot.version&#125;)</span><br><span class="line">:: Spring Boot Tutorial ::    (v1.<span class="number">0.0</span>)</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨ï¼š<code>$&#123;&#125;</code> è®¾ç½®å­—ä½“é¢œè‰²çš„å˜é‡ä¹‹é—´ä¸èƒ½æ¢è¡Œæˆ–ç©ºæ ¼åˆ†éš”ï¼Œå¦åˆ™ä¼šå¯¼è‡´é™¤æœ€åä¸€ä¸ªå˜é‡å¤–ï¼Œéƒ½ä¸ç”Ÿæ•ˆã€‚</p>
</blockquote>
<p>å¯åŠ¨åº”ç”¨åï¼Œæ§åˆ¶å°å°†æ‰“å°å¦‚ä¸‹ logoï¼š</p>
<p><img src="https://raw.githubusercontent.com/dunwu/images/dev/snap/20181221231330.png" alt="img"><br>æ¨èä¸¤ä¸ªç”Ÿæˆå­—ç¬¦ç”»çš„ç½‘ç«™ï¼Œå¯ä»¥å°†ç”Ÿæˆçš„å­—ç¬¦ä¸²æ”¾å…¥è¿™ä¸ª<code>banner.txt</code> æ–‡ä»¶ï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.network-science.de/ascii/">http://www.network-science.de/ascii/</a></li>
<li><a target="_blank" rel="noopener" href="http://patorjk.com/software/taag/">http://patorjk.com/software/taag/</a></li>
</ul>
<h2 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h2><p><code>application.properties</code> ä¸­ä¸ Banner ç›¸å…³çš„é…ç½®ï¼š</p>
<figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># banner æ¨¡å¼ã€‚æœ‰ä¸‰ç§æ¨¡å¼ï¼šconsole/log/off</span></span><br><span class="line"><span class="comment"># console æ‰“å°åˆ°æ§åˆ¶å°ï¼ˆé€šè¿‡ System.outï¼‰</span></span><br><span class="line"><span class="comment"># log - æ‰“å°åˆ°æ—¥å¿—ä¸­</span></span><br><span class="line"><span class="comment"># off - å…³é—­æ‰“å°</span></span><br><span class="line"><span class="attr">spring.main.banner-mode</span> = <span class="string">off</span></span><br><span class="line"><span class="comment"># banner æ–‡ä»¶ç¼–ç </span></span><br><span class="line"><span class="attr">spring.banner.charset</span> = <span class="string">UTF-8</span></span><br><span class="line"><span class="comment"># banner æ–‡æœ¬æ–‡ä»¶è·¯å¾„</span></span><br><span class="line"><span class="attr">spring.banner.location</span> = <span class="string">classpath:banner.txt</span></span><br><span class="line"><span class="comment"># banner å›¾åƒæ–‡ä»¶è·¯å¾„ï¼ˆå¯ä»¥é€‰æ‹© png,jpg,gif æ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="attr">spring.banner.image.location</span> = <span class="string">classpath:banner.gif</span></span><br><span class="line"><span class="attr">used).</span></span><br><span class="line"><span class="comment"># å›¾åƒ banner çš„å®½åº¦ï¼ˆå­—ç¬¦æ•°ï¼‰</span></span><br><span class="line"><span class="attr">spring.banner.image.width</span> = <span class="string">76</span></span><br><span class="line"><span class="comment"># å›¾åƒ banner çš„é«˜åº¦ï¼ˆå­—ç¬¦æ•°ï¼‰</span></span><br><span class="line"><span class="attr">spring.banner.image.height</span> =<span class="string"></span></span><br><span class="line"><span class="comment"># å›¾åƒ banner çš„å·¦è¾¹ç•Œï¼ˆå­—ç¬¦æ•°ï¼‰</span></span><br><span class="line"><span class="attr">spring.banner.image.margin</span> = <span class="string">2</span></span><br><span class="line"><span class="comment"># æ˜¯å¦å°†å›¾åƒè½¬ä¸ºé»‘è‰²æ§åˆ¶å°ä¸»é¢˜</span></span><br><span class="line"><span class="attr">spring.banner.image.invert</span> = <span class="string">false</span></span><br></pre></td></tr></table></figure>

<p>å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ YAML æ–‡ä»¶ä¸­é…ç½®ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">main:</span></span><br><span class="line">    <span class="attr">banner-mode:</span> <span class="string">off</span></span><br></pre></td></tr></table></figure>

<h2 id="ç¼–ç¨‹"><a href="#ç¼–ç¨‹" class="headerlink" title="ç¼–ç¨‹"></a>ç¼–ç¨‹</h2><p>é»˜è®¤ï¼ŒSpring Boot ä¼šæ³¨å†Œä¸€ä¸ª <code>SpringBootBanner</code> çš„å•ä¾‹ Beanï¼Œç”¨æ¥è´Ÿè´£æ‰“å° Bannerã€‚</p>
<p>å¦‚æœæƒ³å®Œå…¨ä¸ªäººå®šåˆ¶ Bannerï¼Œå¯ä»¥è¿™ä¹ˆåšï¼šå…ˆå®ç° <code>org.springframework.boot.Banner#printBanner</code> æ¥å£æ¥è‡ªå·±å®šåˆ¶ Bannerã€‚åœ¨å°†è¿™ä¸ª Banner é€šè¿‡ <code>SpringApplication.setBanner(â€¦)</code> æ–¹æ³•æ³¨å…¥ Spring Bootã€‚</p>
<h2 id="ç¤ºä¾‹æºç "><a href="#ç¤ºä¾‹æºç " class="headerlink" title="ç¤ºä¾‹æºç "></a>ç¤ºä¾‹æºç </h2><blockquote>
<p>ç¤ºä¾‹æºç ï¼š<a target="_blank" rel="noopener" href="https://github.com/dunwu/spring-boot-tutorial/tree/master/codes/spring-boot-banner">spring-boot-banner</a></p>
</blockquote>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><ul>
<li><a target="_blank" rel="noopener" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-banner">Spring Boot å®˜æ–¹æ–‡æ¡£ä¹‹ Customizing the Banner</a></li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/JiaHero7.github.io/page/12/"><i class="fa fa-angle-left" aria-label="ä¸Šä¸€é¡µ"></i></a><a class="page-number" href="/JiaHero7.github.io/">1</a><span class="space">&hellip;</span><a class="page-number" href="/JiaHero7.github.io/page/12/">12</a><span class="page-number current">13</span><a class="page-number" href="/JiaHero7.github.io/page/14/">14</a><a class="page-number" href="/JiaHero7.github.io/page/15/">15</a><a class="extend next" rel="next" href="/JiaHero7.github.io/page/14/"><i class="fa fa-angle-right" aria-label="ä¸‹ä¸€é¡µ"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2015 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">é’æ‚Ÿ â—¾ Dunwu</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>ç«™ç‚¹æ€»å­—æ•°ï¼š</span>
    <span title="ç«™ç‚¹æ€»å­—æ•°">1.5m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>ç«™ç‚¹é˜…è¯»æ—¶é•¿ &asymp;</span>
    <span title="ç«™ç‚¹é˜…è¯»æ—¶é•¿">22:08</span>
  </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/JiaHero7.github.io/js/comments.js"></script><script src="/JiaHero7.github.io/js/utils.js"></script><script src="/JiaHero7.github.io/js/motion.js"></script><script src="/JiaHero7.github.io/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/JiaHero7.github.io/js/third-party/search/local-search.js"></script>




  <script src="/JiaHero7.github.io/js/third-party/pace.js"></script>

  




<script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '64px',
  right: 'unset',
  left: '32px',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: 'ğŸŒ“',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"dunwu","repo":"blog","client_id":"c45bc13ca1d3d3aa4836","client_secret":"1907a9f0c22087badad3938e1d7dcba9078f88ac","admin_user":"dunwu","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":"zh-CN","js":{"url":"https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js","integrity":"sha256-Pmj85ojLaPOWwRtlMJwmezB/Qg8BzvJp5eTzvXaYAfA="},"path_md5":"1093e25cc4b99cb2b3a40e42ba13689e"}</script>
<script src="/JiaHero7.github.io/js/third-party/comments/gitalk.js"></script>

</body>
</html>
